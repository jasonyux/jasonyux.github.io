<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/logo-180x180.jpg">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/logo-32x32.jpg">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/logo-16x16.jpg">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"jasonyux.github.io","root":"/","scheme":"Pisces","version":"8.0.0-rc.3","exturl":false,"sidebar":{"position":"left","width":350,"display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="From a Beginner to a Disaster">
<meta property="og:url" content="https://jasonyux.github.io/index.html">
<meta property="og:site_name" content="From a Beginner to a Disaster">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Xiao Yu">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://jasonyux.github.io/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>From a Beginner to a Disaster</title>
  






  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before, .use-motion .logo-line-after {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
  <div id="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <main class="main">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader">
        <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
        <span class="toggle-line toggle-line-first"></span>
        <span class="toggle-line toggle-line-middle"></span>
        <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line-before"></i>
      <h1 class="site-title">From a Beginner to a Disaster</h1>
      <i class="logo-line-after"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Xiao.Y</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Xiao Yu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>
  <div class="sidebar-button motion-element"><i class="fa fa-comment"></i>
    Chat
  </a>
  </div>



      </div>
    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </header>

      
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>


      <div class="main-inner">
        

        <div class="content index posts-expand">
          
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jasonyux.github.io/2020/07/23/Spring-Security-Manual/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Yu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="From a Beginner to a Disaster">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/23/Spring-Security-Manual/" class="post-title-link" itemprop="url">Spring Security (OAuth2) Manual</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-07-23 10:36:09 / Modified: 17:25:09" itemprop="dateCreated datePublished" datetime="2020-07-23T10:36:09+08:00">2020-07-23</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <hr>
<p><strong>IMPORTANT</strong>:<br>Much of the content here is a personal summary/abbreviation of contents on the <a href="https://docs.spring.io/spring-security/site/docs/5.3.3.BUILD-SNAPSHOT/reference/html5/" target="_blank" rel="noopener">Offical Spring Security Documentation</a>. For more complete information, please refer to the official site.</p>
<hr>
<h1 id="Spring-Security-Intro"><a href="#Spring-Security-Intro" class="headerlink" title="Spring Security Intro"></a>Spring Security Intro</h1><p>Spring security is very useful for dealing with authorization, authentication, and protection against common attacks. It provides support for OAuth2, SAML2, and etc. Yet, as the title of this manual suggests, <strong>the following sections will focus on using OAuth2</strong> for authentication/authorization. </p>
<p>Technically, you do not necessarily need to use Spring Boot for using Spring Security. However, the sections below do <strong>assume that you are having a Spring Boot project</strong> to provide the backend services.</p>
<p>If you want more information on using tools other than OAuth2, or that you are not using Spring Boot as the backend API implementations, please visit the <a href="https://docs.spring.io/spring-security/site/docs/5.3.3.BUILD-SNAPSHOT/reference/html5/" target="_blank" rel="noopener">Official Reference</a>.</p>
<h1 id="Getting-Spring-Security"><a href="#Getting-Spring-Security" class="headerlink" title="Getting Spring Security"></a>Getting Spring Security</h1><p>If you are using Spring Security with Spring Boot, getting Spring Security playing in your application is simple.</p>
<p><strong>In summary</strong>, all you need to do is </p>
<ol>
<li>Import the <code>spring-boot-starter-security</code> in your <code>pom.xml</code><ul>
<li>You can either manually import the dependency, or select the <code>Spring Security</code> dependency in the Spring Initialzr</li>
<li>At this point, we are not yet using the <code>OAuth2 Resource Server</code> and <code>OAuth2 Client</code> yet. If you want, feel free to include those in your <code>pom.xml</code> as well.</li>
</ul>
</li>
</ol>
<p>The necessary dependency looks like:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ... other dependency elements ... --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-security<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Again, its version has been already specified in the parent:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.1.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span> <span class="comment">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>If you want to use a specific version, you can specify it as well:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ... --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">spring-security.version</span>&gt;</span>WHATEVER-VERSION-YOU-WANT-HERE<span class="tag">&lt;/<span class="name">spring-security.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> <p><strong>If you use a SNAPSHOT version</strong>, you need to ensure that you have the Spring Snapshot repository defined, as the following example shows:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">repositories</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- ... possibly other repository elements ... --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">repository</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>spring-snapshot<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>Spring Snapshot Repository<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://repo.spring.io/snapshot<span class="tag">&lt;/<span class="name">url</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">repository</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">repositories</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</blockquote>
<h1 id="Spring-Security-Features"><a href="#Spring-Security-Features" class="headerlink" title="Spring Security Features"></a>Spring Security Features</h1><p>Spring Security provides comprehensive support for <a href="#Authentication">authentication</a>, authorization, and protection against <a href="https://docs.spring.io/spring-security/site/docs/5.3.3.BUILD-SNAPSHOT/reference/html5/#exploits" target="_blank" rel="noopener">common exploits</a>. It also provides integration with other libraries to simplify its usage.</p>
<h2 id="Authentication-Support"><a href="#Authentication-Support" class="headerlink" title="Authentication Support"></a>Authentication Support</h2><p>Authentication is how we <strong>verify the identity of who is trying to access a particular resource</strong>. A common way to authenticate users is by requiring the user to enter a username and password. Once authentication is performed we know the identity and can perform authorization.</p>
<p>Spring Security provides built in support for authenticating users. Refer to the sections on <a href="#authentication">authentication</a> for details on what is supported for each stack.</p>
<h2 id="Password-Storage-and-Encoding"><a href="#Password-Storage-and-Encoding" class="headerlink" title="Password Storage and Encoding"></a>Password Storage and Encoding</h2><p>Spring Security’s <code>PasswordEncoder</code> interface is used to perform a <strong>one way transformation of a password to allow the password to be stored securely</strong>. Given <code>PasswordEncoder</code> is a one way transformation, it is not intended when the password transformation needs to be two way (i.e. storing credentials used to authenticate to a database). </p>
<p>Typically <code>PasswordEncoder</code> is used for <strong>storing a password that needs to be compared to a user provided password at the time of authentication</strong>.</p>
<h3 id="Password-Storage-History"><a href="#Password-Storage-History" class="headerlink" title="Password Storage History"></a>Password Storage History</h3><p>This section discusses a brief history of password storage: <strong>how attackers were able to crack the past systems, and what current strategies are</strong>.</p>
<blockquote>
<p>Throughout the years the standard mechanism for storing passwords has evolved. In the beginning passwords were stored in plain text. The passwords were assumed to be safe because the data store the passwords were saved in required credentials to access it. However, malicious users were able to find ways to get large “data dumps” of usernames and passwords using attacks like SQL Injection. As more and more user credentials became public security experts realized we needed to do more to protect users’ passwords.</p>
<p><strong>Developers were then encouraged to store passwords after running them through a one way hash such as SHA-256.</strong> When a user tried to authenticate, the hashed password would be compared to the hash of the password that they typed. This meant that the system only needed to store the one way hash of the password. If a breach occurred, then only the one way hashes of the passwords were exposed. Since the hashes were one way and it was computationally difficult to guess the passwords given the hash, it would not be worth the effort to figure out each password in the system. <strong>To defeat this new system malicious users decided to create lookup tables known as <a href="https://en.wikipedia.org/wiki/Rainbow_table" target="_blank" rel="noopener">Rainbow Tables</a>.</strong> Rather than doing the work of guessing each password every time, they computed the password once and stored it in a lookup table.</p>
<p><strong>To mitigate the effectiveness of Rainbow Tables, developers were encouraged to use salted passwords.</strong> Instead of using just the password as input to the hash function, random bytes (known as salt) would be generated for every users’ password. The salt and the user’s password would be ran through the hash function which produced a unique hash. The salt would be stored alongside the user’s password in clear text. Then when a user tried to authenticate, the hashed password would be compared to the hash of the stored salt and the password that they typed. The unique salt meant that Rainbow Tables were no longer effective because the hash was different for every salt and password combination.</p>
<p><strong>In modern times we realize that cryptographic hashes (like SHA-256) are no longer secure.</strong> The reason is that with modern hardware we can perform billions of hash calculations a second. This means that we can crack each password individually with ease.</p>
<p><strong>Developers are now encouraged to leverage adaptive one-way functions to store a password (e.g. feeding its output as input and adjust how many iterations to occur).</strong> Validation of passwords with adaptive one-way functions are intentionally resource (i.e. CPU, memory, etc) intensive. An adaptive one-way function allows configuring a “work factor” which can grow as hardware gets better. It is recommended that the “work factor” be tuned to take about 1 second to verify a password on your system. This trade off is to make it difficult for attackers to crack the password, but not so costly it puts excessive burden on your own system. Spring Security has attempted to provide a good starting point for the “work factor”, but users are encouraged to customize the “work factor” for their own system since the performance will vary drastically from system to system. Examples of adaptive one-way functions that should be used include <a href="https://docs.spring.io/spring-security/site/docs/5.3.3.BUILD-SNAPSHOT/reference/html5/#authentication-password-storage-bcrypt" target="_blank" rel="noopener">bcrypt</a>, <a href="https://docs.spring.io/spring-security/site/docs/5.3.3.BUILD-SNAPSHOT/reference/html5/#authentication-password-storage-pbkdf2" target="_blank" rel="noopener">PBKDF2</a>, <a href="https://docs.spring.io/spring-security/site/docs/5.3.3.BUILD-SNAPSHOT/reference/html5/#authentication-password-storage-scrypt" target="_blank" rel="noopener">scrypt</a>, and <a href="https://docs.spring.io/spring-security/site/docs/5.3.3.BUILD-SNAPSHOT/reference/html5/#authentication-password-storage-argon2" target="_blank" rel="noopener">argon2</a>.</p>
<p>Because adaptive one-way functions are intentionally resource intensive, validating a username and password for every request will degrade performance of an application significantly. There is nothing Spring Security (or any other library) can do to speed up the validation of the password since security is gained by making the validation resource intensive. Users are encouraged to exchange the long term credentials (i.e. username and password) for a short term credential (i.e. session, OAuth Token, etc). The short term credential can be validated quickly without any loss in security.</p>
<p>Source: <a href="https://docs.spring.io/spring-security/site/docs/5.3.3.BUILD-SNAPSHOT/reference/html5/#authentication-password-storage-history" target="_blank" rel="noopener">https://docs.spring.io/spring-security/site/docs/5.3.3.BUILD-SNAPSHOT/reference/html5/#authentication-password-storage-history</a></p>
</blockquote>
<h3 id="DelegatingPasswordEncoder"><a href="#DelegatingPasswordEncoder" class="headerlink" title="DelegatingPasswordEncoder"></a><code>DelegatingPasswordEncoder</code></h3><p>Prior to Spring Security 5.0 the default <code>PasswordEncoder</code> was <code>NoOpPasswordEncoder</code> which required plain text passwords. Based upon the <a href="#Password-Storage-History">Password Storage History</a> section you might expect that the default <code>PasswordEncoder</code> is now something like <code>BCryptPasswordEncoder</code>. However, this ignores three real world problems:</p>
<ul>
<li>There are many applications using old password encodings that cannot easily migrate</li>
<li>The best practice for password storage will change again.</li>
<li>As a framework Spring Security cannot make breaking changes frequently</li>
</ul>
<p>Instead Spring Security introduces <code>DelegatingPasswordEncoder</code> which solves all of the problems by:</p>
<ul>
<li>Ensuring that passwords are encoded using the current password storage recommendations</li>
<li><strong>Allowing for validating passwords in modern and legacy formats</strong></li>
<li>Allowing for upgrading the encoding in the future</li>
</ul>
<p>You can easily construct an instance of <code>DelegatingPasswordEncoder</code> using <code>PasswordEncoderFactories</code>.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">PasswordEncoder passwordEncoder =</span><br><span class="line">    PasswordEncoderFactories.createDelegatingPasswordEncoder();</span><br></pre></td></tr></table></figure>

<p><strong>Alternatively, you may create your own custom instance:</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">String idForEncode = <span class="string">"bcrypt"</span>;</span><br><span class="line">Map encoders = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">encoders.put(idForEncode, <span class="keyword">new</span> BCryptPasswordEncoder());</span><br><span class="line">encoders.put(<span class="string">"noop"</span>, NoOpPasswordEncoder.getInstance());</span><br><span class="line">encoders.put(<span class="string">"pbkdf2"</span>, <span class="keyword">new</span> Pbkdf2PasswordEncoder());</span><br><span class="line">encoders.put(<span class="string">"scrypt"</span>, <span class="keyword">new</span> SCryptPasswordEncoder());</span><br><span class="line">encoders.put(<span class="string">"sha256"</span>, <span class="keyword">new</span> StandardPasswordEncoder());</span><br><span class="line"></span><br><span class="line">PasswordEncoder passwordEncoder = <span class="keyword">new</span> DelegatingPasswordEncoder(idForEncode, encoders);</span><br></pre></td></tr></table></figure>

<h3 id="Encode-with-Spring-Boot-CLI"><a href="#Encode-with-Spring-Boot-CLI" class="headerlink" title="Encode with Spring Boot CLI"></a>Encode with Spring Boot CLI</h3><p>This can be useful sometimes when you are testing some features of your application and needs a certain password to be encoded without running the entire application. This can be achieved in Spring Boot CLI:</p>
<p>For example:</p>
<figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">spring encodepassword password</span><br><span class="line">&#123;bcrypt&#125;$<span class="number">2</span>a$<span class="number">10</span>$X5wFBtLrL/kHcmrOGGTrGufsBX8CJ0WpQpF3pgeuxBB/H73BK1DW6</span><br></pre></td></tr></table></figure>

<p>However, this seems to only be able to provide hashes of type <code>bcrypt</code>.</p>
<h3 id="Password-Storage-Format"><a href="#Password-Storage-Format" class="headerlink" title="Password Storage Format"></a>Password Storage Format</h3><p>If you run the <code>passwordEncoder(&quot;password&quot;)</code> for each of the <code>PasswordEncoder</code> above, you will see the following output format:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;id&#125;encodedPassword</span><br></pre></td></tr></table></figure>

<p>For example, encoding the word <code>password</code> would give:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;bcrypt&#125;$2a$10$dXJ3SW6G7P50lGmMkkmwe.20cQQubK3.HZWzG3YB1tlRy.fqvM&#x2F;BG </span><br><span class="line">&#123;noop&#125;password </span><br><span class="line">&#123;pbkdf2&#125;5d923b44a6d129f3ddf3e3c8d29412723dcbde72445e8ef6bf3b508fbf17fa4ed4d6b99ca763d8dc </span><br><span class="line">&#123;scrypt&#125;$e0801$8bWJaSu2IKSn9Z9kM+TPXfOc&#x2F;9bdYSrN1oD9qfVThWEwdRTnO7re7Ei+fUZRJ68k9lTyuTeUp4of4g24hHnazw&#x3D;&#x3D;$OAOec05+bXxvuu&#x2F;1qZ6NUR+xQYvYv7BeL1QxwRpY5Pc&#x3D;  </span><br><span class="line">&#123;sha256&#125;97cde38028ad898ebc02e690819fa220e88c62e0699403e94fff291cfffaf8410849f27605abcbc0</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> Some users might be <strong>concerned that the storage format is provided for a potential hacker</strong>. This is not a concern because the storage of the password does not rely on the algorithm being a secret. Additionally, most formats are easy for an attacker to figure out without the prefix. For example, BCrypt passwords often start with <code>$2a$</code>.</li>
</ul>
</blockquote>
<h3 id="Password-Matching"><a href="#Password-Matching" class="headerlink" title="Password Matching"></a>Password Matching</h3><p>The <code>match()</code> method of the <code>PasswordEncoder</code> takes two arguements: the raw password, and the encoded password (in the format <code>{id}encodedPassword</code>).</p>
<p>For example, if you have the password <code>jason</code>, and the encoded hash of it is <code>{bcrypt}$2a$10$ZBDPr38ZlwyPGe/YNsOSHuBEU5TDeNisCds6zJolVW1pN4YEHb3YS</code> , then you do:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwordEncoder.matches(<span class="string">"jason"</span>,<span class="string">"&#123;bcrypt&#125;$2a$10$ZBDPr38ZlwyPGe/YNsOSHuBEU5TDeNisCds6zJolVW1pN4YEHb3YS"</span>));</span><br></pre></td></tr></table></figure>

<p>This behavior can be customized using <code>DelegatingPasswordEncoder.setDefaultPasswordEncoderForMatches(PasswordEncoder)</code>.</p>
<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> However, if the <code>{id}</code> you put in as part of the argument does not exist in the list of encoders that you specified in the example above, it will throw an <code>IllegalArgumentException</code>. This behavior can be customized using <code>DelegatingPasswordEncoder.setDefaultPasswordEncoderForMatches(PasswordEncoder)</code>.</li>
</ul>
</blockquote>
<p>However, if you look into the <code>match()</code> method, you will realize that it checks whether if the password is a match for the hash by first looking at the <code>{id}</code> to determine which encoder to use. This means that <strong>if you hashed it with <code>bcrypt</code> somewhere in your code</strong>, come back here and <strong>put a hash of the same password with the <code>pbkdf2</code> encoder</strong>, it will <strong>still give a match</strong>.</p>
<h2 id="Password-Encoders"><a href="#Password-Encoders" class="headerlink" title="Password Encoders"></a>Password Encoders</h2><h3 id="BCryptPasswordEncoder"><a href="#BCryptPasswordEncoder" class="headerlink" title="BCryptPasswordEncoder"></a>BCryptPasswordEncoder</h3><p>The <code>BCryptPasswordEncoder</code> implementation uses the widely supported <a href="https://en.wikipedia.org/wiki/Bcrypt" target="_blank" rel="noopener">bcrypt</a> algorithm to hash the passwords. In order to make it more resistent to password cracking, <strong>bcrypt is deliberately slow</strong>. Like other adaptive one-way functions, it should be tuned to take about 1 second to verify a password on your system. </p>
<p><strong>The default implementation of <code>BCryptPasswordEncoder</code> uses strength 10</strong> as mentioned in the Javadoc of <a href="https://docs.spring.io/spring-security/site/docs/current/api/org/springframework/security/crypto/bcrypt/BCryptPasswordEncoder.html" target="_blank" rel="noopener">BCryptPasswordEncoder</a>. You are encouraged to tune and test the strength parameter on your own system so that it takes roughly 1 second to verify a password.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Create an encoder with strength 16</span></span><br><span class="line">BCryptPasswordEncoder encoder = <span class="keyword">new</span> BCryptPasswordEncoder(<span class="number">16</span>);</span><br><span class="line">String result = encoder.encode(<span class="string">"myPassword"</span>);</span><br><span class="line">assertTrue(encoder.matches(<span class="string">"myPassword"</span>, result));</span><br></pre></td></tr></table></figure>

<h3 id="Argon2PasswordEncoder"><a href="#Argon2PasswordEncoder" class="headerlink" title="Argon2PasswordEncoder"></a>Argon2PasswordEncoder</h3><p>The <code>Argon2PasswordEncoder</code> implementation uses the <a href="https://en.wikipedia.org/wiki/Argon2" target="_blank" rel="noopener">Argon2</a> algorithm to hash the passwords. <strong>Argon2 is the winner of the <a href="https://en.wikipedia.org/wiki/Password_Hashing_Competition" target="_blank" rel="noopener">Password Hashing Competition</a></strong>. In order to defeat password cracking on custom hardware, Argon2 is a deliberately slow algorithm that requires large amounts of memory. Like other adaptive one-way functions, it should be tuned to take about 1 second to verify a password on your system. The current implementation if the <code>Argon2PasswordEncoder</code> requires BouncyCastle.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Create an encoder with all the defaults</span></span><br><span class="line">Argon2PasswordEncoder encoder = <span class="keyword">new</span> Argon2PasswordEncoder();</span><br><span class="line">String result = encoder.encode(<span class="string">"myPassword"</span>);</span><br><span class="line">assertTrue(encoder.matches(<span class="string">"myPassword"</span>, result));</span><br></pre></td></tr></table></figure>

<h3 id="Pbkdf2PasswordEncoder"><a href="#Pbkdf2PasswordEncoder" class="headerlink" title="Pbkdf2PasswordEncoder"></a>Pbkdf2PasswordEncoder</h3><p>The <code>Pbkdf2PasswordEncoder</code> implementation uses the <a href="https://en.wikipedia.org/wiki/PBKDF2" target="_blank" rel="noopener">PBKDF2</a> algorithm to hash the passwords. In order to defeat password cracking PBKDF2 is a deliberately slow algorithm. Like other adaptive one-way functions, it should be tuned to take about 1 second to verify a password on your system. This algorithm is a good choice when FIPS certification is required.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Create an encoder with all the defaults</span></span><br><span class="line">Pbkdf2PasswordEncoder encoder = <span class="keyword">new</span> Pbkdf2PasswordEncoder();</span><br><span class="line">String result = encoder.encode(<span class="string">"myPassword"</span>);</span><br><span class="line">assertTrue(encoder.matches(<span class="string">"myPassword"</span>, result));</span><br></pre></td></tr></table></figure>

<h3 id="SCryptPasswordEncoder"><a href="#SCryptPasswordEncoder" class="headerlink" title="SCryptPasswordEncoder"></a>SCryptPasswordEncoder</h3><p>The <code>SCryptPasswordEncoder</code> implementation uses <a href="https://en.wikipedia.org/wiki/Scrypt" target="_blank" rel="noopener">scrypt</a> algorithm to hash the passwords. In order to defeat password cracking on custom hardware scrypt is a deliberately slow algorithm that requires large amounts of memory. Like other adaptive one-way functions, it should be tuned to take about 1 second to verify a password on your system.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Create an encoder with all the defaults</span></span><br><span class="line">SCryptPasswordEncoder encoder = <span class="keyword">new</span> SCryptPasswordEncoder();</span><br><span class="line">String result = encoder.encode(<span class="string">"myPassword"</span>);</span><br><span class="line">assertTrue(encoder.matches(<span class="string">"myPassword"</span>, result));</span><br></pre></td></tr></table></figure>

<h3 id="Other-PasswordEncoders"><a href="#Other-PasswordEncoders" class="headerlink" title="Other PasswordEncoders"></a>Other PasswordEncoders</h3><p>There are a significant number of other <code>PasswordEncoder</code> implementations that exist entirely for backward compatibility. They are all deprecated to indicate that they are no longer considered secure. However, there are no plans to remove them since it is difficult to migrate existing legacy systems.</p>
<h2 id="Protection-Against-Exploits"><a href="#Protection-Against-Exploits" class="headerlink" title="Protection Against Exploits"></a>Protection Against Exploits</h2><p>Spring Security provides protection against common exploits. Whenever possible, the protection is enabled by default. Below you will find high level description of the various exploits that Spring Security protects against.</p>
<p>The following sections discuss:</p>
<ul>
<li>Cross Site Request Forgery (CSRF)</li>
<li>Security HTTP Response Headers</li>
<li>HTTP</li>
</ul>
<h3 id="Cross-Site-Request-Forgery"><a href="#Cross-Site-Request-Forgery" class="headerlink" title="Cross Site Request Forgery"></a>Cross Site Request Forgery</h3><p>This is caused by the fact that authentication cookies associated with a site gets passed along in your request if you did not logout. This means that a website can forge an identical evil request using the authentication cookie passed along.</p>
<p>For example:</p>
<p>Consider that you are on a banking website, where you submitted a request of transferring money that looks like this:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"post"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">action</span>=<span class="string">"/transfer"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">name</span>=<span class="string">"amount"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">name</span>=<span class="string">"routingNumber"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">name</span>=<span class="string">"account"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">value</span>=<span class="string">"Transfer"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Then the request would look like:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;transfer HTTP&#x2F;1.1</span><br><span class="line">Host: bank.example.com</span><br><span class="line">Cookie: JSESSIONID&#x3D;randomid</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">amount&#x3D;100.00&amp;routingNumber&#x3D;1234&amp;account&#x3D;9876</span><br></pre></td></tr></table></figure>

<p>Now pretend you authenticate to your bank’s website and then, <strong>without logging out, visit an evil website</strong>. The evil website contains an HTML page with the following form:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"post"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">action</span>=<span class="string">"https://bank.example.com/transfer"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">name</span>=<span class="string">"amount"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">value</span>=<span class="string">"100.00"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">name</span>=<span class="string">"routingNumber"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">value</span>=<span class="string">"evilsRoutingNumber"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">name</span>=<span class="string">"account"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">value</span>=<span class="string">"evilsAccountNumber"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">value</span>=<span class="string">"Win Money!"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>As a result, <strong>the same request would be generated, with the same cookie but destination account forged</strong>.</p>
<p>Worst yet, this whole process could have been automated using JavaScript. This means you didn’t even need to click on the button. Furthermore, it could just as easily happen when visiting an honest site that is a victim of a <a href="https://www.owasp.org/index.php/Cross-site_Scripting_(XSS)" target="_blank" rel="noopener">XSS attack</a>. So how do we protect our users from such attacks?</p>
<h4 id="Protecting-Against-CSRF-Attacks"><a href="#Protecting-Against-CSRF-Attacks" class="headerlink" title="Protecting Against CSRF Attacks"></a>Protecting Against CSRF Attacks</h4><p>The reason that a CSRF attack is possible is that the HTTP request from the victim’s website and the request from the attacker’s website are exactly the same. This means there is no way to reject requests coming from the evil website and allow requests coming from the bank’s website. </p>
<p>To protect against CSRF attacks we need to <strong>ensure there is something in the request that the evil site is unable to provide so we can differentiate the two requests</strong>.</p>
<p>Spring provides two mechanisms to protect against CSRF attacks:</p>
<ul>
<li>The <a href="https://docs.spring.io/spring-security/site/docs/5.3.3.BUILD-SNAPSHOT/reference/html5/#csrf-protection-stp" target="_blank" rel="noopener">Synchronizer Token Pattern</a></li>
<li>Specifying the <a href="https://docs.spring.io/spring-security/site/docs/5.3.3.BUILD-SNAPSHOT/reference/html5/#csrf-protection-ssa" target="_blank" rel="noopener">SameSite Attribute</a> on your session cookie</li>
</ul>
<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> Both protections require that <strong>Safe Methods Must be Idempotent</strong>:<ul>
<li>In order for either protection against CSRF (mentioned above) to work, the application must ensure that <a href="https://tools.ietf.org/html/rfc7231#section-4.2.1" target="_blank" rel="noopener">“safe” HTTP methods are idempotent</a>. This means that requests with the HTTP method <code>GET</code>, <code>HEAD</code>, <code>OPTIONS</code>, and <code>TRACE</code> should not change the state of the application.</li>
</ul>
</li>
</ul>
</blockquote>
<h5 id="Synchronizer-Token-Pattern"><a href="#Synchronizer-Token-Pattern" class="headerlink" title="Synchronizer Token Pattern"></a>Synchronizer Token Pattern</h5><p>The predominant and most comprehensive way to protect against CSRF attacks is to use the <a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet#General_Recommendation:_Synchronizer_Token_Pattern" target="_blank" rel="noopener">Synchronizer Token Pattern</a>. This solution is to ensure that each HTTP request requires, in addition to our session cookie, <strong>a secure random generated value called a CSRF token must be present in the HTTP request</strong>.</p>
<p>In summary, it works like this:</p>
<ol>
<li>When a user logged in, <strong>the server should generate a unique CSRF token</strong> associated with the user</li>
<li>When an HTTP request is submitted, it should also <strong>send the CSRF token</strong> that along with the request<ul>
<li><strong>The token should NOT be included in your cookie, or anything that will be automatically included in your browser</strong></li>
<li>You can, for example, include the token in your request header or parameter</li>
</ul>
</li>
<li>The server receiving the request will now check that CSRF token against the expected CSRF token. If the value does not match, reject the request.</li>
</ol>
<p>Just to state the take away message again: the key to this working is that <strong>the actual CSRF token should be in a part of the HTTP request that is not automatically included by the browser</strong>. For example, requiring the actual CSRF token in an HTTP parameter or an HTTP header will protect against CSRF attacks. Requiring the actual CSRF token in a cookie does not work because cookies are automatically included in the HTTP request by the browser.</p>
<p>For example, the request sent with CSRF token now will look like:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;transfer HTTP&#x2F;1.1</span><br><span class="line">Host: bank.example.com</span><br><span class="line">Cookie: JSESSIONID&#x3D;randomid</span><br><span class="line">Content-Type: application&#x2F;x-www-form-urlencoded</span><br><span class="line"></span><br><span class="line">amount&#x3D;100.00&amp;routingNumber&#x3D;1234&amp;account&#x3D;9876&amp;_csrf&#x3D;4bfd1575-3ad1-4d21-96c7-4ef2d9f86721</span><br></pre></td></tr></table></figure>

<p>where:</p>
<ul>
<li><code>4bfd1575-3ad1-4d21-96c7-4ef2d9f86721</code> is the CSRF token</li>
</ul>
<h5 id="Same-Site-Attribute"><a href="#Same-Site-Attribute" class="headerlink" title="Same Site Attribute"></a>Same Site Attribute</h5><p>An emerging way to protect against CSRF attack is to <strong>specify the <a href="https://tools.ietf.org/html/draft-west-first-party-cookies" target="_blank" rel="noopener">SameSite Attribute</a> on cookies</strong>. A server can specify the <code>SameSite</code> attribute when setting a cookie to indicate that the cookie should not be sent when coming from external sites.</p>
<p>However, since <strong>Spring Security does not directly control the creation of the session cookie, it does not provide support for the <code>SameSite</code> attribute</strong>. <a href="https://spring.io/projects/spring-session" target="_blank" rel="noopener">Spring Session</a> provides support for the <code>SameSite</code> attribute in servlet based applications. Spring Framework’s <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/web/server/session/CookieWebSessionIdResolver.html" target="_blank" rel="noopener">CookieWebSessionIdResolver</a> provides out of the box support for the <code>SameSite</code> attribute in WebFlux based applications.</p>
<p>In summary, this works by:</p>
<ol>
<li>When the user logged in/get authenticated, the cookie comes along with the authentication specifies where the cookies get sent<ul>
<li>For example, <strong>if specified <code>SameSite=Strict</code></strong>, then the <strong>cookie will NOT be passed along to different site/request coming from a different site</strong></li>
</ul>
</li>
</ol>
<p>An example, HTTP response header with the <code>SameSite</code> attribute might look like:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Set-Cookie: JSESSIONID&#x3D;randomid; Domain&#x3D;bank.example.com; Secure; HttpOnly; SameSite&#x3D;Lax</span><br></pre></td></tr></table></figure>

<p>Valid values for the <code>SameSite</code> attribute are:</p>
<ul>
<li><code>Strict</code> - when specified any request coming from the <a href="https://tools.ietf.org/html/draft-west-first-party-cookies-07#section-2.1" target="_blank" rel="noopener">same-site</a> will include the cookie. Otherwise, the cookie will not be included in the HTTP request.</li>
<li><code>Lax</code> - when specified cookies will be sent when coming from the <a href="https://tools.ietf.org/html/draft-west-first-party-cookies-07#section-2.1" target="_blank" rel="noopener">same-site</a> or when the request comes from top-level navigations and the <a href="https://docs.spring.io/spring-security/site/docs/5.3.3.BUILD-SNAPSHOT/reference/html5/#csrf-protection-idempotent" target="_blank" rel="noopener">method is idempotent</a>. Otherwise, the cookie will not be included in the HTTP request.</li>
</ul>
<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> <strong>Setting the <code>SameSite</code> attribute to <code>Strict</code> provides a stronger defense but can confuse users</strong>. Consider <strong>a user that stays logged into a social media site hosted at <a href="https://social.example.com/" target="_blank" rel="noopener">https://social.example.com</a></strong>. The user receives <strong>an email at <a href="https://email.example.org/" target="_blank" rel="noopener">https://email.example.org</a> that includes a link to the social media site</strong>. If the user clicks on the link, they would rightfully expect to be authenticated to the social media site. However, <strong>if the <code>SameSite</code> attribute is <code>Strict</code> the cookie would not be sent and so the user would not be authenticated.</strong></li>
</ul>
</blockquote>
<p><strong>There are some important <a href="https://tools.ietf.org/html/draft-west-first-party-cookies-07#section-5" target="_blank" rel="noopener">considerations</a> that one should be aware about when using <code>SameSite</code> attribute</strong> to protect against CSRF attacks.</p>
<p>One obvious consideration is that in order for the <code>SameSite</code> attribute to protect users, <strong>the browser must support the <code>SameSite</code> attribute</strong>. Most modern browsers do <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/headers/Set-Cookie#Browser_compatibility" target="_blank" rel="noopener">support the SameSite attribute</a>. However, older browsers that are still in use may not.</p>
<p>For this reason, it is generally recommended to use the <code>SameSite</code> attribute as a defense in depth rather than the sole protection against CSRF attacks.</p>
<h4 id="When-to-use-CSRF-Protection"><a href="#When-to-use-CSRF-Protection" class="headerlink" title="When to use CSRF Protection"></a>When to use CSRF Protection</h4><p>When should you use CSRF protection? It is recommended to <strong>use CSRF protection for any request that could be processed by a browser by normal/authenticated users</strong>. If you are only creating <strong>a service that is used by non-browser clients</strong>, you will likely want to <strong>disable CSRF protection</strong>.</p>
<h4 id="CSRF-Considerations"><a href="#CSRF-Considerations" class="headerlink" title="CSRF Considerations"></a>CSRF Considerations</h4><p>There are a few special considerations to consider when implementing protection against CSRF attacks.</p>
<h5 id="Logging-in"><a href="#Logging-in" class="headerlink" title="Logging in"></a>Logging in</h5><p>In order to protect against <a href="https://en.wikipedia.org/wiki/Cross-site_request_forgery#Forging_login_requests" target="_blank" rel="noopener">forging log in requests</a> <strong>the log in HTTP request should be protected against CSRF attacks</strong>. Protecting against forging log in requests is necessary <strong>so that a malicious user cannot read a victim’s sensitive information</strong>. The attack is executed by:</p>
<ul>
<li>A malicious user performs a CSRF login using the malicious user’s credentials. The victim is now authenticated as the malicious user.</li>
<li>The malicious user then tricks the victim to visit the compromised website and enter sensitive information</li>
<li><strong>The information is now associated to the malicious user’s account so the malicious user can login with their own credentials and view the victim’s sensitive information</strong></li>
</ul>
<p>A possible complication to ensuring login HTTP requests are protected against CSRF attacks is that the <strong>user might experience a session timeout that causes the request to be rejected.</strong> A session timeout is surprising to users who do not expect to need to have a session in order to log in. For more information refer to <a href="#CSRF-and-Session-Timeouts">CSRF and Session Timeouts</a>.</p>
<h5 id="Logging-Out"><a href="#Logging-Out" class="headerlink" title="Logging Out"></a>Logging Out</h5><p>In order to protect against forging log out requests, the log out HTTP request should be protected against CSRF attacks. Protecting against forging log out requests is necessary so a malicious user cannot read a victim’s sensitive information. For details on the attack refer to <a href="https://labs.detectify.com/2017/03/15/loginlogout-csrf-time-to-reconsider/" target="_blank" rel="noopener">this blog post</a>.</p>
<p>A possible complication to ensuring log out HTTP requests are protected against CSRF attacks is that the user might experience a session timeout that causes the request to be rejected. Please read on to the next section for more details.</p>
<h5 id="CSRF-and-Session-Timeouts"><a href="#CSRF-and-Session-Timeouts" class="headerlink" title="CSRF and Session Timeouts"></a>CSRF and Session Timeouts</h5><p><strong>More often than not, the expected CSRF token is stored in the session</strong>. This means that as soon as the session expires the server will not find an expected CSRF token and reject the HTTP request. There are a number of options to solve timeouts each of which come with trade offs.</p>
<ul>
<li><p>The best way to mitigate the timeout is by using JavaScript to <strong>request a CSRF token on form submission. The form is then updated with the CSRF token and submitted</strong>.</p>
</li>
<li><p>Another option is to have some JavaScript that lets the user know their session is about to expire. The user can click a button to continue and refresh the session.</p>
</li>
<li><p>Finally, the expected CSRF token could be stored in a cookie. This allows the expected CSRF token to outlive the session.</p>
<p>One might ask why the expected CSRF token isn’t stored in a cookie by default. This is because there are known exploits in which headers (i.e. specify the cookies) can be set by another domain. This is the same reason Ruby on Rails <a href="https://weblog.rubyonrails.org/2011/2/8/csrf-protection-bypass-in-ruby-on-rails/" target="_blank" rel="noopener">no longer skips CSRF checks when the header X-Requested-With is present</a>. See <a href="http://lists.webappsec.org/pipermail/websecurity_lists.webappsec.org/2011-February/007533.html" target="_blank" rel="noopener">this webappsec.org thread</a> for details on how to perform the exploit. Another disadvantage is that by removing the state (i.e. the timeout) you lose the ability to forcibly terminate the token if it is compromised.</p>
</li>
</ul>
<h5 id="Multipart-File-Upload"><a href="#Multipart-File-Upload" class="headerlink" title="Multipart (File Upload)"></a>Multipart (File Upload)</h5><p>This is a concern mainly caused by <strong>storing your CSRF token in the request body</strong>.</p>
<p>For example, if one of your request is uploading a file, the body of the HTTP request will be read (e.g. the file). However, since request body is also the place you store your <strong>CSRF token</strong>, this means that <strong>your body must be read to obtain actual CSRF token. However, reading the body means that the file will be uploaded which means an external site can upload a file.</strong></p>
<p>However, this is not too bad, as you can configure your program to delete that file once the request is rejected (that you found the CSRF token is invalid).</p>
<p>Yet, <strong>one approach is to Include CSRF Token in URL:</strong></p>
<ul>
<li>If allowing unauthorized users to upload temporary files is not acceptable, an alternative is to include the expected CSRF token as a query parameter in the action attribute of the form. <strong>The disadvantage to this approach is that query parameters can be leaked</strong>. <strong>More generally, it is considered best practice to place sensitive data within the body or headers to ensure it is not leaked</strong>. Additional information can be found in <a href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec15.html#sec15.1.3" target="_blank" rel="noopener">RFC 2616 Section 15.1.3 Encoding Sensitive Information in URI’s</a>.</li>
</ul>
<h3 id="Security-HTTP-Headers"><a href="#Security-HTTP-Headers" class="headerlink" title="Security HTTP Headers"></a>Security HTTP Headers</h3><p>There are many <a href="https://www.owasp.org/index.php/OWASP_Secure_Headers_Project#tab=Headers" target="_blank" rel="noopener">HTTP response headers</a> that can be used to increase the security of web applications. This section is dedicated to the various HTTP response headers that Spring Security provides explicit support for. <strong>If necessary, Spring Security can also be configured to provide <a href="#Custom-Headers">custom headers</a></strong>.</p>
<h4 id="Custom-Headers"><a href="#Custom-Headers" class="headerlink" title="Custom Headers"></a>Custom Headers</h4><h1 id="Authentication"><a href="#Authentication" class="headerlink" title="Authentication"></a>Authentication</h1>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jasonyux.github.io/2020/07/13/Angular-Manual/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Yu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="From a Beginner to a Disaster">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/13/Angular-Manual/" class="post-title-link" itemprop="url">Angular Manual</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-07-13 15:04:41" itemprop="dateCreated datePublished" datetime="2020-07-13T15:04:41+08:00">2020-07-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-22 21:18:33" itemprop="dateModified" datetime="2020-07-22T21:18:33+08:00">2020-07-22</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <hr>
<p><strong>IMPORTANT</strong>:<br>Much of the content here is a personal summary/abbreviation of contents on the <a href="https://angular.io/guide/architecture" target="_blank" rel="noopener">official documentation</a> and the <a href="https://scrimba.com/" target="_blank" rel="noopener">tutorial on Scrimba</a>. For more complete information, please refer to the <a href="https://angular.io/guide/architecture" target="_blank" rel="noopener">official site</a>.</p>
<hr>
<h1 id="Installing-Angular"><a href="#Installing-Angular" class="headerlink" title="Installing Angular"></a>Installing Angular</h1><p>To install angular, it is recommended that you first install <code>nvm</code> and <code>node</code>: <a href="https://github.com/nvm-sh/nvm" target="_blank" rel="noopener">https://github.com/nvm-sh/nvm</a></p>
<p>Once you have those two installed, you can install the<code>Angular Cli</code>: <a href="https://angular.io/guide/setup-local" target="_blank" rel="noopener">https://angular.io/guide/setup-local</a></p>
<ul>
<li>With <code>Angular Cli</code>, it allows you to <strong>generate much content with some simple commands</strong>. For example, the <code>ng generate</code>/<code>ng g</code> command.</li>
<li>For more information on <code>Angular Cli</code>, please visit <a href="https://cli.angular.io/" target="_blank" rel="noopener">https://cli.angular.io/</a></li>
</ul>
<h1 id="Introduction-to-Angular"><a href="#Introduction-to-Angular" class="headerlink" title="Introduction to Angular"></a>Introduction to Angular</h1><p>Angular is a platform and framework for building single-page client applications using <strong>HTML and TypeScript</strong>. Angular is written in TypeScript. It</p>
<p>implements core and optional functionality as a set of TypeScript libraries that you import into your apps.</p>
<h3 id="Creating-an-Angular-Project"><a href="#Creating-an-Angular-Project" class="headerlink" title="Creating an Angular Project"></a>Creating an Angular Project</h3><p>To create a new angular project, you can use <code>ng new &lt;projectName&gt;</code>, which will generate a new folder with name <code>&lt;projectName&gt;</code> under your current directory, in which your project source code would go.</p>
<p>Once you have created your first project with <code>ng new &lt;projectName&gt;</code>, you will see that it generated many files as shown below:</p>
<p><img src="project-structure.png" alt="project-structure.png" title="project-structure.png"></p>
<p>A high level overview of the usages of those file would be:</p>
<table>
<thead>
<tr>
<th>File</th>
<th>Usage</th>
</tr>
</thead>
<tbody><tr>
<td><code>tslint.js</code></td>
<td>Used to control/standardize certain code/project properties across the team</td>
</tr>
<tr>
<td><code>tsconfig.json</code></td>
<td>Controls the compilation settings for <code>ts</code> (type-script) files</td>
</tr>
<tr>
<td><code>package.json</code></td>
<td>Controls the dependencies that our project has</td>
</tr>
<tr>
<td><code>package-lock.json</code></td>
<td>Controls the dependencies that should be immutable</td>
</tr>
<tr>
<td><code>karma.conf.js</code></td>
<td>Used for unit testing your code</td>
</tr>
<tr>
<td><code>.gitignore</code></td>
<td>Controls which files would be ignored for your git version control</td>
</tr>
<tr>
<td><code>.editorconfig</code></td>
<td>Used for customizing coding format in your editors (some editors don’t use it)</td>
</tr>
<tr>
<td><code>.angular-cli.json</code></td>
<td>Controls packaging/deployment properties of your entire project</td>
</tr>
<tr>
<td><code>src</code></td>
<td>Directory where your source code should live</td>
</tr>
</tbody></table>
<h2 id="Basic-Building-Blocks-of-an-Angular-App"><a href="#Basic-Building-Blocks-of-an-Angular-App" class="headerlink" title="Basic Building Blocks of an Angular App"></a>Basic Building Blocks of an Angular App</h2><p>On a very high level, your application would use the following building blocks:</p>
<p><img src="angular-building-block.png" alt="angular-building-block.png from https://scrimba.com/course/gyourfirstangularapp/enrolled" title="angular-building-block.png from https://scrimba.com/course/gyourfirstangularapp/enrolled"></p>
<ul>
<li><strong>Components</strong><ul>
<li>UI code, how your web application looks</li>
</ul>
</li>
<li><strong>Services</strong><ul>
<li>Frontend/Backend service, which does the computing</li>
</ul>
</li>
<li><strong>Modules</strong><ul>
<li>A container assembling the above two</li>
</ul>
</li>
</ul>
<p>An example would be:</p>
<p><img src="angular-project-example.png" alt="angular-project-example.png https://scrimba.com/course/gyourfirstangularapp/enrolled" title="angular-project-example.png from https://scrimba.com/course/gyourfirstangularapp/enrolled"></p>
<h3 id="Component"><a href="#Component" class="headerlink" title="Component"></a>Component</h3><p>A <code>component</code> in angular is made up of some <strong>html templates and some source codes</strong> (these two combined is also called a <em>view</em>), which can also include/use certain services. </p>
<blockquote>
<ul>
<li>Components define <em>views</em>, which are sets of <strong>screen elements</strong> that Angular can choose among and modify according to your program logic and data.</li>
<li>Components use <em>services</em>, which provide <strong>specific functionality not directly related to views</strong>. Service providers can be <em>injected</em> into components as <em>dependencies</em>, making your code modular, reusable, and efficient.</li>
</ul>
<p>Every Angular application has at least one component, the <em>root component</em> that connects a component hierarchy with the page document object model (DOM). <strong>Each component defines a class that contains application data and logic</strong>, and is <strong>associated with an HTML <em>template</em></strong> that defines a view to be displayed in a target environment.</p>
<p>Source: <a href="https://angular.io/guide/architecture" target="_blank" rel="noopener">https://angular.io/guide/architecture</a></p>
</blockquote>
<p>A <code>component</code> typically has a <strong>selector</strong>,  which would look like <code>&lt;app-customer&gt;&lt;/app-customer&gt;</code> (in this case, <code>app-customzer</code> would be your component name). This is used for Angular in its html to know which component to go to.</p>
<p><img src="component.png" alt="component.png from https://angular.io/guide/architecture" title="Picture from https://angular.io/guide/architecture"></p>
<h4 id="Component-Code"><a href="#Component-Code" class="headerlink" title="Component Code"></a>Component Code</h4><p>Codes in a component typically contains the following elements:</p>
<ul>
<li>Imports<ul>
<li>imports necessary dependencies for your code</li>
</ul>
</li>
<li>Decorators<ul>
<li>Metadata about your component</li>
</ul>
</li>
<li>Class<ul>
<li>Actual code for your UI</li>
</ul>
</li>
</ul>
<p>For example:</p>
<p>Your imports could be:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">`@angular/code`</span>;	<span class="comment">/** This is provided by Angular */</span></span><br><span class="line"><span class="keyword">import</span> &#123; DataService &#125; <span class="keyword">from</span> <span class="string">`../services/data.service`</span> ;	<span class="comment">/** This is not provided by Angular */</span></span><br></pre></td></tr></table></figure>

<p>Your decorators could be:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">    selector: <span class="string">'app-customers'</span>	<span class="comment">// how your selector can identify this component</span></span><br><span class="line">    							<span class="comment">// this is usually done in a format of &lt;projectName&gt;-&lt;componentnName&gt;</span></span><br><span class="line">    templateUrl: <span class="string">'./customers.component.html'</span>	<span class="comment">// the web template that this component will be deployed</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>You define a component’s <strong>application logic</strong> - what it does to support the view - <strong>inside a class</strong>. The class interacts with the view through an API of properties and methods:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> CustomersComponent&#123;	<span class="comment">// export makes this component available for other components</span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>A simple working example could be:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// in your app.component.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector: <span class="string">'app-root'</span>,</span><br><span class="line">  <span class="comment">// below demonstrates inline data binding</span></span><br><span class="line">  <span class="comment">// notice template instead of templateUrl is used</span></span><br><span class="line">  template: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;h1&gt; &#123;&#123;title&#125;&#125; &lt;/h1&gt;</span></span><br><span class="line"><span class="string">  `</span>,</span><br><span class="line">  styleUrls: [<span class="string">'./app.component.css'</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppComponent &#123;</span><br><span class="line">  title = <span class="string">'test-app'</span>; <span class="comment">// bound to here</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>And of course, there needs to be a <strong>module to contain/register that component</strong>:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// in your app.module.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123; BrowserModule &#125; <span class="keyword">from</span> <span class="string">'@angular/platform-browser'</span>;	<span class="comment">// this is used later for data-binding and directives</span></span><br><span class="line"><span class="keyword">import</span> &#123; NgModule &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; AppRoutingModule &#125; <span class="keyword">from</span> <span class="string">'./app-routing.module'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; AppComponent &#125; <span class="keyword">from</span> <span class="string">'./app.component'</span>; <span class="comment">// imports the class AppComponent</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@NgModule</span>(&#123;</span><br><span class="line">  declarations: [</span><br><span class="line">    AppComponent</span><br><span class="line">  ],	<span class="comment">// declaring what is inside this module</span></span><br><span class="line">  imports: [</span><br><span class="line">    BrowserModule,</span><br><span class="line">    AppRoutingModule</span><br><span class="line">  ],  <span class="comment">// importing other modules</span></span><br><span class="line">  providers: [],</span><br><span class="line">  bootstrap: [AppComponent] <span class="comment">// defines which component to load up in this module by default</span></span><br><span class="line">    						<span class="comment">// to go/be rendered into the webpage</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppModule &#123; &#125;</span><br></pre></td></tr></table></figure>

<p>Now, if you run <code>ng serve -o</code>, you will see your server up and running.</p>
<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> <code>ng serve</code> compiles and serves up your application. <code>ng serve -open</code> or <code>ng serve -o</code> will do <code>ng serve</code> and then also opens the web browser with your project’s URL address. </li>
</ul>
</blockquote>
<h4 id="Basic-Mechanism"><a href="#Basic-Mechanism" class="headerlink" title="Basic Mechanism"></a>Basic Mechanism</h4><p>How does<code>Angular</code> node where to look for when it finds <code>&lt;app-root&gt;</code> tag in the <code>main.html</code>?</p>
<ol>
<li>Angular looks at the <code>main.ts</code> file:</li>
</ol>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; enableProdMode &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; platformBrowserDynamic &#125; <span class="keyword">from</span> <span class="string">'@angular/platform-browser-dynamic'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; AppModule &#125; <span class="keyword">from</span> <span class="string">'./app/app.module'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; environment &#125; <span class="keyword">from</span> <span class="string">'./environments/environment'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (environment.production) &#123;</span><br><span class="line">  enableProdMode();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">platformBrowserDynamic().bootstrapModule(AppModule)	<span class="comment">// loads AppModule first, this is also the ROOT module</span></span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> <span class="built_in">console</span>.error(err));</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>Now, in that module, <code>Angular</code> will be told to load <code>AppComponent</code></li>
</ol>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; BrowserModule &#125; <span class="keyword">from</span> <span class="string">'@angular/platform-browser'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; NgModule &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; AppRoutingModule &#125; <span class="keyword">from</span> <span class="string">'./app-routing.module'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; AppComponent &#125; <span class="keyword">from</span> <span class="string">'./app.component'</span>; <span class="comment">// imports the class AppComponent</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@NgModule</span>(&#123;</span><br><span class="line">  declarations: [</span><br><span class="line">    AppComponent</span><br><span class="line">  ],</span><br><span class="line">  imports: [</span><br><span class="line">    BrowserModule,</span><br><span class="line">    AppRoutingModule</span><br><span class="line">  ],  <span class="comment">// importing other modules</span></span><br><span class="line">  providers: [],</span><br><span class="line">  bootstrap: [AppComponent] <span class="comment">// load this on default (if nothing happens on that page)</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppModule &#123; &#125;</span><br></pre></td></tr></table></figure>

<h4 id="Creating-a-Component"><a href="#Creating-a-Component" class="headerlink" title="Creating a Component"></a>Creating a Component</h4><p>To create a component, you can use the command <code>ng g component &lt;component-name&gt;</code>. This will generate a folder with name <code>&lt;component-name&gt;</code> along with four files: </p>
<ul>
<li><code>&lt;component-name&gt;.component.css</code><ul>
<li>the <code>css</code> for the below html page</li>
</ul>
</li>
<li><code>&lt;component-name&gt;.component.html</code><ul>
<li>you can imagine this as a sub-<code>html</code> page that could be injected later into other html</li>
</ul>
</li>
<li><code>&lt;component-name&gt;.component.spec.ts</code></li>
<li><code>&lt;component-name&gt;.component.ts</code><ul>
<li>where your component code goes</li>
</ul>
</li>
</ul>
<p>It is recommended that for each new feature, you use a <code>module</code> to manage those components. Therefore, it is recommended that you add:</p>
<ul>
<li><code>&lt;component-name&gt;.module.ts</code></li>
</ul>
<p>For example, you can populate your <code>&lt;component-name&gt;.component.ts</code> with:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component, OnInit &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// more on metadata covered in the next section</span></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">    selector: <span class="string">'app-customers'</span>,	<span class="comment">// so later we use &lt;app-customer&gt; tag to inject it</span></span><br><span class="line">    templateUrl: <span class="string">'./customers.component.html'</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> CustomersComponent <span class="keyword">implements</span> OnInit &#123;</span><br><span class="line">    title: <span class="built_in">string</span>;</span><br><span class="line">    people: <span class="built_in">any</span>[];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">    </span><br><span class="line">    ngOnInit() &#123;</span><br><span class="line">        <span class="keyword">this</span>.title = <span class="string">'Customers'</span>;</span><br><span class="line">        <span class="comment">// populates the people data</span></span><br><span class="line">        <span class="comment">// this will not be used yet</span></span><br><span class="line">        <span class="keyword">this</span>.people = [</span><br><span class="line">            &#123; id: <span class="number">1</span>, name: <span class="string">'john Doe'</span>, city: <span class="string">'Phoenix'</span>, orderTotal: <span class="number">9.99</span>, customerSince: <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">2014</span>, <span class="number">7</span>, <span class="number">10</span>) &#125;,</span><br><span class="line">            &#123; id: <span class="number">2</span>, name: <span class="string">'Jane Doe'</span>, city: <span class="string">'Chandler'</span>, orderTotal: <span class="number">19.99</span>, customerSince: <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">2017</span>, <span class="number">2</span>, <span class="number">22</span>)&#125;,</span><br><span class="line">            &#123; id: <span class="number">3</span>, name: <span class="string">'Michelle Thomas'</span>, city: <span class="string">'Seattle'</span>, orderTotal: <span class="number">99.99</span>, customerSince: <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">2002</span>, <span class="number">10</span>, <span class="number">31</span>)&#125;,</span><br><span class="line">            &#123; id: <span class="number">4</span>, name: <span class="string">'Jim Thomas'</span>, city: <span class="string">'New York'</span>, orderTotal: <span class="number">599.99</span>, customerSince: <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">2002</span>, <span class="number">10</span>, <span class="number">31</span>)&#125;,</span><br><span class="line">        ];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The template html could be as simple as:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123; title &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br></pre></td></tr></table></figure>

<p>Now, importantly, your <code>&lt;component-Name&gt;.module.ts</code> could be:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; NgModule &#125;      <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; CommonModule &#125; <span class="keyword">from</span> <span class="string">'@angular/common'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; CustomersComponent &#125;  <span class="keyword">from</span> <span class="string">'./customers.component'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@NgModule</span>(&#123;</span><br><span class="line">  imports:      [ CommonModule ],</span><br><span class="line">  declarations: [ CustomersComponent ],</span><br><span class="line">  exports: [ CustomersComponent ]   <span class="comment">// necessary step</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> CustomersModule &#123; &#125;</span><br></pre></td></tr></table></figure>

<p>Now, to make this available, we would need to include this module in our root module - <code>app.module.ts</code> in order for Angular to see our work:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; NgModule &#125;      <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; BrowserModule &#125; <span class="keyword">from</span> <span class="string">'@angular/platform-browser'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; CustomersModule &#125; <span class="keyword">from</span> <span class="string">'./customers/customers.module'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; AppComponent &#125;  <span class="keyword">from</span> <span class="string">'./app.component'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@NgModule</span>(&#123;</span><br><span class="line">  imports:      [ BrowserModule, CustomersModule ],	<span class="comment">// imported here. Since CustomersComponent is exported, it is also available</span></span><br><span class="line">  declarations: [ AppComponent ],</span><br><span class="line">  bootstrap:    [ AppComponent ]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppModule &#123; &#125;</span><br></pre></td></tr></table></figure>

<p>Lastly, your <code>app.component.ts</code> for the <strong>displayed web page would look like</strong>:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component, OnInit &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123; </span><br><span class="line">  selector: <span class="string">'app-root'</span>,</span><br><span class="line">  <span class="comment">// notice that the rendered html for app-customers with all our work above would be injected here</span></span><br><span class="line">  template: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;h1&gt; &#123;&#123;title&#125;&#125; &lt;/h1&gt;</span></span><br><span class="line"><span class="string">    &lt;app-customers&gt;&lt;/app-customers&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppComponent <span class="keyword">implements</span> OnInit &#123;</span><br><span class="line">  title = <span class="string">"Test Title"</span></span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"></span>) &#123; &#125;</span><br><span class="line"></span><br><span class="line">  ngOnInit() &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Component-Metadata"><a href="#Component-Metadata" class="headerlink" title="Component Metadata"></a>Component Metadata</h4><p>The metadata for a component tells Angular <strong>where to get the major building blocks that it needs to create and present the component and its view</strong>. In particular, it associates a <em>template</em> with the component, either directly with inline code, or by reference. Together, the component and its template describe a <em>view</em>.</p>
<p>In addition to containing or pointing to the template, the <code>@Component</code> metadata configures, for example, how the component can be referenced in HTML and <strong>what services it requires</strong>.</p>
<p>For example:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector:    <span class="string">'app-hero-list'</span>,</span><br><span class="line">  templateUrl: <span class="string">'./hero-list.component.html'</span>,</span><br><span class="line">  providers:  [ HeroService ]	<span class="comment">// needs the service from HeroService</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> HeroListComponent <span class="keyword">implements</span> OnInit &#123;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> heroService: HeroService</span>) &#123; &#125;	<span class="comment">// injected service</span></span><br><span class="line">	<span class="comment">/* . . . */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This example shows some of the most useful <code>@Component</code> configuration options:</p>
<ul>
<li><code>selector</code>: A CSS selector that tells Angular to <strong>create and insert an instance of this component wherever it finds the corresponding tag in template HTML</strong>. <ul>
<li>For example, if an app’s HTML contains <code>&lt;app-hero-list&gt;&lt;/app-hero-list&gt;</code>, then Angular inserts an instance of the <code>HeroListComponent</code> view between those tags.</li>
</ul>
</li>
<li><code>templateUrl</code>: The module-relative address of this <strong>component’s HTML template</strong>. Alternatively, you can provide the HTML template inline, as the value of the <code>template</code> property. This template defines the component’s <em>host view</em>.</li>
<li><code>providers</code>: An array of <a href="#Provider">providers</a> for services that the component requires. <ul>
<li>In the example, this tells Angular how to <strong>provide the <code>HeroService</code> instance that the component’s constructor</strong> uses to get the list of heroes to display.</li>
</ul>
</li>
</ul>
<h4 id="Template-Syntax"><a href="#Template-Syntax" class="headerlink" title="Template Syntax"></a>Template Syntax</h4><p>A template <strong>looks like regular HTML</strong>, except that it also contains Angular <a href="https://angular.io/guide/template-syntax" target="_blank" rel="noopener">template syntax</a>, which alters the HTML based on your app’s logic and the state of app and DOM data.</p>
<p>For example, here is a template for the Tutorial’s <code>HeroListComponent</code>.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;h2&gt;Hero List&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;p&gt;&lt;i&gt;Pick a hero from the list&lt;/i</span>&gt;&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">&lt;ul&gt;</span></span><br><span class="line"><span class="regexp">  &lt;li *ngFor="let hero of heroes" (click)="selectHero(hero)"&gt;</span></span><br><span class="line"><span class="regexp">    &#123;&#123;hero.name&#125;&#125;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>li&gt;</span><br><span class="line">&lt;<span class="regexp">/ul&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;app-hero-detail *ngIf="selectedHero" [hero]="selectedHero"&gt;&lt;/</span>app-hero-detail&gt;</span><br></pre></td></tr></table></figure>

<p>This template uses typical HTML elements like <code>&lt;h2&gt;</code> and <code>&lt;p&gt;</code>, and also includes Angular template-syntax elements, <code>*ngFor</code>, <code></code>, <code>(click)</code>, <code>[hero]</code>, and <code>&lt;app-hero-detail&gt;</code>. The template-syntax elements tell Angular how to render the HTML to the screen, using program logic and data.</p>
<p>All those Angular HTML elements above will be explored below. </p>
<h5 id="Data-Binding"><a href="#Data-Binding" class="headerlink" title="Data Binding"></a>Data Binding</h5><p>One of the most important and convenient feature of Angular is its data binding (a feature also common to most Template Engines). However, Angular provides more advanced data bindings as well, which you will find out shortly below.</p>
<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> <strong>Without a framework like Angular</strong>, you would be responsible for pushing data values into the HTML controls and turning user responses into actions and value updates. Writing such push and pull logic by hand is tedious, error-prone, and a nightmare to read, as any experienced front-end JavaScript programmer can attest.</li>
<li><input disabled="" type="checkbox"> One advanced feature of Angular is its <em>two-way data binding</em>, a mechanism for <strong>coordinating the parts of a template with the parts of a component</strong>. Add binding markup to the template HTML to tell Angular how to <strong>connect both sides</strong>.</li>
</ul>
</blockquote>
<p>The following diagram shows the <strong>four forms of data binding markup</strong>. Each form has a direction: to the DOM, from the DOM, or both.</p>
<p><img src="https://angular.io/generated/images/guide/architecture/databinding.png" alt="Picture from https://angular.io/generated/images/guide/architecture/databinding.png" title="Picture from https://angular.io/generated/images/guide/architecture/databinding.png"></p>
<p>The example from the <code>HeroListComponent</code> template above uses <strong>three of these forms</strong>.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;li&gt;&#123;&#123;hero.name&#125;&#125;&lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">&lt;app-hero-detail [hero]="selectedHero"&gt;&lt;/</span>app-hero-detail&gt;</span><br><span class="line">&lt;li (click)=<span class="string">"selectHero(hero)"</span>&gt;&lt;<span class="regexp">/li&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>The <code></code> (inline) <a href="https://angular.io/guide/displaying-data#interpolation" target="_blank" rel="noopener"><em>interpolation</em></a> displays the component’s <strong><code>hero.name</code> property value</strong> within the <code>&lt;li&gt;</code> element.</li>
<li>The <code>[hero]</code> <a href="https://angular.io/guide/template-syntax#property-binding" target="_blank" rel="noopener"><em>property binding</em></a> passes the <strong>value of <code>selectedHero</code></strong> from the parent <code>HeroListComponent</code> to the <code>hero</code> property of the child <code>HeroDetailComponent</code>.</li>
<li>The <code>(click)</code> <a href="https://angular.io/guide/user-input#binding-to-user-input-events" target="_blank" rel="noopener"><em>event binding</em></a> <strong>calls the component’s <code>selectHero</code> method</strong> when the user clicks a hero’s name.</li>
</ul>
<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> If you use interpolation, you can only supply it with a <code>string</code>. If you use property bindings, you can supply it with objects.</li>
<li><input disabled="" type="checkbox"> For property binding, it might look confusing, but it is that the <strong><code>&quot;value&quot;</code> gets rendered from the host component (maps to field with the name <code>value</code>)</strong>, and then that rendered <code>&quot;value&quot;</code> gets passed into the <strong>property with name <code>property</code></strong> for later uses.<ul>
<li><input disabled="" type="checkbox"> If you did <code>property=&quot;value&quot;</code> without brackets, the <code>&quot;value&quot;</code> will not be passed from the component as Angular does not know it is a property binding.</li>
</ul>
</li>
</ul>
</blockquote>
<p><strong>Two-way data binding</strong> (used mainly in <a href="https://angular.io/guide/forms" target="_blank" rel="noopener">template-driven forms</a>) <strong>combines property and event binding in a single notation</strong>. Here’s an example from the <code>HeroDetailComponent</code> template that uses two-way data binding with the <code>ngModel</code> directive.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input [(ngModel)]=<span class="string">"hero.name"</span>&gt;</span><br></pre></td></tr></table></figure>

<p>In two-way binding:</p>
<ul>
<li>First, a data property value flows to the input box from the component as <strong>with property binding</strong>. (Why it starts with a <code>[]</code>)</li>
<li>Then, if the user’s changes the field, it also flow back to the component, resetting the property to the latest value, as with <strong>event binding</strong>.</li>
</ul>
<p><img src="https://angular.io/generated/images/guide/architecture/component-databinding.png" alt="Picture from https://angular.io/generated/images/guide/architecture/component-databinding.png" title="Picture from https://angular.io/generated/images/guide/architecture/component-databinding.png"></p>
<h6 id="Class-Binding"><a href="#Class-Binding" class="headerlink" title="Class Binding"></a>Class Binding</h6><p>You can also add and remove CSS class from an element’s <code>class</code> attribute with a <strong>class binding</strong>.</p>
<p>Here’s how to set the <code>class</code> attribute without a binding in plain HTML:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- standard class attribute setting --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"fooBar"</span>&gt;</span>Some text<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>To create a <strong><em>single class binding</em></strong>, <strong>start with the prefix <code>class</code> followed by a dot (<code>.</code>) and the name of the CSS class</strong> (for example, <code>[class.foo]=&quot;hasFoo&quot;</code>). Angular <strong>adds the class when the bound expression is true</strong>, and it <strong>removes the class when the expression is false</strong>:</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> [<span class="attr">class.fooBar</span>]=<span class="string">"&lt;some expression&gt;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>If <code>&lt;some expression&gt;</code> evaluates to <code>true</code>, then the CSS class <code>foorBar</code> will be added</li>
<li>If <code>&lt;some expression&gt;</code> evaluates to <code>false/undefined/null</code>, then the CSS class <code>foorBar</code> will not be added or be removed (if added)</li>
</ul>
<ol start="2">
<li>To create a <strong><em>binding to multiple classes</em></strong>, use a generic <code>[class]</code> binding without the dot (for example, <code>[class]=&quot;classExpr&quot;</code>). The expression can be a space-delimited string of class names, or you can format it as an object with class names as the keys and true/false expressions as the values. With object format, Angular will add a class only if its associated value is truthy.</li>
</ol>
<table>
<thead>
<tr>
<th align="left">Binding Type</th>
<th align="left">Syntax</th>
<th align="left">Input Type</th>
<th align="left">Example Input Values</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Single class binding</td>
<td align="left"><code>[class.foo]=&quot;hasFoo&quot;</code></td>
<td align="left">`boolean</td>
<td align="left">undefined</td>
</tr>
<tr>
<td align="left">Multi-class binding</td>
<td align="left"><code>[class]=&quot;classExpr&quot;</code></td>
<td align="left"><code>string</code></td>
<td align="left"><code>&quot;my-class-1 my-class-2 my-class-3&quot;</code></td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left">`{[key: string]: boolean</td>
<td align="left">undefined</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>Array&lt;string&gt;</code></td>
<td align="left"><code>[&#39;foo&#39;, &#39;bar&#39;]</code></td>
</tr>
</tbody></table>
<h5 id="Pipes"><a href="#Pipes" class="headerlink" title="Pipes"></a>Pipes</h5><p>Angular pipes let you declare display-value-transformations in your template HTML. A class with the <code>@Pipe</code> decorator defines a <strong>function that transforms input values to output values for display in a view</strong>.</p>
<p>Angular defines various pipes, such as the <a href="https://angular.io/api/common/DatePipe" target="_blank" rel="noopener">date</a> pipe and <a href="https://angular.io/api/common/CurrencyPipe" target="_blank" rel="noopener">currency</a> pipe; for a complete list, see the <a href="https://angular.io/api?type=pipe" target="_blank" rel="noopener">Pipes API list</a>. You can also define new pipes.</p>
<p>To specify a value transformation in an HTML template, use the <a href="https://angular.io/guide/template-syntax#pipe" target="_blank" rel="noopener">pipe operator <code>|</code></a>.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;interpolated_value | pipe_name&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>You can chain pipes, sending the output of one pipe function to be transformed by another pipe function. A pipe can also <strong>take arguments that control how it performs its transformation</strong>. For example, you can pass the desired format to the <strong><code>date</code> pipe</strong>.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- Default format: output <span class="string">'Jun 15, 2015'</span>--&gt;</span><br><span class="line"> &lt;p&gt;Today is &#123;&#123;today | date&#125;&#125;&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;!-- fullDate format: output 'Monday, June 15, 2015'--&gt;</span></span><br><span class="line"><span class="regexp">&lt;p&gt;The date is &#123;&#123;today | date:'fullDate'&#125;&#125;&lt;/</span>p&gt;</span><br><span class="line"></span><br><span class="line"> &lt;!-- shortTime format: output <span class="string">'9:43 AM'</span>--&gt;</span><br><span class="line"> &lt;p&gt;The time is &#123;&#123;today | date:<span class="string">'shortTime'</span>&#125;&#125;&lt;<span class="regexp">/p&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="Directives"><a href="#Directives" class="headerlink" title="Directives"></a>Directives</h5><p>Angular templates are <em>dynamic</em>. When Angular renders them, it <strong>transforms the DOM according to the instructions given by <em>directives</em></strong>. A directive is a class with a <code>@Directive()</code> decorator.</p>
<blockquote>
<p>Note: </p>
<ul>
<li><input disabled="" type="checkbox"> A component is technically a directive. However, components are so distinctive and central to Angular applications that Angular defines the <code>@Component()</code> decorator, which extends the <code>@Directive()</code> decorator with template-oriented features.</li>
</ul>
</blockquote>
<p>In addition to components, there are <strong>two other kinds of directives</strong>: <em>structural</em> and <em>attribute</em>. Angular defines a number of directives of both kinds, and you can define your own using the <code>@Directive()</code> decorator.</p>
<p>Just as for components, the metadata for a directive associates the decorated class with a <code>selector</code> element that you use to insert it into HTML. In templates, <strong>directives typically appear within an element tag as attributes</strong>, either by name or as the target of an assignment or a binding.</p>
<h6 id="Structural-Directives"><a href="#Structural-Directives" class="headerlink" title="Structural Directives"></a>Structural Directives</h6><p><em>Structural directives</em> <strong>alter layout by adding, removing, and replacing elements in the DOM</strong> (hence changing parts of its structure). The example template uses <strong>two built-in structural directives to add application logic to how the view is rendered</strong>.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;li *ngFor=<span class="string">"let hero of heroes"</span>&gt;&lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">&lt;app-hero-detail *ngIf="selectedHero"&gt;&lt;/</span>app-hero-detail&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><a href="https://angular.io/guide/displaying-data#ngFor" target="_blank" rel="noopener"><code>*ngFor</code></a> is an iterative; it tells Angular to stamp out one <code>&lt;li&gt;</code> per hero in the <code>heroes</code> list.</li>
<li><a href="https://angular.io/guide/displaying-data#ngIf" target="_blank" rel="noopener"><code>*ngIf</code></a> is a conditional; it includes the <code>HeroDetail</code> component only if a selected hero exists.</li>
</ul>
<h6 id="Attribute-Directives"><a href="#Attribute-Directives" class="headerlink" title="Attribute Directives"></a>Attribute Directives</h6><p><em>Attribute directives</em> alter the <strong>appearance or behavior of an existing element</strong> (hence not changing the overall DOM structure). In templates they look like regular HTML attributes, hence the name.</p>
<p>The <code>ngModel</code> directive, which implements two-way data binding, is an example of an attribute directive. <code>ngModel</code> <strong>modifies the behavior of an existing element</strong> (typically <code>&lt;input&gt;</code>) by setting its display value property and responding to change events.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input [(ngModel)]=<span class="string">"hero.name"</span>&gt;</span><br></pre></td></tr></table></figure>

<p>For more information on directives, learn more in the <a href="https://angular.io/guide/attribute-directives" target="_blank" rel="noopener">Attribute Directives</a> and <a href="https://angular.io/guide/structural-directives" target="_blank" rel="noopener">Structural Directives</a> guides.</p>
<h3 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h3><p>A Module in Angular is called a <code>NgModule</code>, which can be interpreted as a container <strong>assembling some of your components and services for a specific feature</strong>.</p>
<blockquote>
<p>An <code>NgModule</code> declares a <strong>compilation context for a set of components</strong> that is dedicated to an application domain, a workflow, or a closely related set of capabilities. An <code>NgModule</code> can <strong>associate its components with related code, such as services,</strong> to form functional units.</p>
<p>Every Angular app has a <em>root module</em>, conventionally named <code>AppModule</code>, which provides the <strong>bootstrap mechanism that launches the application</strong>. An app typically contains many functional modules.</p>
<p>Like JavaScript modules, <strong><code>NgModules</code> can import functionality from other <code>NgModules</code></strong>, and allow their own functionality to be exported and used by other <code>NgModules</code>. For example, to use the router service in your app, you import the <code>Router</code> <code>NgModule</code>.</p>
<p>Source:  <a href="https://angular.io/guide/architecture" target="_blank" rel="noopener">https://angular.io/guide/architecture</a></p>
</blockquote>
<h4 id="NgModule-Metadata"><a href="#NgModule-Metadata" class="headerlink" title="NgModule Metadata"></a><code>NgModule</code> Metadata</h4><p>An <code>NgModule</code> is defined by a class <strong>decorated with <code>@NgModule()</code></strong>. The <code>@NgModule()</code> decorator is a <strong>function that takes a single metadata object</strong> (why it is surrounded by a <code>{}</code>), whose properties describe the module. The most important properties are as follows.</p>
<ul>
<li><code>declarations</code>: The <a href="#Component">Component</a>, <em>directives</em>, and <em>pipes</em> that belong to this <code>NgModule</code>.</li>
<li><code>exports</code>: The subset of declarations that <strong>should be visible and usable</strong> in the <em>component templates</em> of <strong>other <code>NgModules</code> (when imported)</strong>.</li>
<li><code>imports</code>: Other modules whose <strong>exported classes are needed</strong> by component templates declared in <em>this</em> <code>NgModule</code>.</li>
<li><code>providers</code>: Creators of <a href="#Service">Service</a> that this <code>NgModule</code> contributes to the global collection of services; they become <strong>accessible in all parts of the app</strong>. (You can also <strong>specify providers at the component level, which is often preferred.</strong>)</li>
<li><code>bootstrap</code>: The main application view, called the <em>root component</em>, which hosts all other app views. <strong>Only the <em>root <code>NgModule</code></em> (of a specific view) should set the <code>bootstrap</code> property</strong>.</li>
</ul>
<p>An example would be:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; NgModule &#125;      <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; BrowserModule &#125; <span class="keyword">from</span> <span class="string">'@angular/platform-browser'</span>;</span><br><span class="line"><span class="meta">@NgModule</span>(&#123;</span><br><span class="line">  imports:      [ BrowserModule ],</span><br><span class="line">  providers:    [ Logger ],</span><br><span class="line">  declarations: [ AppComponent ],</span><br><span class="line">  exports:      [ AppComponent ],	<span class="comment">// technically not necessary here as it is the root module</span></span><br><span class="line">  bootstrap:    [ AppComponent ]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppModule &#123; &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> A component and its template together define a <em>view</em>. You can imagine a <em>view</em> as a sub-html page that is rendered by Angular.</li>
</ul>
</blockquote>
<h4 id="NgModule-and-Component"><a href="#NgModule-and-Component" class="headerlink" title="NgModule and Component"></a><code>NgModule</code> and Component</h4><p>The aim of a component is to create a <em>view</em> with a html template. <strong>When you create a component, it is associated directly with a single view, called the <em>host view</em> (for this component).</strong> The host view can be the root of a view hierarchy, which can contain <strong><em>embedded views</em>, which are in turn the host views of other components</strong>. </p>
<p>Those components can be in the same <code>NgModule</code>, or can be imported from other <code>NgModules</code>. Views in the tree can be nested to any depth.</p>
<p>A simple example of a view hierarchy could be:</p>
<p><img src="view-hierachy.png" alt="view-hierachy.png from https://angular.io/guide/architecture-modules" title="view-hierachy.png from https://angular.io/guide/architecture-modules"></p>
<p>The aim of a Module/<code>NgModule</code> is to define a <strong><em>compilation context</em></strong> - the context where Angular should be able to <strong>find all necessary components for rendering a provided html template</strong>.</p>
<p>A root <code>NgModule</code> always has a root component that is created during bootstrap, but any <code>NgModule</code> can include any number of additional components, which can be loaded through the router or created through the template. The components that belong to an <code>NgModule</code> share a compilation context.</p>
<h4 id="Angular-Library-Modules"><a href="#Angular-Library-Modules" class="headerlink" title="Angular Library Modules"></a>Angular Library Modules</h4><p>Angular loads as a collection of JavaScript modules. You can think of them as library modules. <strong>Each Angular library name begins with the <code>@angular</code> prefix</strong>. Install them with the node package manager <code>npm</code> and import parts of them with JavaScript <code>import</code> statements.</p>
<p><code>NgModules</code> from Angular <em>libraries</em> using JavaScript import statements. For example, the following code imports the <code>BrowserModule</code> <code>NgModule</code> from the <code>platform-browser</code> library.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; BrowserModule &#125; <span class="keyword">from</span> <span class="string">'@angular/platform-browser'</span>;</span><br></pre></td></tr></table></figure>

<p>In the example of the simple root module above, the application module needs material from within <code>BrowserModule</code>. To access that material, add it to the <code>@NgModule</code> metadata <code>imports</code> like this.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NgModule</span>(&#123;</span><br><span class="line">    ...</span><br><span class="line">    imports: [ BrowserModule ],	<span class="comment">// importing makes classes exported in that module available in this compilation context</span></span><br><span class="line">    ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="Service"><a href="#Service" class="headerlink" title="Service"></a>Service</h3><p>A Service is usually pieces of code (function, data, feature) that are used <strong>across different components</strong>.</p>
<blockquote>
<p>A service class definition is immediately preceded by the <code>@Injectable()</code> decorator. The decorator provides the metadata that allows other providers to be <strong>injected</strong> as dependencies into your class.</p>
<p>For example: The Angular <code>Router</code> <code>NgModule</code> provides a service that lets you <strong>define a navigation path among the different application states and view hierarchies in your app</strong>. (More on Routers will be covered later)</p>
<p>Source:  <a href="https://angular.io/guide/architecture" target="_blank" rel="noopener">https://angular.io/guide/architecture</a></p>
</blockquote>
<p>Angular distinguishes components from services to increase modularity and reusability. By <strong>separating a component’s view-related functionality from other kinds of processing</strong>, you can make your component classes clean and efficient.</p>
<h4 id="Example-of-a-Service"><a href="#Example-of-a-Service" class="headerlink" title="Example of a Service"></a>Example of a Service</h4><p>Here would be an example of a service (class) - <code>src/app/logger.service.ts</code> :</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> Logger &#123;</span><br><span class="line">  log(msg: <span class="built_in">any</span>)   &#123; <span class="built_in">console</span>.log(msg); &#125;</span><br><span class="line">  error(msg: <span class="built_in">any</span>) &#123; <span class="built_in">console</span>.error(msg); &#125;</span><br><span class="line">  warn(msg: <span class="built_in">any</span>)  &#123; <span class="built_in">console</span>.warn(msg); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>(The above is just a simple example, an actual service usually has the <code>@Injectable()</code> annotation, in order to be registered with an Angular dependency injector. More on this later.)</p>
<p>Services can <strong>depend on other services</strong> (made available by <em>dependency injection</em>). For example, here’s a <code>HeroService</code> that depends on the <code>Logger</code> service, and also uses <code>BackendService</code> to get heroes. That service in turn might depend on the <code>HttpClient</code> service to fetch heroes asynchronously from a server.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> HeroService &#123;</span><br><span class="line">  <span class="keyword">private</span> heroes: Hero[] = [];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// constructor injection</span></span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> backend: BackendService,</span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> logger: Logger</span>) &#123; &#125;</span><br><span class="line"></span><br><span class="line">  getHeroes() &#123;</span><br><span class="line">    <span class="keyword">this</span>.backend.getAll(Hero).then( <span class="function">(<span class="params">heroes: Hero[]</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.logger.log(<span class="string">`Fetched <span class="subst">$&#123;heroes.length&#125;</span> heroes.`</span>);</span><br><span class="line">      <span class="keyword">this</span>.heroes.push(...heroes); <span class="comment">// fill cache</span></span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.heroes;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Dependency-Injection-DI"><a href="#Dependency-Injection-DI" class="headerlink" title="Dependency Injection (DI)"></a>Dependency Injection (DI)</h4><p>DI is wired into the Angular framework and used everywhere to <strong>provide new components with the services or other things they need</strong>. </p>
<p>Components consume services; that is, you can <em>inject</em> a service into a component, giving the component access to that service class.</p>
<p>To define a class as a service in Angular, <strong>use the <code>@Injectable()</code> decorator to provide the metadata that allows Angular to inject it into a component as a <em>dependency</em></strong>. Similarly, <strong>use the <code>@Injectable()</code> decorator</strong> to indicate that a component or other class (such as another service, a pipe, or an <code>NgModule</code>) <strong><em>has</em> a dependency</strong>.</p>
<h5 id="Dependency-Injection-Mechanism"><a href="#Dependency-Injection-Mechanism" class="headerlink" title="Dependency Injection Mechanism"></a>Dependency Injection Mechanism</h5><p>In general, there are <strong>three components involved</strong>:</p>
<ul>
<li>The <em>injector</em> is the main mechanism. Angular creates <strong>an application-wide injector</strong> for you during the bootstrap process, and additional injectors as needed. You don’t have to create injectors.</li>
<li><strong>An injector creates dependencies, and maintains a <em>container</em> of dependency instances</strong> that it reuses if possible.<ul>
<li>All of those are done behind the scene.</li>
</ul>
</li>
<li><strong>A <em>provider</em></strong> is an object that tells an injector how to <strong>obtain or create a dependency</strong>.</li>
</ul>
<p>Angular does dependency injection by the following three steps:</p>
<ol>
<li><p>When Angular creates a new instance of a component class, it <strong>determines which services or other dependencies that component needs by looking at the constructor parameter types</strong>.</p>
<p>For example, the <code>HeroService</code> dependency will be injected in the example below:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> service: HeroService</span>) &#123; &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>When Angular discovers that a component depends on a service, it first <strong>checks if the injector has any existing instances of that service</strong>. If a <strong>requested service instance doesn’t yet exist, the injector makes one using the registered provider</strong>, and adds it to the injector before returning the service to Angular.</p>
</li>
<li><p>When all requested services have been resolved and returned, Angular can call the component’s constructor with those services as arguments.</p>
</li>
</ol>
<p><img src="https://angular.io/generated/images/guide/architecture/injector-injects.png" alt="Picture from https://angular.io/generated/images/guide/architecture/injector-injects.png" title="Picture from https://angular.io/generated/images/guide/architecture/injector-injects.png"></p>
<h5 id="Using-Dependency-Injection"><a href="#Using-Dependency-Injection" class="headerlink" title="Using Dependency Injection"></a>Using Dependency Injection</h5><p>For any using dependency that you need in your app, you must:</p>
<ol>
<li><strong>Register a provider for the dependency</strong> (class/function/value) with the app’s injector (with <code>@Injectable</code>), so that the injector can use the provider to create new instances. For a service, the <strong>provider is typically the service class itself</strong>.<ul>
<li>This can be done either directly within the same service class, or in a specific module/component, since this process is done by annotation metadata.</li>
</ul>
</li>
<li>Inject that dependency by <strong>including it in the constructor argument</strong>.<ul>
<li>This can be done in three different ways. Each of which would be available project-wide.</li>
</ul>
</li>
</ol>
<ul>
<li><p><strong><em>Case 1: You registered the service within the same service class:</em></strong></p>
<p>​    This can be done by either <strong>creating the service with Angular CLI <code>ng g service &lt;service-name&gt;</code></strong>, which will automatically include the annotation:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Injectable</span>(&#123;</span><br><span class="line"> providedIn: <span class="string">'root'</span>,	<span class="comment">// provides the dependecy at the root level</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>​    Or <strong>including the above annotation manually</strong> in your service class.</p>
<p>​    When you provide the service at the root level, <strong>Angular creates a single, shared instance of <code>HeroService</code> available to the entire project and injects it into any class that asks for it</strong>. Registering the provider in the <code>@Injectable()</code> metadata also allows Angular to optimize an app by removing the service from the compiled app if it isn’t used.</p>
</li>
<li><p><strong><em>Case 2: You registered the service within a specific <code>NgModule</code></em></strong></p>
<p>​    In this case, the same instance of a service is <strong>available to all components in that <code>NgModule</code></strong>. To register at this level, <strong>use the <code>providers</code> property of the <code>@NgModule()</code> decorator</strong>.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@NgModule</span>(&#123;</span><br><span class="line">  <span class="comment">// injecting at a module level</span></span><br><span class="line">  providers: [</span><br><span class="line">  BackendService,</span><br><span class="line">  Logger</span><br><span class="line"> ],</span><br><span class="line"> ...</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong><em>Case 3: You registered the service within a specific <code>Component</code></em></strong></p>
<p>​    When you register a provider at the component level, you <strong>get a new instance of the service with each new instance of that component</strong>. At the component level, register a service provider in the <code>providers</code> property of the <code>@Component()</code> metadata.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector:    <span class="string">'app-hero-list'</span>,</span><br><span class="line">  templateUrl: <span class="string">'./hero-list.component.html'</span>,</span><br><span class="line">  providers:  [ HeroService ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>


</li>
</ul>
<h1 id="Angular-Fundamentals"><a href="#Angular-Fundamentals" class="headerlink" title="Angular Fundamentals"></a>Angular Fundamentals</h1><p>This chapter covers, in more details, the functionalities that Angular brings to developing a frontend application. This chapter will also touch on (in the end) how to communicate with a backend server for getting/updating/posting data.</p>
<h2 id="Template-Syntax-1"><a href="#Template-Syntax-1" class="headerlink" title="Template Syntax"></a>Template Syntax</h2><p>This section is a comprehensive technical summary to the Angular template language (for a more complete reference, please visit <a href="https://angular.io/guide/template-syntax" target="_blank" rel="noopener">https://angular.io/guide/template-syntax</a>). This section seeks to explain basic principles of the template language and describes most of the syntax that you’ll encounter elsewhere in the guide.</p>
<h3 id="Interpolation"><a href="#Interpolation" class="headerlink" title="Interpolation"></a>Interpolation</h3><p>Interpolation refers to embedding expressions into marked up text. By default, interpolation uses as its delimiter the double curly braces, <code></code>.</p>
<p>The text between the braces is a <strong>template expression</strong> that Angular first <strong>evaluates</strong> and then <strong>converts to a string</strong>. The following interpolation illustrates the point:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- "The sum of 1 + 1 is 2" --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>The sum of 1 + 1 is &#123;&#123;1 + 1&#125;&#125;.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Other common usages include: --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;title&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Can also be used within a DOM property, in this case it will be similar to property binding --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;&#123;itemImageUrl&#125;&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- "The sum of 1 + 1 is not 4 (getVal() returns 2)" --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>The sum of 1 + 1 is not &#123;&#123;1 + 1 + getVal()&#125;&#125;.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>With interpolation, you can basically <strong>access everything defined in the bound <code>component.ts</code></strong> including:</p>
<ul>
<li>methods</li>
<li>variables</li>
<li>constants</li>
</ul>
<p>You can also do some basic operations within `{{ }}`. See <a href="#Template-Expressions">Template Expressions</a> for more details.</p>
<blockquote>
<p> Note:</p>
<ul>
<li><input disabled="" type="checkbox"> <strong>Interpolation cannot evaluate data structure other than a primitive</strong>. If you are trying to evaluate an Object, then it will render it as <code>[object Object]</code> (obviously not what you want). If you want to use complex data structures, you need to use <a href="#Property-Binding">Property Binding</a> or a Pipe operator <code>|</code>.</li>
</ul>
</blockquote>
<h3 id="Template-Expressions"><a href="#Template-Expressions" class="headerlink" title="Template Expressions"></a>Template Expressions</h3><p>A template <strong>expression</strong> produces a value and appears within the double curly braces, {{ }} . Angular executes the expression and assigns it to a property of a binding target; the target could be an <code>DOM</code> property, a component, or a directive.</p>
<p>For example: the interpolation braces in  {{1 + 1}}  surround the template expression <code>1 + 1</code>. In the <strong>property binding</strong>, <strong>a template expression appears in quotes to the right</strong> of the <code>=</code> symbol as in <code>[property]=&quot;expression&quot;</code>.</p>
<p>The Angular template expression language employs a <strong>subset of JavaScript syntax</strong> supplemented with a few special operators for specific scenarios. The next sections cover three of these operators:</p>
<ul>
<li>pipe <code>|</code></li>
<li>safe navigation operator</li>
<li>non-null assertion operator</li>
</ul>
<h4 id="Pipe-Operator"><a href="#Pipe-Operator" class="headerlink" title="Pipe Operator |"></a>Pipe Operator <code>|</code></h4><p>The result of an expression might <strong>require some transformation before you’re ready to use it in a binding</strong>. For example, you might display a number as a currency, change text to uppercase, or filter a list and sort it (<strong>visit <a href="#Pipes">Pipes</a> for information on available pipe functions</strong>).</p>
<p>Pipes are simple functions that <strong>accept an input value and return a transformed value</strong>. They’re easy to apply <strong>within template expressions</strong>, using the pipe operator (<code>|</code>):</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Title through uppercase pipe: &#123;&#123;title | uppercase&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Some example usages include:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- convert title to uppercase, then to lowercase --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Title through a pipe chain: &#123;&#123;title | uppercase | lowercase&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- pipe with configuration argument =&gt; "February 25, 1980" --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Manufacture date with date format pipe: &#123;&#123;item.manufactureDate | date:'longDate'&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- The json pipe is particularly helpful for debugging bindings: --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Item json pipe: &#123;&#123;item | json&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> The pipe operator has <strong>a higher precedence than the ternary operator (<code>?:</code>)</strong>, which means <code>a ? b : c | x</code> is parsed as <code>a ? b : (c | x)</code>. Nevertheless, for a number of reasons, the pipe operator cannot be used without parentheses in the first and second operands of <code>?:</code>. <strong>A good practice is to use parentheses in the third operand too.</strong></li>
</ul>
</blockquote>
<h4 id="Safe-Navigation-Operator"><a href="#Safe-Navigation-Operator" class="headerlink" title="Safe Navigation Operator ?"></a>Safe Navigation Operator <code>?</code></h4><p>The Angular safe navigation operator, <code>?</code>, guards against <code>null</code> and <code>undefined</code> values in property paths. Here, it protects against a <strong>view render failure if <code>item</code> is <code>null</code></strong> (if <code>null</code> error occurs, the entire module associated with it might fail to render and cause wrong html codes being displayed). </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>The item name is: &#123;&#123;item?.name&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>With the safe navigation operator, <code>?</code>, Angular <strong>stops evaluating the expression when it hits the first <code>null</code> value</strong> and renders the view without errors.</p>
<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> Sometimes however, <code>null</code> values in the property path may be OK under certain circumstances, especially when the value starts out null but the data arrives eventually. In this case, you need to be careful for using <code>?</code> as it will stop evaluating immediately once it is null.</li>
</ul>
</blockquote>
<p>The <code>?</code> operator works perfectly with long property paths such as <code>a?.b?.c?.d</code> as well.</p>
<h4 id="Non-Null-Assertion-Operator"><a href="#Non-Null-Assertion-Operator" class="headerlink" title="Non-Null Assertion Operator !"></a>Non-Null Assertion Operator <code>!</code></h4><p>By default, the type checker also throws an error if it can’t determine whether a variable will be <code>null</code> or <code>undefined</code> at runtime. In this case, you can tell the type checker <strong>not to throw an error by applying the postfix <a href="http://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-0.html#non-null-assertion-operator" target="_blank" rel="noopener">non-null assertion operator, !</a>.</strong></p>
<p>The Angular non-null assertion operator, <code>!</code>, <strong>serves the same purpose in an Angular template</strong>. For example, you can assert that <code>item</code> properties are also defined.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Assert color is defined, even if according to the `Item` type it could be undefined. --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>The item's color is: &#123;&#123;item.color!.toUpperCase()&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>When the Angular compiler turns your template into TypeScript code, it prevents TypeScript from reporting that <code>item.color</code> might be <code>null</code> or <code>undefined</code>.</p>
<blockquote>
<p> Note:</p>
<ul>
<li><input disabled="" type="checkbox"> Unlike the <a href="#Safe-Navigation-Operator-`?`"><em>safe navigation operator</em></a>, the non-null assertion operator <strong>does not guard against <code>null</code> or <code>undefined</code></strong>. Rather, it tells the TypeScript type checker to suspend strict <code>null</code> checks for a specific property expression.</li>
</ul>
</blockquote>
<h4 id="Built-in-Template-Functions"><a href="#Built-in-Template-Functions" class="headerlink" title="Built-in Template Functions"></a>Built-in Template Functions</h4><p>Sometimes a binding expression triggers a type error during <a href="https://angular.io/guide/aot-compiler" target="_blank" rel="noopener">AOT compilation</a> and it is <strong>not possible or difficult to fully specify the type</strong>. To <strong>silence the error</strong>, you can use the <code>$any()</code> cast function to cast the expression to the <a href="http://www.typescriptlang.org/docs/handbook/basic-types.html#any" target="_blank" rel="noopener"><code>any</code> type</a> as in the following example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>The item's undeclared best by date is: &#123;&#123;$any(item).bestByDate&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- The $any() cast function also works with this to allow access to undeclared members of the component. --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>The item's undeclared best by date is: &#123;&#123;$any(this).bestByDate&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>When the Angular compiler turns this template into TypeScript code, it prevents TypeScript from reporting that <code>bestByDate</code> is not a member of the <code>item</code> object when it runs type checking on the template.</p>
<h3 id="Data-Binding-and-DOM-Property"><a href="#Data-Binding-and-DOM-Property" class="headerlink" title="Data Binding and DOM Property"></a>Data Binding and DOM Property</h3><p>Angular provides many kinds of data-binding. Binding types can be grouped into three categories distinguished by the direction of data flow:</p>
<ul>
<li>From the <em>source-to-view</em></li>
<li>From <em>view-to-source</em></li>
<li>Two-way sequence: <em>view-to-source-to-view</em></li>
</ul>
<table>
<thead>
<tr>
<th align="left">Type</th>
<th align="left">Syntax</th>
<th align="left">Category</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Interpolation Property Attribute Class Style</td>
<td align="left"><code> [target]=&quot;expression&quot;</code> <code>bind-target=&quot;expression&quot;</code></td>
<td align="left">One-way from data source to view target</td>
</tr>
<tr>
<td align="left">Event</td>
<td align="left"><code>(target)=&quot;statement&quot;</code> <code>on-target=&quot;statement&quot;</code></td>
<td align="left">One-way from view target to data source</td>
</tr>
<tr>
<td align="left">Two-way</td>
<td align="left"><code>[(target)]=&quot;expression&quot;</code> <code>bindon-target=&quot;expression&quot;</code></td>
<td align="left">Two-way</td>
</tr>
</tbody></table>
<p>Binding types other than interpolation have a <strong>target name to the left of the equal sign</strong>, either surrounded by punctuation, <code>[]</code> or <code>()</code>, or preceded by a prefix: <code>bind-</code>, <code>on-</code>, <code>bindon-</code>, and an <strong>expression to the right of the equal sign</strong>.</p>
<p>The <em>target</em> of a binding is the <strong>DOM property or event inside the binding punctuation</strong>: <code>[]</code>, <code>()</code> or <code>[()]</code>, it is <strong>not the attribute of the html tag</strong> (see below section).</p>
<h4 id="HTML-Attribute-vs-DOM-Property"><a href="#HTML-Attribute-vs-DOM-Property" class="headerlink" title="HTML Attribute vs. DOM Property"></a>HTML Attribute vs. DOM Property</h4><p>For more details, please see this <a href="https://stackoverflow.com/questions/6003819/what-is-the-difference-between-properties-and-attributes-in-html" target="_blank" rel="noopener">StackOverflow post</a>.</p>
<p>In summary, when you write some html code such as:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">"text"</span> value=<span class="string">"Name:"</span>&gt;</span><br></pre></td></tr></table></figure>

<p>You have defined <strong>2 attributes (<code>type</code> and <code>value</code>)</strong>. However, to actually display the page, the <strong>browser will first parse this code and create an Object</strong>.</p>
<blockquote>
<p>Once the browser parses this code, a <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLInputElement" target="_blank" rel="noopener">HTMLInputElement</a> object will be created, and this <strong>object will contain dozens of properties</strong> like: <code>accept</code>, <code>accessKey</code>, <code>align</code>, <code>alt</code>, <code>attributes</code>, <code>autofocus</code>, <code>baseURI</code>, <code>checked</code>, <code>childElementCount</code>, <code>childNodes</code>, <code>children</code>, <code>classList</code>, <code>className</code>, <code>clientHeight</code>, etc. </p>
<p>Source: this <a href="https://stackoverflow.com/questions/6003819/what-is-the-difference-between-properties-and-attributes-in-html" target="_blank" rel="noopener">StackOverflow post</a>.</p>
</blockquote>
<p>In the end, if some event happened and something in your html has changed, it will be the property of the DOM object being changed, <strong>not its html attribute</strong>.</p>
<h4 id="Possible-Binding-Targets"><a href="#Possible-Binding-Targets" class="headerlink" title="Possible Binding Targets"></a>Possible Binding Targets</h4><p>The <strong>target of a data-binding</strong> is something in the DOM. Depending on the binding type, the target can be a <strong>property (element, component, or directive)</strong>, an <strong>event (element, component, or directive)</strong>, or <strong>sometimes an attribute</strong> name. The following table summarizes the targets for the different binding types.</p>
<table>
<thead>
<tr>
<th align="left">Type</th>
<th align="left">Target</th>
<th align="left">Examples</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Property</td>
<td align="left">Element property Component property Directive property</td>
<td align="left"><code>src</code>, <code>hero</code>, and <code>ngClass</code> in the following:<code>&lt;img [src]=&quot;heroImageUrl&quot;&gt;</code> <code>&lt;app-hero-detail [hero]=&quot;currentHero&quot;&gt;&lt;/app-hero-detail&gt;</code> <code>&lt;div [ngClass]=&quot;{&#39;special&#39;: isSpecial}&quot;&gt;&lt;/div&gt;</code></td>
</tr>
<tr>
<td align="left">Event</td>
<td align="left">Element event Component event Directive event</td>
<td align="left"><code>click</code>, <code>deleteRequest</code>, and <code>myClick</code> in the following:<code>(click)=&quot;onSave()&quot;&gt;Save&lt;/button&gt;</code> <code>&lt;app-hero-detail (deleteRequest)=&quot;deleteHero()&quot;&gt;&lt;/app-hero-detail&gt;</code> <code>&lt;div (myClick)=&quot;clicked=$event&quot; clickable&gt;click me&lt;/div&gt;</code></td>
</tr>
<tr>
<td align="left">Two-way</td>
<td align="left">Event and property</td>
<td align="left"><code>&lt;input [(ngModel)]=&quot;name&quot;&gt;</code></td>
</tr>
<tr>
<td align="left">Attribute</td>
<td align="left">Attribute (the exception)</td>
<td align="left"><code>&lt;button [attr.aria-label]=&quot;help&quot;&gt;help&lt;/button&gt;</code></td>
</tr>
<tr>
<td align="left">Class</td>
<td align="left"><code>class</code> property</td>
<td align="left"><code>&lt;div [class.special]=&quot;isSpecial&quot;&gt;Special&lt;/div&gt;</code></td>
</tr>
<tr>
<td align="left">Style</td>
<td align="left"><code>style</code> property</td>
<td align="left"><code>&lt;button [style.color]=&quot;isSpecial ? &#39;red&#39; : &#39;green&#39;&quot;&gt;</code></td>
</tr>
</tbody></table>
<h3 id="Property-Binding"><a href="#Property-Binding" class="headerlink" title="Property Binding"></a>Property Binding</h3><p>Property binding is a one-way mechanism that lets you set the <strong>property of a view element</strong>. Property binding flows a value in one direction, <strong>from a component’s property into a target element property.</strong> Property binding uses the <code>[property]=&quot;expression&quot;</code> syntax for data binding, where the <strong>evaluation occurs in the right hand side<code>&quot;expression&quot;</code>.</strong></p>
<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> While property binding allows you to deal with Objects, you <strong>cannot use it to read or pull values out of target elements</strong>. Similarly, you <strong>cannot use property binding to call a method on the target element</strong>. If the element raises events, you can listen to them with an <a href="#Event-Binding">event binding</a>.</li>
</ul>
</blockquote>
<p>A simple example is setting the <code>disabled</code> property of a button. However, you can not only set the value of an <code>DOM</code> property, but <strong>also pass in variables into a component:</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Evaluates the buttonDisabled property of the bound component.ts --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> [<span class="attr">disabled</span>]=<span class="string">"buttonDisabled"</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Pass in variable named hero with value evaluated with selectHero into the component bound with app-hero-detail --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">app-hero-detail</span> [<span class="attr">hero</span>]=<span class="string">"selectedHero"</span> &gt;</span><span class="tag">&lt;/<span class="name">app-hero-detail</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Then to <strong>use that variable passed in</strong>, in your <code>hero-detail.component.ts</code>:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector: <span class="string">'app-hero-detail'</span>,</span><br><span class="line">  templateUrl: <span class="string">'./hero-detail.component.html'</span>,</span><br><span class="line">  styleUrls: [<span class="string">'./hero-detail.component.css'</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> HeroDetailComponent <span class="keyword">implements</span> OnInit &#123;</span><br><span class="line">  <span class="comment">// alike Spring annotation, interpret it as @Param</span></span><br><span class="line">  <span class="meta">@Input</span>() hero: Hero;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Property-Binding-Targets"><a href="#Property-Binding-Targets" class="headerlink" title="Property Binding Targets"></a>Property Binding Targets</h4><p>Targets for property binding includes:</p>
<ul>
<li>DOM properties (e.g. <code>&lt;img [src]=&quot;someURL&quot;&gt;</code>)</li>
<li>Built-in directives (e.g. <code>&lt;p [ngClass]=&quot;someCSSClass&quot;&gt;&lt;/p&gt;</code>)<ul>
<li>More on this covered in <a href="#Built-in-Directives">Built-in Directives</a></li>
</ul>
</li>
<li>Arguments directives (e.g. <code>&lt;app-my-hero [myHero]=&quot;someHero&quot;&gt;&lt;/app-my-hero&gt;</code>)<ul>
<li>To retrieve that variable <code>myHero</code>, you need to use <code>@Input() myHero: HeroType</code></li>
</ul>
</li>
</ul>
<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> If you use the arguments directives, you need to <strong>make sure that the returned type in that <code>&quot;someHero&quot;</code> matches the type you specified in <code>@Input() myHero: HeroType</code></strong></li>
</ul>
</blockquote>
<p>Once additional usage of arguments directive is to not use the <code>[]</code>, which means the expression will not be evaluated (if you not use interpolation):</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">app-string-init</span> <span class="attr">prefix</span>=<span class="string">"This is a one-time initialized string."</span>&gt;</span><span class="tag">&lt;/<span class="name">app-string-init</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>In this case, you can still access the variable <code>prefix</code>, which will have the value of whatever inside <code>&quot; &quot;</code>.</p>
<p>However, if you use:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">app-string-init</span> <span class="attr">prefix</span>=<span class="string">"&#123;&#123;some-expression&#125;&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">app-string-init</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Then you can also access the result of that expression (has to be a primitive), which goes back to the concept of Interpolation.</p>
<h4 id="Content-Security"><a href="#Content-Security" class="headerlink" title="Content Security"></a>Content Security</h4><p>Both interpolation and property binding could face security issues such as injecting <code>&lt;script&gt;</code> into the html. </p>
<p>For example:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// inside app.component.ts</span></span><br><span class="line">evilTitle = <span class="string">'Template &lt;script&gt;alert("evil never sleeps")&lt;/script&gt; Syntax'</span>;</span><br></pre></td></tr></table></figure>

<p>Then, if you <strong>used Interpolation</strong>:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>"&#123;&#123;evilTitle&#125;&#125;" is the <span class="tag">&lt;<span class="name">i</span>&gt;</span>interpolated<span class="tag">&lt;/<span class="name">i</span>&gt;</span> evil title.<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>You might be wondering if that script will actually be injected and executed.</p>
<p>Fortunately, Angular data binding is on alert for dangerous HTML. In the above case, the HTML displays as is, and the <strong>JavaScript does not execute</strong>. Angular <strong>does not</strong> allow HTML with script tags to leak into the browser, <strong>neither with interpolation nor property binding.</strong></p>
<p>This means the above snippet would be rendered as:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;Template &lt;script&gt;alert(&quot;evil never sleeps&quot;)&lt;&#x2F;script&gt; Syntax&quot; is the interpolated evil title.</span><br></pre></td></tr></table></figure>

<p>Similarly, <strong>if you used Property Binding</strong>:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment"> Angular generates a warning for the following line as it sanitizes them</span></span><br><span class="line"><span class="comment"> WARNING: sanitizing HTML stripped some content (see http://g.co/ng/security#xss).</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>"<span class="tag">&lt;<span class="name">span</span> [<span class="attr">innerHTML</span>]=<span class="string">"evilTitle"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>" is the <span class="tag">&lt;<span class="name">i</span>&gt;</span>property bound<span class="tag">&lt;/<span class="name">i</span>&gt;</span> evil title.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>The result would also be sanitized:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">"Template Syntax" is the property bound evil title.</span><br></pre></td></tr></table></figure>

<h3 id="Class-and-Style-Binding"><a href="#Class-and-Style-Binding" class="headerlink" title="Class and Style Binding"></a>Class and Style Binding</h3><ul>
<li>You can also add and remove CSS class names from an element’s <code>class</code> attribute with a <strong>class binding</strong>.</li>
</ul>
<p>For more information on class binding, you can visit this section <a href="#Class-Binding">Class Binding</a></p>
<ul>
<li>If you just want to change a specific style, you can also set styles dynamically with a <strong>style binding</strong>.</li>
</ul>
<p>To create a single style binding, <strong>start with the prefix <code>style</code> followed by a dot (<code>.</code>) and the name of the CSS style property</strong> (for example, <code>[style.width]=&quot;width&quot;</code>). The property will be set to the value of the bound expression, which is normally a string. Optionally, you can add a unit extension like <code>em</code> or <code>%</code>, which requires a number type.</p>
<p>For example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- standard style attribute setting --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"color: blue"</span>&gt;</span>Some text<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>If there are <strong>multiple styles you’d like to toggle</strong>, you can bind to the <code>[style]</code> property directly without the dot (for example, <code>[style]=&quot;styleExpr&quot;</code>). The expression attached to the <code>[style]</code> binding is most often a string list of styles like <code>&quot;width: 100px; height: 100px;&quot;</code>.</p>
<p>You can also format the <strong>expression as an object</strong> with style names as the keys and style values as the values, like <code>{width: &#39;100px&#39;, height: &#39;100px&#39;}</code>.</p>
<table>
<thead>
<tr>
<th align="left">Binding Type</th>
<th align="left">Syntax</th>
<th align="left">Input Type</th>
<th align="left">Example Input Values</th>
</tr>
</thead>
<tbody><tr>
<td align="left">Single style binding</td>
<td align="left"><code>[style.width]=&quot;width&quot;</code></td>
<td align="left">`string</td>
<td align="left">undefined</td>
</tr>
<tr>
<td align="left">Single style binding with units</td>
<td align="left"><code>[style.width.px]=&quot;width&quot;</code></td>
<td align="left">`number</td>
<td align="left">undefined</td>
</tr>
<tr>
<td align="left">Multi-style binding</td>
<td align="left"><code>[style]=&quot;styleExpr&quot;</code></td>
<td align="left"><code>string</code></td>
<td align="left"><code>&quot;width: 100px; height: 100px&quot;</code></td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left">`{[key: string]: string</td>
<td align="left">undefined</td>
</tr>
<tr>
<td align="left"></td>
<td align="left"></td>
<td align="left"><code>Array</code>&lt;<code>string</code>&gt;</td>
<td align="left">[‘width’, ‘100px’]</td>
</tr>
</tbody></table>
<h4 id="Styling-Precedence"><a href="#Styling-Precedence" class="headerlink" title="Styling Precedence"></a>Styling Precedence</h4><p>A single HTML element can have <strong>its CSS class list and style values bound to multiple sources</strong> (for example, host bindings from multiple directives).</p>
<p>When there are multiple bindings to the same class name or style property, <strong>Angular uses a set of precedence rules to resolve conflicts and determine which classes or styles are ultimately applied to the element.</strong></p>
<blockquote>
<h4 id="Styling-precedence-highest-to-lowest"><a href="#Styling-precedence-highest-to-lowest" class="headerlink" title="Styling precedence (highest to lowest)"></a>Styling precedence (highest to lowest)</h4><ol>
<li><strong>Template bindings</strong><ol>
<li>Property binding (for example, <code>&lt;div [class.foo]=&quot;hasFoo&quot;&gt;</code> or <code>&lt;div [style.color]=&quot;color&quot;&gt;</code>)</li>
<li>Map binding (for example, <code>&lt;div [class]=&quot;classExpr&quot;&gt;</code> or <code>&lt;div [style]=&quot;styleExpr&quot;&gt;</code>)</li>
<li>Static value (for example, <code>&lt;div class=&quot;foo&quot;&gt;</code> or <code>&lt;div style=&quot;color: blue&quot;&gt;</code>)</li>
</ol>
</li>
<li>Directive host bindings<ol>
<li>Property binding (for example, <code>host: {&#39;[class.foo]&#39;: &#39;hasFoo&#39;}</code> or <code>host: {&#39;[style.color]&#39;: &#39;color&#39;}</code>)</li>
<li>Map binding (for example, <code>host: {&#39;[class]&#39;: &#39;classExpr&#39;}</code> or <code>host: {&#39;[style]&#39;: &#39;styleExpr&#39;}</code>)</li>
<li>Static value (for example, <code>host: {&#39;class&#39;: &#39;foo&#39;}</code> or <code>host: {&#39;style&#39;: &#39;color: blue&#39;}</code>)</li>
</ol>
</li>
<li>Component host bindings<ol>
<li>Property binding (for example, <code>host: {&#39;[class.foo]&#39;: &#39;hasFoo&#39;}</code> or <code>host: {&#39;[style.color]&#39;: &#39;color&#39;}</code>)</li>
<li>Map binding (for example, <code>host: {&#39;[class]&#39;: &#39;classExpr&#39;}</code> or <code>host: {&#39;[style]&#39;: &#39;styleExpr&#39;}</code>)</li>
<li>Static value (for example, <code>host: {&#39;class&#39;: &#39;foo&#39;}</code> or <code>host: {&#39;style&#39;: &#39;color: blue&#39;}</code>)</li>
</ol>
</li>
</ol>
<p>Source: <a href="https://angular.io/guide/template-syntax#styling-precedence-highest-to-lowest" target="_blank" rel="noopener">https://angular.io/guide/template-syntax#styling-precedence-highest-to-lowest</a></p>
</blockquote>
<h3 id="Event-Binding"><a href="#Event-Binding" class="headerlink" title="Event Binding"></a>Event Binding</h3><p>Event binding allows you to listen for certain events such as keystrokes, mouse movements, clicks, and touches.</p>
<p>Angular event binding syntax consists of a <strong>target event</strong> name within parentheses on the left of an equal sign, and a quoted template statement on the right. The following event binding listens for the button’s click events, calling the component’s <code>onSave()</code> method whenever a click occurs:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"onSave()"</span>&gt;</span>Save<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Alternatively, use the <code>on-</code> prefix, known as the canonical form:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">on-click</span>=<span class="string">"onSave()"</span>&gt;</span>Save<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Both has the same effect.</p>
<h4 id="Event-Binding-Targets"><a href="#Event-Binding-Targets" class="headerlink" title="Event Binding Targets"></a>Event Binding Targets</h4><p>Element events may be the more common targets, but Angular looks first to see if the name matches an event property of a known directive, as it does in the following example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h4</span>&gt;</span>myClick is an event on the custom ClickDirective:<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> (<span class="attr">myClick</span>)=<span class="string">"clickMessage=$event"</span> <span class="attr">clickable</span>&gt;</span>click with myClick<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">&#123;&#123;clickMessage&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>If the name fails to match an element event or an output property of a known directive, Angular reports an “unknown directive” error.</p>
<h4 id="event-and-event-handling-statements"><a href="#event-and-event-handling-statements" class="headerlink" title="$event and event handling statements"></a><code>$event</code> and event handling statements</h4><p>In an event binding, Angular sets up an event listener and handler for the target event.</p>
<p>When the <strong>event is raised</strong>, it is caught by the listener, and then the <strong>handler executes the template statement</strong>. The template statement typically involves a receiver, which performs an action in response to the event, such as storing a value from the HTML control into a model.</p>
<p>However, how do we access information stored in that <code>event</code>? This is actually retrieved by using <code>$event</code>.</p>
<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> The target event determines the shape of the <code>$event</code> object. If the target event is a native DOM element event, then <code>$event</code> is a <a href="https://developer.mozilla.org/en-US/docs/Web/Events" target="_blank" rel="noopener">DOM event object</a>, with properties such as <code>target</code> and <code>target.value</code>.</li>
</ul>
</blockquote>
<p>For example, we can emulate the two-way-binding without <code>NgModel</code> with: </p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> [<span class="attr">value</span>]=<span class="string">"currentItem.name"</span></span></span><br><span class="line"><span class="tag">       (<span class="attr">input</span>)=<span class="string">"updateName($event.target)"</span> &gt;</span></span><br><span class="line">Two way binding without NgModel</span><br></pre></td></tr></table></figure>

<p>The above snippet does two things:</p>
<ol>
<li>First the <strong>property binding</strong> binds the <code>value</code> property in the <code>input</code> to <code>currentItem.name</code></li>
<li>Then, the <strong>event binding</strong> is used, and the argument passed in <code>$event.target</code> will contain information about this event.</li>
</ol>
<p>Then your <code>updateName()</code> method could look like:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">updateName(event: EventTarget): <span class="built_in">void</span>&#123;</span><br><span class="line">    <span class="comment">// you need to cast it to HTMLInputElement to visit the field value</span></span><br><span class="line">    <span class="keyword">const</span> evt = event <span class="keyword">as</span> HTMLInputElement;</span><br><span class="line">    <span class="keyword">this</span>.setName(evt.value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>If the event belongs to a directive—recall that components are directives—<code>$event</code> has whatever shape the directive produces.</p>
<h4 id="Creating-a-Custom-Event"><a href="#Creating-a-Custom-Event" class="headerlink" title="Creating a Custom Event"></a>Creating a Custom Event</h4><p>If, for a certain event, you cannot handle directly with a simple method call, you can use a <code>EventEmitter</code> to pass the event to other event listeners. In summary, this can be done with:</p>
<ol>
<li>Create a new <code>EventEmitter&lt;T&gt;()</code>, where <code>T</code> would be the object that you need to later on handle (optional)</li>
<li>Name that <code>EventEmitter&lt;T&gt;()</code> with a name that you will later use to listen to</li>
<li>Pass the object you want to deal with later with <code>emit(&lt;YourObject&gt;)</code>.</li>
<li>Catch the event with the name that you defined at Step 2</li>
</ol>
<p>For example, you want to delete a specific item in from your DOM, but you do not want to handle it directly there, you can:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;&#123;itemImageUrl&#125;&#125;"</span> [<span class="attr">style.display</span>]=<span class="string">"displayNone"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span> [<span class="attr">style.text-decoration</span>]=<span class="string">"lineThrough"</span>&gt;</span>&#123;&#123; item.name &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- This standard html event will be the entrypoint --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"delete()"</span>&gt;</span>Delete<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Then your method would look like:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// This component makes a request but it can't actually delete a hero.</span></span><br><span class="line"><span class="meta">@Output</span>() deleteRequest = <span class="keyword">new</span> EventEmitter&lt;Item&gt;();	<span class="comment">// the object to manipulate has type Item</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span>() &#123;</span><br><span class="line">  <span class="keyword">this</span>.deleteRequest.emit(<span class="keyword">this</span>.item);	<span class="comment">// passing in the object</span></span><br><span class="line">  <span class="keyword">this</span>.displayNone = <span class="keyword">this</span>.displayNone ? <span class="string">''</span> : <span class="string">'none'</span>;</span><br><span class="line">  <span class="keyword">this</span>.lineThrough = <span class="keyword">this</span>.lineThrough ? <span class="string">''</span> : <span class="string">'line-through'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The component defines a <code>deleteRequest</code> property that returns an <code>EventEmitter</code>. At this point, <strong>when the user clicks <em>delete</em>,</strong> the component invokes the <code>delete()</code> method, <strong>telling the <code>EventEmitter</code> to emit an <code>Item</code> object</strong> with <strong>an event called <code>deleteRequest</code></strong>.</p>
<p>This request can later be <strong>caught with another Event Binding</strong>:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">app-item-detail</span> (<span class="attr">deleteRequest</span>)=<span class="string">"deleteItem($event)"</span> [<span class="attr">item</span>]=<span class="string">"currentItem"</span>&gt;</span><span class="tag">&lt;/<span class="name">app-item-detail</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Two-way-Binding"><a href="#Two-way-Binding" class="headerlink" title="Two-way Binding"></a>Two-way Binding</h3><p>The two way binding binds a specific property by allowing a two way flow. This is achieved with <code>[()]</code> symbol. </p>
<p>In fact, as demonstrated many times before, what happens under the hood is just a <strong>Property Binding <code>[]</code>  first</strong> to initialize and bind the property from component to template, <strong>then an Event Binding <code>()</code></strong> to bind changes (<strong>by listening to the event <code>&lt;propertyChange&gt;</code></strong>) back to the property.</p>
<p>To demonstrate this, consider the example of resizing a text using two-way binding:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Inside app.component.ts, Where fontSizePx is defined to 16 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">app-sizer</span> [(<span class="attr">size</span>)]=<span class="string">"fontSizePx"</span>&gt;</span><span class="tag">&lt;/<span class="name">app-sizer</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> [<span class="attr">style.font-size.px</span>]=<span class="string">"fontSizePx"</span>&gt;</span>Resizable Text<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> The two way binding is bound to a property which does not seem to be emitting any event. in this case, <strong>Angular will listen to the event with name <code>sizeChange</code></strong>, which you have to define by yourself.</li>
</ul>
</blockquote>
<p>Inside that <code>&lt;app-sizer&gt;</code>, there are buttons to change the size of text by changing the firing event <code>sizeChange</code>:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component, Input, Output, EventEmitter &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector: <span class="string">'app-sizer'</span>,</span><br><span class="line">  templateUrl: <span class="string">'./sizer.component.html'</span>,</span><br><span class="line">  styleUrls: [<span class="string">'./sizer.component.css'</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> SizerComponent &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="meta">@Input</span>()  size: <span class="built_in">number</span> | <span class="built_in">string</span>;</span><br><span class="line">  <span class="meta">@Output</span>() sizeChange = <span class="keyword">new</span> EventEmitter&lt;<span class="built_in">number</span>&gt;();	<span class="comment">// notice this @Output</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// firing sizeChange events</span></span><br><span class="line">  dec() &#123; <span class="keyword">this</span>.resize(<span class="number">-1</span>); &#125;</span><br><span class="line">  inc() &#123; <span class="keyword">this</span>.resize(+<span class="number">1</span>); &#125;</span><br><span class="line"></span><br><span class="line">  resize(delta: <span class="built_in">number</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.size = <span class="built_in">Math</span>.min(<span class="number">40</span>, <span class="built_in">Math</span>.max(<span class="number">8</span>, +<span class="keyword">this</span>.size + delta));</span><br><span class="line">    <span class="keyword">this</span>.sizeChange.emit(<span class="keyword">this</span>.size);	<span class="comment">// event fired here, this.size will be retrieved with $event, not $event.target</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>And this would be the corresponding <code>html</code> :</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"dec()"</span> <span class="attr">title</span>=<span class="string">"smaller"</span>&gt;</span>-<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"inc()"</span> <span class="attr">title</span>=<span class="string">"bigger"</span>&gt;</span>+<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> [<span class="attr">style.font-size.px</span>]=<span class="string">"size"</span>&gt;</span>FontSize: &#123;&#123;size&#125;&#125;px<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Under the hood, this is what is happening:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">app-sizer</span> [<span class="attr">size</span>]=<span class="string">"fontSizePx"</span> (<span class="attr">sizeChange</span>)=<span class="string">"fontSizePx=$event"</span>&gt;</span><span class="tag">&lt;/<span class="name">app-sizer</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>This means that, by default, if you <strong>two-way bounded: <code>[(property)]=&quot;someValue&quot;</code></strong>, it is <strong>translated to <code>[property]=&quot;someValue&quot; (propertyChange)=&quot;someValue=$event&quot;</code></strong>.</p>
<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> This means that the <strong>object you emit must correspond to the type of the variable you defined</strong> in the property binding (<code>fontSizePx</code>). </li>
</ul>
</blockquote>
<p>However, if you want to use two-way binding in forms, it will be difficult as it is <strong>hard to define an entry point to trigger an event to be fired</strong>, since there are no built-in html event for detecting changes in an <code>input</code>, for example.</p>
<p>In this case, <strong>Angular provides solutions with its built-in directive <code>ngForm</code></strong>, which you will see later in the section below.</p>
<h3 id="Built-in-Directives"><a href="#Built-in-Directives" class="headerlink" title="Built-in Directives"></a>Built-in Directives</h3><p>As mentioned before, Angular offers two kinds of built-in directives: attribute directives (modifies DOM properties) and structural directives (modifies DOM structure). The below sections will cover some of the most common built-in directives of both kinds.</p>
<h4 id="Attribute-Directives-1"><a href="#Attribute-Directives-1" class="headerlink" title="Attribute Directives"></a>Attribute Directives</h4><p>The most common attribute directives include:</p>
<ul>
<li><code>NgClass</code><ul>
<li>adds and removes a set of CSS classes.</li>
</ul>
</li>
<li><code>NgStyle</code><ul>
<li>adds and removes a set of HTML styles.</li>
</ul>
</li>
<li><code>NgModel</code><ul>
<li>adds <strong>two-way data binding to an HTML form element</strong>.</li>
</ul>
</li>
</ul>
<h5 id="NgClass"><a href="#NgClass" class="headerlink" title="NgClass"></a><code>NgClass</code></h5><p>This is essentially the <a href="#Class-Binding">Class Binding</a> that we have talked about before. The aim of having a <code>NgClass</code> directive is to <strong>simplify the code for setting and changing the CSS classes</strong> of a DOM object.</p>
<p><strong>Without <code>NgClass</code></strong> directive, to change a specific class you would need to write:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- toggle the "special" class on/off with a property --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> [<span class="attr">class.someClass</span>]=<span class="string">"isSpecial ? 'special' : ''"</span>&gt;</span>This div is special<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>And this could be painful if you are adding multiple CSS properties.</p>
<p>To simplify the code, you could <strong>use <code>NgClass</code></strong> and place all your logic in your <code>typescript</code>:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Notice it is ngClass not NgClass when used in html --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> [<span class="attr">ngClass</span>]=<span class="string">"currentClasses"</span>&gt;</span>This div is initially saveable, unchanged, and special.<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>And the corresponding <code>ts</code> file:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">currentClasses: &#123;&#125;;</span><br><span class="line">setCurrentClasses() &#123;</span><br><span class="line">  <span class="comment">// CSS classes: added/removed per current state of component properties</span></span><br><span class="line">  <span class="keyword">this</span>.currentClasses =  &#123;</span><br><span class="line">    <span class="string">'saveable'</span>: <span class="keyword">this</span>.canSave,</span><br><span class="line">    <span class="string">'modified'</span>: !<span class="keyword">this</span>.isUnchanged,</span><br><span class="line">    <span class="string">'special'</span>:  <span class="keyword">this</span>.isSpecial</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> Though the directive is called <code>NgClass</code>, the <strong>actual directive used within the DOM property starts with a lower case <code>n</code> (<code>ngClass</code>).</strong></li>
</ul>
</blockquote>
<h5 id="NgStyle"><a href="#NgStyle" class="headerlink" title="NgStyle"></a><code>NgStyle</code></h5><p>Similar to <code>NgClass</code>, this <code>NgStyle</code> directive is used for a similar purpose of <strong>simplifying the process of editing multiple CSS styles</strong>.</p>
<p><strong>Without <code>NgStyle</code></strong> directive, you could have:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> [<span class="attr">style.font-size</span>]=<span class="string">"isSpecial ? 'x-large' : 'smaller'"</span>&gt;</span></span><br><span class="line">  This div is x-large or smaller.</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>With <code>NgStyle</code></strong>, you would have:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> [<span class="attr">ngStyle</span>]=<span class="string">"currentStyles"</span>&gt;</span></span><br><span class="line">  This div is initially italic, normal weight, and extra large (24px).</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>and this would be the corresponding <code>ts</code> file:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">currentStyles: &#123;&#125;;</span><br><span class="line">setCurrentStyles() &#123;</span><br><span class="line">  <span class="comment">// CSS styles: set per current state of component properties</span></span><br><span class="line">  <span class="keyword">this</span>.currentStyles = &#123;</span><br><span class="line">    <span class="string">'font-style'</span>:  <span class="keyword">this</span>.canSave      ? <span class="string">'italic'</span> : <span class="string">'normal'</span>,</span><br><span class="line">    <span class="string">'font-weight'</span>: !<span class="keyword">this</span>.isUnchanged ? <span class="string">'bold'</span>   : <span class="string">'normal'</span>,</span><br><span class="line">    <span class="string">'font-size'</span>:   <span class="keyword">this</span>.isSpecial    ? <span class="string">'24px'</span>   : <span class="string">'12px'</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="NgModel"><a href="#NgModel" class="headerlink" title="NgModel"></a><code>NgModel</code></h5><p>This is a directive mainly used to solve the two-way binding problem for form elements in html, for example <code>&lt;input&gt;</code>. </p>
<p><strong>Before you use <code>NgModel</code>, you need to import the <code>FormsModule</code></strong> into the respective <code>ts</code> class for it to be visible:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; FormsModule &#125; <span class="keyword">from</span> <span class="string">'@angular/forms'</span>; <span class="comment">// &lt;--- JavaScript import from Angular</span></span><br><span class="line"><span class="comment">/* . . . */</span></span><br><span class="line"><span class="meta">@NgModule</span>(&#123;</span><br><span class="line"><span class="comment">/* . . . */</span></span><br><span class="line"></span><br><span class="line">  imports: [</span><br><span class="line">    BrowserModule,</span><br><span class="line">    FormsModule <span class="comment">// &lt;--- import into the NgModule</span></span><br><span class="line">  ],</span><br><span class="line"><span class="comment">/* . . . */</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppModule &#123; &#125;</span><br></pre></td></tr></table></figure>

<p>Then, you can use the two-way binding for <code>&lt;input&gt;</code> like this:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> [(<span class="attr">ngModel</span>)]=<span class="string">"currentItem.name"</span> <span class="attr">id</span>=<span class="string">"example-ngModel"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>What happens under the hood is:</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span>&gt;</span>(ngModelChange)="...name=$event":<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- This ngModelChange is built-in by Angular that is fired whenever there is an input --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- You can imagine (input)="methodEmitsValueToNgModelChange()") --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> [<span class="attr">ngModel</span>]=<span class="string">"currentItem.name"</span> (<span class="attr">ngModelChange</span>)=<span class="string">"currentItem.name=$event"</span> <span class="attr">id</span>=<span class="string">"example-change"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>For <code>&lt;input&gt;</code>, is can actually be achieved manually with:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span>&gt;</span>without NgModel:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- the event input can actually be used as an entry point for firing events, which it also does --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> [<span class="attr">value</span>]=<span class="string">"currentItem.name"</span> (<span class="attr">input</span>)=<span class="string">"currentItem.name=$event.target.value"</span> <span class="attr">id</span>=<span class="string">"without"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>If you use <code>(ngModelChange)</code></strong>, you could not only set a property, but <strong>also call methods</strong>. For example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> [<span class="attr">ngModel</span>]=<span class="string">"currentItem.name"</span> (<span class="attr">ngModelChange</span>)=<span class="string">"setUppercaseName($event)"</span> <span class="attr">id</span>=<span class="string">"example-uppercase"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>and this would be the corresponding method:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// notice that $event would basically be the same as $event.target.value, which is converted already by NgModel </span></span><br><span class="line">setUppercaseName(name: <span class="built_in">string</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.currentItem.name = name.toUpperCase();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h6 id="NgModel-and-Value-Accessors"><a href="#NgModel-and-Value-Accessors" class="headerlink" title="NgModel and Value Accessors"></a><code>NgModel</code> and Value Accessors</h6><p>The details are specific to each kind of element and therefore the <strong><code>NgModel</code> directive only works for an element supported by a <a href="https://angular.io/api/forms/ControlValueAccessor" target="_blank" rel="noopener">ControlValueAccessor</a> that adapts an element to this protocol</strong>. Angular provides <em>value accessors</em> for all of the basic HTML form elements and the <a href="https://angular.io/guide/forms" target="_blank" rel="noopener">Forms</a> guide shows how to bind to them.</p>
<h4 id="Structural-Directives-1"><a href="#Structural-Directives-1" class="headerlink" title="Structural Directives"></a>Structural Directives</h4><p>Structural directives are <strong>responsible for HTML layout</strong>. They shape or reshape the DOM’s structure, typically by adding, removing, and manipulating the host elements to which they are attached.</p>
<p>This section is an introduction to the common built-in structural directives:</p>
<ul>
<li><code>NgIf</code><ul>
<li>conditionally creates or destroys sub-views from the template.</li>
</ul>
</li>
<li><code>NgFor</code><ul>
<li>repeat a node for each item in a list.</li>
</ul>
</li>
<li><code>NgSwitch</code><ul>
<li>a set of directives that switch among alternative views.</li>
</ul>
</li>
</ul>
<blockquote>
<p>The deep details of structural directives are covered in the <a href="https://angular.io/guide/structural-directives" target="_blank" rel="noopener">Structural Directives</a> guide, which explains the following:</p>
<ul>
<li>Why you <strong><a href="https://angular.io/guide/structural-directives#the-asterisk--prefix" target="_blank" rel="noopener">prefix the directive name with an asterisk (*)</a></strong>.</li>
<li>Using <a href="https://angular.io/guide/structural-directives#ngcontainer" target="_blank" rel="noopener">``</a> to group elements when there is no suitable host element for the directive.</li>
<li>How to write your own structural directive.</li>
<li>That you can <strong>only apply <a href="https://angular.io/guide/structural-directives#one-per-element" target="_blank" rel="noopener">one structural directive</a> to an element</strong>.</li>
</ul>
</blockquote>
<h5 id="NgIf"><a href="#NgIf" class="headerlink" title="NgIf"></a><code>NgIf</code></h5><p>You can add or remove an element from the DOM by <strong>applying an <code>NgIf</code> directive to a host element</strong>.</p>
<p>For example, to add/remove an element based on the field <code>isActive</code> would look like:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Careful that for structural directives, you need to add the * in front --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">app-item-detail</span> *<span class="attr">ngIf</span>=<span class="string">"isActive"</span> [<span class="attr">item</span>]=<span class="string">"item"</span>&gt;</span><span class="tag">&lt;/<span class="name">app-item-detail</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>When the <code>isActive</code> expression returns a true value, <code>NgIf</code> adds the <code>ItemDetailComponent</code>false<code>NgIf</code> removes the <code>ItemDetailComponent</code> from the DOM, <strong>destroying/removing that component and all of its sub-components</strong>.</p>
<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> <strong>Showing/hiding an element is different from adding/removing an element.</strong> It is perhaps already apparent, that removing an element would incur faster performance hence user experience than leaving the element inside the DOM but just hiding it. However, removing/adding does cause structural change, so that effect has to be controlled as well.</li>
</ul>
</blockquote>
<h6 id="NgIf-and-Null-Undefined"><a href="#NgIf-and-Null-Undefined" class="headerlink" title="NgIf and Null/Undefined"></a><code>NgIf</code> and Null/Undefined</h6><p>Another advantage of <code>ngIf</code> is that you can use it to <strong>guard against null</strong>. Show/hide is best suited for very simple use cases, however if an expression evaluated to null, <strong>Angular will throw an error</strong> if a nested expression tries to access a property of <code>null</code>.</p>
<p>The problem can be solved natively by using <code>NgIf</code>, which <strong>basically treats <code>Null</code>/<code>Undefined</code> to false</strong>.</p>
<p>For example, the following shows <code>NgIf</code> guarding a <code>Null</code> value (from <code>currentCustomer</code>) in a <code>div</code>. The <code>currentCustomer</code> name (or actually the entire <code>div</code>) appears only when there is a <code>currentCustomer</code> (when not null):</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngIf</span>=<span class="string">"currentCustomer"</span>&gt;</span>Hello, &#123;&#123;currentCustomer.name&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="NgFor"><a href="#NgFor" class="headerlink" title="NgFor"></a><code>NgFor</code></h5><p><code>NgFor</code> is a repeater directive—a way to present a list of items. You define a <strong>block of HTML that defines how a single item should be displayed and then you tell Angular to use that block as a template</strong> for rendering each item in the list.</p>
<p>A simple example would be:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngFor</span>=<span class="string">"let item of items"</span>&gt;</span>&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>And the above would create a number of <code>div</code>s with the name of the <code>item</code> stored in <code>items</code>.</p>
<h6 id="NgFor-and-index"><a href="#NgFor-and-index" class="headerlink" title="NgFor and index"></a><code>NgFor</code> and <code>index</code></h6><p>If you need the index of the for loop, you could also get it from the variable <code>index</code>, which stores the index of the current item (0-based).</p>
<p>For example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngFor</span>=<span class="string">"let item of items; let i=index"</span>&gt;</span>&#123;&#123;i + 1&#125;&#125; - &#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h6 id="NgFor-and-trackby"><a href="#NgFor-and-trackby" class="headerlink" title="NgFor and trackby"></a><code>NgFor</code> and <code>trackby</code></h6><p>One potential problem with <code>NgFor</code> is mutation: if an entry in the large list (<code>items</code>, for example) changed, then you might need to make a re-query the database. This would be costly if the update is minimal yet the list is large.</p>
<p>The solution is to use <code>trackBy</code>, which <strong>uses a custom method that returns a certain <code>id</code> to tell Angular which item to re-render and which ones not to</strong>.</p>
<p>For example, your custom <code>trackBy()</code> method could look like this:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">trackByItems(index: <span class="built_in">number</span>, item: Item): <span class="built_in">number</span> &#123; </span><br><span class="line">    <span class="keyword">return</span> item.id; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then your html would look like:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngFor</span>=<span class="string">"let item of items; trackBy: trackByItems"</span>&gt;</span></span><br><span class="line">  (&#123;&#123;item.id&#125;&#125;) &#123;&#123;item.name&#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>For more details with using <code>trackBy</code>, please visit <a href="https://angular.io/guide/template-syntax#ngfor-with-trackby" target="_blank" rel="noopener">https://angular.io/guide/template-syntax#ngfor-with-trackby</a></p>
<h4 id="NgSwitch"><a href="#NgSwitch" class="headerlink" title="NgSwitch"></a><code>NgSwitch</code></h4><p>When used, this technically refers to the <strong>combination of <code>NgSwitch</code> (attribute directive), <code>NgSwitchCase</code>, and <code>NgSwitchDefault</code></strong> (structural directives).</p>
<p>Therefore, you use:</p>
<ul>
<li><code>ngSwitch</code> as bindings to a switch value, which can be data of any type (e.g. <code>string</code>)</li>
<li><code>*ngSwitchCase</code> and *<code>ngSwitchDefault</code> are structural directives as they add/remove elements in the DOM.</li>
</ul>
<p>For example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> [<span class="attr">ngSwitch</span>]=<span class="string">"currentItem.feature"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">app-stout-item</span>    *<span class="attr">ngSwitchCase</span>=<span class="string">"'stout'"</span>    [<span class="attr">item</span>]=<span class="string">"currentItem"</span>&gt;</span><span class="tag">&lt;/<span class="name">app-stout-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">app-device-item</span>   *<span class="attr">ngSwitchCase</span>=<span class="string">"'slim'"</span>     [<span class="attr">item</span>]=<span class="string">"currentItem"</span>&gt;</span><span class="tag">&lt;/<span class="name">app-device-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">app-lost-item</span>     *<span class="attr">ngSwitchCase</span>=<span class="string">"'vintage'"</span>  [<span class="attr">item</span>]=<span class="string">"currentItem"</span>&gt;</span><span class="tag">&lt;/<span class="name">app-lost-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">app-best-item</span>     *<span class="attr">ngSwitchCase</span>=<span class="string">"'bright'"</span>   [<span class="attr">item</span>]=<span class="string">"currentItem"</span>&gt;</span><span class="tag">&lt;/<span class="name">app-best-item</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- not shown here, but *ngSwitchCase and *ngSwitchDefault works with native html elements (such as div) as well --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">app-unknown-item</span>  *<span class="attr">ngSwitchDefault</span>           [<span class="attr">item</span>]=<span class="string">"currentItem"</span>&gt;</span><span class="tag">&lt;/<span class="name">app-unknown-item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Template-Reference-Variables"><a href="#Template-Reference-Variables" class="headerlink" title="Template Reference Variables"></a>Template Reference Variables</h3><p>A <strong>template reference variable</strong> is often a reference to a DOM element within a template. It can also refer to a directive (which contains a component), an element, <a href="https://angular.io/api/core/TemplateRef" target="_blank" rel="noopener">TemplateRef</a>, or a <a href="https://developer.mozilla.org/en-US/docs/Web/Web_Components" target="_blank" rel="noopener">web component</a>.</p>
<p>Use the <strong>hash symbol (#) to declare a reference variable</strong>. The following reference variable, <code>#phone</code>, declares a <code>phone</code> variable on an <code>&lt;input&gt;</code> element.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> #<span class="attr">phone</span> <span class="attr">placeholder</span>=<span class="string">"phone number"</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p>You can refer to a template reference variable anywhere in the component’s template. <strong>The scope of those variables is the entire template</strong>:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> #<span class="attr">phone</span> <span class="attr">placeholder</span>=<span class="string">"phone number"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- lots of other elements --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- phone refers to the input element; pass its `value` to an event handler --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"callPhone(phone.value)"</span>&gt;</span>Call<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Alternatively, you can <strong>use the <code>ref-</code> prefix alternative to <code>#</code></strong>:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- This has the same effect as above --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">ref-phone</span> <span class="attr">placeholder</span>=<span class="string">"phone number"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- lots of other elements --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"callPhone(phone.value)"</span>&gt;</span>Call<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="How-a-reference-variable-gets-its-value"><a href="#How-a-reference-variable-gets-its-value" class="headerlink" title="How a reference variable gets its value"></a>How a reference variable gets its value</h4><p><strong>In most cases</strong>, Angular <strong>sets the reference variable’s value to the element</strong> on which it is declared. In the previous example, <code>phone</code> refers to the phone number <code>&lt;input&gt;</code>. The button’s click handler passes the <code>&lt;input&gt;</code> value to the component’s <code>callPhone()</code> method.</p>
<p><strong>The <code>NgForm</code> directive can change that behavior</strong> and set the value to the <code>NgForm</code> directive:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Reference to the ngForm directive --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> #<span class="attr">itemForm</span>=<span class="string">"ngForm"</span> (<span class="attr">ngSubmit</span>)=<span class="string">"onSubmit(itemForm)"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"name"</span>&gt;</span>Name </span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">ngModel</span> <span class="attr">required</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- the form.valid attribute is not available from the DOM, but from the NgForm directive --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> [<span class="attr">hidden</span>]=<span class="string">"!itemForm.form.valid"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; submitMessage &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>with <code>NgForm</code>, <code>itemForm</code> is a reference to the <a href="https://angular.io/api/forms/NgForm" target="_blank" rel="noopener">NgForm</a> directive with the ability to track the value and validity of every control in the form.</p>
<p>The native <code>&lt;form&gt;</code> element doesn’t have a <code>form</code> property, but the <code>NgForm</code> directive does, which allows disabling the submit button if the <code>itemForm.form.valid</code> is invalid and passing the entire form control tree to the parent component’s <code>onSubmit()</code> method.</p>
<h3 id="Input-and-Output"><a href="#Input-and-Output" class="headerlink" title="@Input() and @Output"></a><code>@Input()</code> and <code>@Output</code></h3><p><code>@Input()</code> and <code>@Output()</code> allow Angular to <strong>share data between the parent context and child directives or components</strong>. An <code>@Input()</code> property is writable while an <code>@Output()</code> property is observable.</p>
<p>For example, consider the following structure:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">parent-component</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">child-component</span>&gt;</span><span class="tag">&lt;/<span class="name">child-component</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent-component</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>In order for the child to communicate with the parent, you would need to use <code>@Input()</code> or <code>@Output()</code>. You can <strong>think of <code>@Input()</code> and <code>@Output()</code> like ports or doorways—<code>@Input()</code> is the doorway into the component allowing data to flow in while <code>@Output()</code> is the doorway out of the component, allowing the child component to send data out.</strong></p>
<h4 id="Using-Input"><a href="#Using-Input" class="headerlink" title="Using @Input"></a>Using <code>@Input</code></h4><p>Use the <code>@Input()</code> decorator in a child component or directive to let Angular know that a property in that component can receive its value from its parent component. It helps to remember that the data flow is from the perspective of the child component. So an <code>@Input()</code> allows data to be input <em>into</em> the child component from the parent component.</p>
<p>To illustrate the use of <code>@Input()</code>, <strong>these parts of your app will be edited</strong>:</p>
<ul>
<li>The child component class and template</li>
<li>The parent component class and template</li>
</ul>
<h5 id="Inside-the-Child"><a href="#Inside-the-Child" class="headerlink" title="Inside the Child"></a>Inside the Child</h5><p>In summary, you will need to add:</p>
<ul>
<li>Import the <code>Input</code> from, <code>@angular/core</code></li>
<li>Use <code>@Input() &lt;variableName&gt;:&lt;type&gt;</code> to that it can be accessed inside your component</li>
</ul>
<p>For example, it might look like this:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component, Input &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>; <span class="comment">// First, import Input</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> ItemDetailComponent &#123;</span><br><span class="line">  <span class="meta">@Input</span>() item: <span class="built_in">string</span>; <span class="comment">// decorate the property with @Input()</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> The <code>&lt;variableName&gt;</code> has to be the same as the variable name in the html template, which you will see below.</li>
</ul>
</blockquote>
<p>Then in order to pass in the variable, you can use the format of Property Binding <strong>in your html template</strong>:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">app-item-detail</span> [<span class="attr">item</span>]=<span class="string">"currentItem"</span>&gt;</span><span class="tag">&lt;/<span class="name">app-item-detail</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="Inside-the-Parent"><a href="#Inside-the-Parent" class="headerlink" title="Inside the Parent"></a>Inside the Parent</h5><p>In summary, here you do not need to do much:</p>
<ul>
<li>All you need to do is to make a certain variable/method available in the template</li>
</ul>
<p>Changes will only go to your html template where you will need to pass in the variable to the child component. This has been already shown above:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Inside the template of app-component-ts  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">app-item-detail</span> [<span class="attr">item</span>]=<span class="string">"currentItem"</span>&gt;</span><span class="tag">&lt;/<span class="name">app-item-detail</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>where the <code>app-item-detail</code> is the child component.</p>
<p>A diagram from the official site shows the overall structure:</p>
<p><img src="https://angular.io/generated/images/guide/inputs-outputs/input-diagram-target-source.svg" alt="Image from https://angular.io/generated/images/guide/inputs-outputs/input-diagram-target-source.svghttps://angular.io/generated/images/guide/inputs-outputs/input-diagram-target-source.svg" title="Image from https://angular.io/generated/images/guide/inputs-outputs/input-diagram-target-source.svg"></p>
<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> To <strong>watch for changes on an <code>@Input()</code> property, use <code>OnChanges</code></strong>, one of Angular’s <a href="#`lifecycle-hooks`">lifecycle hooks</a>. <code>OnChanges</code> is specifically designed to work with properties that have the <code>@Input()</code> decorator. See the <a href="https://angular.io/guide/lifecycle-hooks#onchanges" target="_blank" rel="noopener"><code>OnChanges</code></a> section of the <a href="#lifecycle-hooks">Lifecycle Hooks</a> guide for more details and examples.</li>
</ul>
</blockquote>
<h4 id="Using-Output"><a href="#Using-Output" class="headerlink" title="Using @Output"></a>Using <code>@Output</code></h4><p>Use the <code>@Output()</code> decorator in the child component or directive to allow data to flow <strong>from the child <em>out</em> to the parent</strong>.</p>
<p>Just like with <code>@Input()</code>, you can use <code>@Output()</code> on a property of the child component <strong>but its type should be <code>EventEmitter</code>.</strong> (The child component then has to raise an event so the parent knows something has changed. To raise an event, <code>@Output()</code> works hand in hand with <code>EventEmitter</code>, which is a class in <code>@angular/core</code> that you use to emit custom events.)</p>
<p>When you use <code>@Output()</code>, edit these parts of your app:</p>
<ul>
<li>The child component class and template</li>
<li>The parent component class and template</li>
</ul>
<p>The following example features an <code>&lt;input&gt;</code> where a user can enter a value and click a <code>&lt;button&gt;</code> that raises an event. <strong>The <code>EventEmitter</code> then relays the data to the parent component</strong>.</p>
<h5 id="Inside-the-Child-1"><a href="#Inside-the-Child-1" class="headerlink" title="Inside the Child"></a>Inside the Child</h5><p>In summary, you need to:</p>
<ul>
<li>Import <code>Output</code> and <code>EventEmitter</code></li>
<li>Decorate a property with <code>@Output()</code>, with type <code>EventEmitter&lt;YourType&gt;</code></li>
<li>Create a method (or anything) <strong>that can emit an event</strong></li>
</ul>
<p>For example, your <code>ts</code> would look like this:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Output, EventEmitter &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line">...</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> ItemOutputComponent &#123;</span><br><span class="line">  <span class="comment">// the name newItemEvent will be used later for capturing this event</span></span><br><span class="line">  <span class="meta">@Output</span>() newItemEvent = <span class="keyword">new</span> EventEmitter&lt;<span class="built_in">string</span>&gt;();</span><br><span class="line"></span><br><span class="line">  addNewItem(value: <span class="built_in">string</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.newItemEvent.emit(value);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then, its html page could look like:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span>&gt;</span>Add an item: <span class="tag">&lt;<span class="name">input</span> #<span class="attr">newItem</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- so technicall, @Output is basically sending out events through EventEmitter --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"addNewItem(newItem.value)"</span>&gt;</span>Add to parent's list<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h5 id="Inside-the-Parent-1"><a href="#Inside-the-Parent-1" class="headerlink" title="Inside the Parent"></a>Inside the Parent</h5><p>In this case, since what actually comes through is the <code>event</code> object, you don’t need to use <code>@Input</code>.</p>
<p>In summary, all you need to do is:</p>
<ul>
<li>Create a method (or anything) that uses <code>$event</code> which comes from the child</li>
<li>Edit your html page to get that event</li>
</ul>
<p>For example, to get that <code>newItemEvent</code>, your html would look like:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Inside your app.component.html --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Event is emitted from app-item-output, then passed into the method addItem() of the parent --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">app-item-output</span> (<span class="attr">newItemEvent</span>)=<span class="string">"addItem($event)"</span>&gt;</span><span class="tag">&lt;/<span class="name">app-item-output</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Your <code>ts</code> for the parent component could look like:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppComponent &#123;</span><br><span class="line">  items = [<span class="string">'item1'</span>, <span class="string">'item2'</span>, <span class="string">'item3'</span>, <span class="string">'item4'</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Because you emitted the value directly</span></span><br><span class="line">  addItem(newItem: <span class="built_in">string</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.items.push(newItem);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Using-Input-and-Output-Together"><a href="#Using-Input-and-Output-Together" class="headerlink" title="Using @Input and @Output Together"></a>Using <code>@Input</code> and <code>@Output</code> Together</h4><p>Combining the above two, you can basically have a child process properties from its parent and emit the changes back.</p>
<p>In summary, you need to:</p>
<ul>
<li>Input to a child component with Argument Binding</li>
<li>Use that inputted variable with the <code>@Input</code> (and do some operations with it)</li>
<li>Create a <code>EventEmitter</code> and a method that emits changed result</li>
<li>Output that <code>EventEmitter</code> with Event Binding</li>
</ul>
<p>An image should also summarize the information above:</p>
<p><img src="https://angular.io/generated/images/guide/inputs-outputs/input-output-diagram.svg" alt="Image from https://angular.io/generated/images/guide/inputs-outputs/input-output-diagram.svg" title="Image from https://angular.io/generated/images/guide/inputs-outputs/input-output-diagram.svg"></p>
<p>To combine property and event bindings using the banana-in-a-box syntax, <code>[()]</code>, see <a href="#Two-way-Binding">Two-way Binding</a>.</p>
<h4 id="Using-Inputs-and-Outputs-Metadata"><a href="#Using-Inputs-and-Outputs-Metadata" class="headerlink" title="Using Inputs and Outputs Metadata"></a>Using Inputs and Outputs Metadata</h4><p>If you have multiple properties and <code>EventEmitters</code> that you need to input/output, you can use the <code>inputs:</code> and <code>outputs:</code> metadata. For example:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tslint:disable: no-inputs-metadata-property no-outputs-metadata-property</span></span><br><span class="line">inputs: [<span class="string">'clearanceItem'</span>],</span><br><span class="line">outputs: [<span class="string">'buyEvent'</span>]</span><br><span class="line"><span class="comment">// tslint:enable: no-inputs-metadata-property no-outputs-metadata-property</span></span><br></pre></td></tr></table></figure>

<h4 id="Aliasing-Inputs-and-Outputs"><a href="#Aliasing-Inputs-and-Outputs" class="headerlink" title="Aliasing Inputs and Outputs"></a>Aliasing Inputs and Outputs</h4><p>If, due to name collisions, you want to have a different name in your <code>ts</code> than the names you inputted/outputted from/to your template, you could use aliasing.</p>
<h5 id="Aliasing-with-Input-and-Output"><a href="#Aliasing-with-Input-and-Output" class="headerlink" title="Aliasing with @Input() and @Output()"></a>Aliasing with <code>@Input()</code> and <code>@Output()</code></h5><p>An example illustrates this the fastest:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Input</span>(<span class="string">'wishListItem'</span>) input2: <span class="built_in">string</span>; <span class="comment">//  @Input(alias)</span></span><br><span class="line"><span class="meta">@Output</span>(<span class="string">'wishEvent'</span>) outputEvent2 = <span class="keyword">new</span> EventEmitter&lt;<span class="built_in">string</span>&gt;(); <span class="comment">//  @Output(alias) propertyName = ...</span></span><br></pre></td></tr></table></figure>

<h5 id="Aliasing-with-inputs-and-outputs-Metadata"><a href="#Aliasing-with-inputs-and-outputs-Metadata" class="headerlink" title="Aliasing with inputs and outputs Metadata"></a>Aliasing with <code>inputs</code> and <code>outputs</code> Metadata</h5><p>With <code>inputs</code> and <code>outputs</code> metadata, you need to use <code>:</code></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tslint:disable: no-inputs-metadata-property no-outputs-metadata-property</span></span><br><span class="line">inputs: [<span class="string">'input1: saveForLaterItem'</span>], <span class="comment">// propertyName:aliasFromTemplate</span></span><br><span class="line">outputs: [<span class="string">'outputEvent1: saveForLaterEvent'</span>]</span><br><span class="line"><span class="comment">// tslint:disable: no-inputs-metadata-property no-outputs-metadata-property</span></span><br></pre></td></tr></table></figure>

<h2 id="User-Input-Event"><a href="#User-Input-Event" class="headerlink" title="User Input/Event"></a>User Input/Event</h2><p>User actions such as clicking a link, pushing a button, and entering text raise DOM events. This section explains how to <strong>bind those events to component event handlers using the Angular event binding syntax</strong>.</p>
<h3 id="Binding-DOM-Events"><a href="#Binding-DOM-Events" class="headerlink" title="Binding DOM Events"></a>Binding DOM Events</h3><p>You can use <a href="#event-binding">Angular event bindings</a> to respond to any <a href="https://developer.mozilla.org/en-US/docs/Web/Events" target="_blank" rel="noopener">DOM event</a>. Many DOM events are triggered by user input. Binding to these events provides a way to get input from the user.</p>
<p>To bind to a DOM event, surround the DOM event name in parentheses and assign a quoted <a href="https://angular.io/guide/template-syntax#template-statements" target="_blank" rel="noopener">template statement</a> to it. All of these has been covered in the section <a href="#Event-Binding">Event Bindings</a></p>
<h3 id="Getting-Information-Stored-in-event"><a href="#Getting-Information-Stored-in-event" class="headerlink" title="Getting Information Stored in $event"></a>Getting Information Stored in <code>$event</code></h3><p>One of the most important step of interacting with user events is to get information of what the user has done.</p>
<p>In summary, <strong>all the information of a event</strong> (emitted either by a standard html event or a customized <code>EventEmitter</code>) <strong>is encapsulated in the <code>$event</code> DOM object</strong>.</p>
<p>For instance:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">template: <span class="string">`</span></span><br><span class="line"><span class="string">  &lt;input (keyup)="onKey($event)"&gt;</span></span><br><span class="line"><span class="string">  &lt;p&gt;&#123;&#123;values&#125;&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="string">`</span></span><br></pre></td></tr></table></figure>

<p>In this case, the <code>keyup</code> event is handled and passed to <code>onKey()</code> method.</p>
<p>Now, for a standard html event, the <code>event</code> object will have a <strong>heavy payload</strong>:</p>
<ul>
<li>All <a href="https://developer.mozilla.org/en-US/docs/Web/API/Event" target="_blank" rel="noopener">standard DOM event objects</a> have a <code>target</code> property, a reference to the element that raised the event.</li>
<li>And information (such as the text inputted in the example above) can be retrieved form that <code>target</code> property</li>
</ul>
<p>For instance, to get the <code>string</code> input, you need to access the <code>event.target.value</code> property:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> KeyUpComponent_v1 &#123;</span><br><span class="line">  values = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">  onKey(event: <span class="built_in">any</span>) &#123; <span class="comment">// without type info</span></span><br><span class="line">    <span class="keyword">this</span>.values += event.target.value + <span class="string">' | '</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> The properties of an <code>$event</code> object vary depending on the type of DOM event. For example, a mouse event includes different information than an input box editing event. Sometimes, in order to access a specific property, <strong>you need to typecast the event</strong> to <code>HTMLInputElement</code> to access that <code>value</code> property.</li>
</ul>
</blockquote>
<p>A better coding style of the above would be:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> KeyUpComponent_v1 &#123;</span><br><span class="line">  values = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">  onKey(event: KeyboardEvent) &#123; <span class="comment">// with type info</span></span><br><span class="line">    <span class="keyword">this</span>.values += (event.target <span class="keyword">as</span> HTMLInputElement).value + <span class="string">' | '</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="Using-Template-Variables"><a href="#Using-Template-Variables" class="headerlink" title="Using Template Variables"></a>Using Template Variables</h5><p>You can also achieve the same thing with a template variable. However, you need to be careful as Angular will only reload when an asynchronous event happened.</p>
<p>A <strong>naïve approach that does not</strong> work because Angular does not update the template is:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector: <span class="string">'app-loop-back'</span>,</span><br><span class="line">  template: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;input #box&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;&#123;&#123;box.value&#125;&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> LoopbackComponent &#123; &#125;</span><br></pre></td></tr></table></figure>

<p>To make it work, you can either emit an empty event so that Angular updates:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector: <span class="string">'app-loop-back'</span>,</span><br><span class="line">  template: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;input #box (keyup)="0"&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;&#123;&#123;box.value&#125;&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> LoopbackComponent &#123; &#125;</span><br></pre></td></tr></table></figure>

<p>Or, <strong>the better approach</strong> would be:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector: <span class="string">'app-key-up2'</span>,</span><br><span class="line">  template: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;input #box (keyup)="onKey(box.value)"&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;&#123;&#123;values&#125;&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> KeyUpComponent_v2 &#123;</span><br><span class="line">  values = <span class="string">''</span>;</span><br><span class="line">    </span><br><span class="line">  <span class="comment">// here you can also have some complex processings</span></span><br><span class="line">  onKey(value: <span class="built_in">string</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.values += value + <span class="string">' | '</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="Key-Event-Filtering"><a href="#Key-Event-Filtering" class="headerlink" title="Key Event Filtering"></a>Key Event Filtering</h5><p>The <code>(keyup)</code> event handler hears <em>every keystroke</em>. <strong>Sometimes only the <em>Enter</em> key matters</strong>, because it signals that the user has finished typing. One way to reduce the noise would be to examine every <code>$event.keyCode</code> and take action only when the key is <em>Enter</em>.</p>
<p><strong>There’s an easier way</strong>: bind to Angular’s <code>keyup.enter</code> pseudo-event. Then Angular calls the event handler only when the user presses <em>Enter</em>.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector: <span class="string">'app-key-up3'</span>,</span><br><span class="line">  template: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;input #box (keyup.enter)="onEnter(box.value)"&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;&#123;&#123;value&#125;&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> KeyUpComponent_v3 &#123;</span><br><span class="line">  value = <span class="string">''</span>;</span><br><span class="line">  onEnter(value: <span class="built_in">string</span>) &#123; <span class="keyword">this</span>.value = value; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>However, what if you also want to save the data when the <strong>user clicked away before finishing typing and pressing enter</strong>? In this case, you need to also listen to the <code>blur</code> event, which is introduced below.</p>
<h3 id="Blur"><a href="#Blur" class="headerlink" title="Blur"></a>Blur</h3><p>Another event which is quite useful for dealing with inputs is <code>blur</code>, which is the opposite of <code>focus</code>, meaning that the user has clicked away from the element.</p>
<p>Therefore, to solve the previous problem, you can add another event binding with<code>(blur)</code> to handle this:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector: <span class="string">'app-key-up4'</span>,</span><br><span class="line">  template: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;input #box</span></span><br><span class="line"><span class="string">      (keyup.enter)="update(box.value)"</span></span><br><span class="line"><span class="string">      (blur)="update(box.value)"&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &lt;p&gt;&#123;&#123;value&#125;&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> KeyUpComponent_v4 &#123;</span><br><span class="line">  value = <span class="string">''</span>;</span><br><span class="line">  update(value: <span class="built_in">string</span>) &#123; <span class="keyword">this</span>.value = value; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Pipes-1"><a href="#Pipes-1" class="headerlink" title="Pipes"></a>Pipes</h2><p>Pipes can be used to <strong>transform and format strings, currency amounts, dates, and other display data</strong>. Pipes are simple functions you can use in <a href="#template-expressions">template expressions</a> to accept an input value and return a transformed value. </p>
<p>Angular provides built-in pipes for typical data transformations, including transformations for internationalization (i18n), which use locale information to format data. The following are commonly used built-in pipes for data formatting:</p>
<ul>
<li><a href="https://angular.io/api/common/DatePipe" target="_blank" rel="noopener"><code>DatePipe</code></a>: Formats a date value <strong>according to locale rules</strong>.</li>
<li><a href="https://angular.io/api/common/UpperCasePipe" target="_blank" rel="noopener"><code>UpperCasePipe</code></a>: Transforms text to all upper case.</li>
<li><a href="https://angular.io/api/common/LowerCasePipe" target="_blank" rel="noopener"><code>LowerCasePipe</code></a>: Transforms text to all lower case.</li>
<li><a href="https://angular.io/api/common/CurrencyPipe" target="_blank" rel="noopener"><code>CurrencyPipe</code></a>: Transforms a number to a currency string, formatted <strong>according to locale rules</strong>.</li>
<li><a href="https://angular.io/api/common/DecimalPipe" target="_blank" rel="noopener"><code>DecimalPipe</code></a>: Transforms a number into a string with a decimal point, formatted <strong>according to locale rules</strong>.</li>
<li><a href="https://angular.io/api/common/PercentPipe" target="_blank" rel="noopener"><code>PercentPipe</code></a>: Transforms a number to a percentage string, formatted <strong>according to locale rules</strong>.</li>
</ul>
<blockquote>
<ul>
<li>For a complete list of built-in pipes, see the <a href="https://angular.io/api/common#pipes" target="_blank" rel="noopener">pipes API documentation</a>.</li>
<li>To learn more about using pipes for internationalization (i18n) efforts, see <a href="https://angular.io/guide/i18n#i18n-pipes" target="_blank" rel="noopener">formatting data based on locale</a>.</li>
</ul>
</blockquote>
<h3 id="Using-a-Pipe-in-a-Template"><a href="#Using-a-Pipe-in-a-Template" class="headerlink" title="Using a Pipe in a Template"></a>Using a Pipe in a Template</h3><p>To apply a pipe <strong>in a template</strong>, use the <a href="#Pipe-Operator-`|`">pipe operator (<code>|</code>)</a> within a template expression. The basic usage has been shown in the section <a href="#Pipe-Operator-`|`">pipe operator (<code>|</code>)</a>, but it is shown here again just to demonstrate its simplicity:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- where birthday = new Date(1988, 3, 15); is defined in the app.component.ts --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>The hero's birthday is &#123;&#123; birthday | date &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="Formatting-Pipe-Output"><a href="#Formatting-Pipe-Output" class="headerlink" title="Formatting Pipe Output"></a>Formatting Pipe Output</h4><p>Some pipes have optional parameters that you can use to fine-tune the pipe’s output. To specify the optional parameter, <strong>follow the pipe name</strong> (<code>currency</code>) <strong>with a colon</strong> (<code>:</code>) <strong>and the parameter value</strong> (<code>&#39;EUR&#39;</code>).</p>
<ul>
<li>For example, you can use the <a href="https://angular.io/api/common/CurrencyPipe" target="_blank" rel="noopener"><code>CurrencyPipe</code></a> with a country code such as EUR as a parameter. The template expression  {{ amount | currency:'EUR' }}  transforms the <code>amount</code> to currency in euros.</li>
</ul>
<p><strong>If the pipe accepts multiple parameters, separate the values with colons.</strong></p>
<ul>
<li>For example, {{ amount | currency:'EUR':'Euros '}} adds the second parameter, the string literal <code>&#39;Euros &#39;</code>, to the output string. You can use any valid template expression as a parameter, such as a string literal or a component property.</li>
</ul>
<blockquote>
<p>For a full list of built-in Angular pipes with their optional parameters, please visit: <a href="https://angular.io/api/common#pipes" target="_blank" rel="noopener">https://angular.io/api/common#pipes</a></p>
</blockquote>
<p>A complete example would be:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>The hero's birthday is &#123;&#123; birthday | date:"MM/dd/yy" &#125;&#125; <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Or, if you want to specify options:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">template: <span class="string">`</span></span><br><span class="line"><span class="string">  &lt;p&gt;The hero's birthday is &#123;&#123; birthday | date:format &#125;&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="string">  &lt;button (click)="toggleFormat()"&gt;Toggle Format&lt;/button&gt;</span></span><br><span class="line"><span class="string">`</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> HeroBirthday2Component &#123;</span><br><span class="line">  birthday = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">1988</span>, <span class="number">3</span>, <span class="number">15</span>); <span class="comment">// April 15, 1988 -- since month parameter is zero-based</span></span><br><span class="line">  toggle = <span class="literal">true</span>; <span class="comment">// start with true == shortDate</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">get</span> format()   &#123; <span class="keyword">return</span> <span class="keyword">this</span>.toggle ? <span class="string">'shortDate'</span> : <span class="string">'fullDate'</span>; &#125;</span><br><span class="line">  toggleFormat() &#123; <span class="keyword">this</span>.toggle = !<span class="keyword">this</span>.toggle; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>For a full list of date pipe optional parameters, please visit: <a href="https://angular.io/api/common/DatePipe" target="_blank" rel="noopener">https://angular.io/api/common/DatePipe</a></p>
</blockquote>
<h4 id="Chained-Pipes"><a href="#Chained-Pipes" class="headerlink" title="Chained Pipes"></a>Chained Pipes</h4><p>You can also chain pipes so that the <strong>output of one pipe becomes the input to the next (going from left to right).</strong></p>
<p>For example:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">  The chained hero's birthday is</span><br><span class="line">&#123;&#123; birthday | date | uppercase&#125;&#125;  </span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>In the above example, chained pipes first apply a format to a date value, then convert the formatted date to uppercase characters. </p>
<h3 id="Making-a-Custom-Pipe"><a href="#Making-a-Custom-Pipe" class="headerlink" title="Making a Custom Pipe"></a>Making a Custom Pipe</h3><p>First, we need to briefly go through how Angular finds and uses a pipe.</p>
<p>Pipes are actually just classes annotated with <code>@Pipe</code>, implementing the <code>PipeTransform</code> interface. Whenever a pipe is detected in a template, Angular will go to that annotation and execute the <code>transform</code> method defined within the class.</p>
<p>This also provides hints for us on how to create a custom pipe function.</p>
<h4 id="Creating-a-Class-as-a-Pipe"><a href="#Creating-a-Class-as-a-Pipe" class="headerlink" title="Creating a Class as a Pipe"></a>Creating a Class as a Pipe</h4><p>In summary, you need to have a class that:</p>
<ul>
<li>Implements the <code>PipeTransform</code> interface</li>
<li>Is Annotated with <code>@Pipe()</code></li>
</ul>
<p>For example:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Pipe, PipeTransform &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Raise the value exponentially</span></span><br><span class="line"><span class="comment"> * Takes an exponent argument that defaults to 1.</span></span><br><span class="line"><span class="comment"> * Usage:</span></span><br><span class="line"><span class="comment"> *   value | exponentialStrength:exponent</span></span><br><span class="line"><span class="comment"> * Example:</span></span><br><span class="line"><span class="comment"> *   &#123;&#123; 2 | exponentialStrength:10 &#125;&#125;</span></span><br><span class="line"><span class="comment"> *   formats to: 1024</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Pipe</span>(&#123;name: <span class="string">'exponentialStrength'</span>&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> ExponentialStrengthPipe <span class="keyword">implements</span> PipeTransform &#123;</span><br><span class="line">  transform(value: <span class="built_in">number</span>, exponent?: <span class="built_in">number</span>): <span class="built_in">number</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">Math</span>.pow(value, <span class="built_in">isNaN</span>(exponent) ? <span class="number">1</span> : exponent);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Detecting-changes-with-data-binding-in-pipes"><a href="#Detecting-changes-with-data-binding-in-pipes" class="headerlink" title="Detecting changes with data binding in pipes"></a>Detecting changes with data binding in pipes</h3><p>When you use pipes, you use <a href="#Data-Binding-and-DOM-Property">data binding</a> with a pipe to display values and respond to user actions. If the data is a primitive input value, such as <code>String</code> or <code>Number</code>, or an object reference as input, such as <code>Date</code> or <code>Array</code>, <strong>Angular executes the pipe whenever it detects a change for the input value or reference.</strong></p>
<p>For example, if you edited the above example to make a two-way binding:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector: <span class="string">'app-power-boost-calculator'</span>,</span><br><span class="line">  template: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;h2&gt;Power Boost Calculator&lt;/h2&gt;</span></span><br><span class="line"><span class="string">    &lt;div&gt;Normal power: &lt;input [(ngModel)]="power"&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;div&gt;Boost factor: &lt;input [(ngModel)]="factor"&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;</span></span><br><span class="line"><span class="string">      Super Hero Power: &#123;&#123;power | exponentialStrength: factor&#125;&#125;</span></span><br><span class="line"><span class="string">    &lt;/p&gt;</span></span><br><span class="line"><span class="string">  `</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> PowerBoostCalculatorComponent &#123;</span><br><span class="line">  power = <span class="number">5</span>;</span><br><span class="line">  factor = <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The <code>exponentialStrength</code> pipe executes every time the user changes the “normal power” value or the “boost factor”, as shown below.</p>
<p><img src="https://angular.io/generated/images/guide/pipes/power-boost-calculator-anim.gif" alt="GIF from https://angular.io/generated/images/guide/pipes/power-boost-calculator-anim.gif" title="GIF from https://angular.io/generated/images/guide/pipes/power-boost-calculator-anim.gif"></p>
<p>However, <strong>if you change something <em>inside</em> a composite object</strong> (such as the month of a date, an element of an array, or an object property), you need to understand <strong>how change detection</strong> works, and how to <strong>use an <code>impure</code> pipe</strong>.</p>
<h3 id="Change-Detection-Mechanism"><a href="#Change-Detection-Mechanism" class="headerlink" title="Change Detection Mechanism"></a>Change Detection Mechanism</h3><p>For elements except pipes, change detection in Angular is based on every DOM event. This means that Angular updates the page based on things such as  keystrokes, mouse clicks, server response, and etc.</p>
<p>An example demonstrating the above has been shown in the section <a href="#Using-Template-Variables">Using Template Variables</a>, and here we show another example.</p>
<p>Consider the html page that looks like this:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">New hero:</span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> #<span class="attr">box</span></span></span><br><span class="line"><span class="tag">          (<span class="attr">keyup.enter</span>)=<span class="string">"addHero(box.value); box.value=''"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">placeholder</span>=<span class="string">"hero name"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"reset()"</span>&gt;</span>Reset<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngFor</span>=<span class="string">"let hero of heroes"</span>&gt;</span></span><br><span class="line">    &#123;&#123;hero.name&#125;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>We see that the event that will get handled is <code>keyup.enter</code>, which will add the value to the <code>heroes</code> list. Now, since Angular updates its elements whenever there is an event, the <code>*ngFor</code> will update itself automatically.</p>
<p>The following would be the corresponding <code>ts</code> code:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> FlyingHeroesComponent &#123;</span><br><span class="line">  heroes: <span class="built_in">any</span>[] = [];</span><br><span class="line">  canFly = <span class="literal">true</span>;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"></span>) &#123; <span class="keyword">this</span>.reset(); &#125;</span><br><span class="line"></span><br><span class="line">  addHero(name: <span class="built_in">string</span>) &#123;</span><br><span class="line">    name = name.trim();</span><br><span class="line">    <span class="keyword">if</span> (!name) &#123; <span class="keyword">return</span>; &#125;</span><br><span class="line">    <span class="keyword">let</span> hero = &#123;name, canFly: <span class="keyword">this</span>.canFly&#125;;</span><br><span class="line">    <span class="keyword">this</span>.heroes.push(hero);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  reset() &#123; <span class="keyword">this</span>.heroes = HEROES.slice(); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Change-Detection-for-Pipes"><a href="#Change-Detection-for-Pipes" class="headerlink" title="Change Detection for Pipes"></a>Change Detection for Pipes</h4><p>In the section <a href="#Detecting-changes-with-data-binding-in-pipes">Detecting changes with data binding in pipes</a>, you have seen that Angular seems to update/re-run pipes as well when variables/anything you had in the data binding have changed. However, this is not true for all the cases.</p>
<p>For detecting changes with pipes, Angular uses the approach by detecting whether if <strong>the variable’s reference has changed</strong>. This means for primitives types, this would work nicely, but <strong>for complex objects, changing one of its many property fields will not change the object’s reference</strong>, hence Angular will not update/re-run the pipe.</p>
<p>For example, if you changed the previous example to:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">New hero:</span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> #<span class="attr">box</span></span></span><br><span class="line"><span class="tag">          (<span class="attr">keyup.enter</span>)=<span class="string">"addHero(box.value); box.value=''"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">placeholder</span>=<span class="string">"hero name"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"reset()"</span>&gt;</span>Reset<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngFor</span>=<span class="string">"let hero of (heroes | flyingHeroes)"</span>&gt;</span></span><br><span class="line">  &#123;&#123;hero.name&#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>With its corresponding <code>pipe</code> class:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Pipe, PipeTransform &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; Flyer &#125; <span class="keyword">from</span> <span class="string">'./heroes'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Pipe</span>(&#123; name: <span class="string">'flyingHeroes'</span> &#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> FlyingHeroesPipe <span class="keyword">implements</span> PipeTransform &#123;</span><br><span class="line">  transform(allHeroes: Flyer[]) &#123;</span><br><span class="line">    <span class="keyword">return</span> allHeroes.filter(<span class="function"><span class="params">hero</span> =&gt;</span> hero.canFly);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>You will see that things don’t work since <code>(heroes | flyingHeroes)</code> will not get re-run and the same heroes gets <code>ngFor</code>ed. This is because the <code>addHero()</code> method we have seen pushes new <code>hero</code> to the <code>heroes</code> list, which <strong>does not change the <code>heroes</code> list’s reference.</strong>  </p>
<p>To solve the issue, you can either:</p>
<ul>
<li>Change your <code>addHero()</code> method to create a new array and replace <code>heroes</code> to that new array<ul>
<li>Since this changed the reference, <code>(heroes | flyingHeroes)</code> will get re-run and new data will be seen</li>
</ul>
</li>
<li>Use an <code>impure</code> pipe</li>
</ul>
<h3 id="impure-Pipe"><a href="#impure-Pipe" class="headerlink" title="impure Pipe"></a><code>impure</code> Pipe</h3><p><code>pure</code> changes means changes that causes changes to the variable’s references, which is basically what’s mentioned above.</p>
<p><code>impure</code> changes would be changes that are within a composite object.</p>
<p>Therefore, in order to solve the problem mentioned above, we need to create an <code>impure</code> pipe that deals with <code>impure</code> changes.</p>
<p>In summary, you need to:</p>
<ul>
<li>Create a pipe class as usual, with its <code>@Pipe()</code> annotation and implementing the <code>PipeTransform</code> interface</li>
<li>Add the property <code>pure: false</code> in the <code>@Pipe()</code> annotation</li>
</ul>
<p>For example:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Pipe</span>(&#123;</span><br><span class="line">  name: <span class="string">'flyingHeroesImpure'</span>,</span><br><span class="line">  pure: <span class="literal">false</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>And a complete example would look like:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* tslint:disable use-pipe-transform-interface */</span></span><br><span class="line"><span class="keyword">import</span> &#123; Pipe, PipeTransform &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; Flyer &#125; <span class="keyword">from</span> <span class="string">'./heroes'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Pipe</span>(&#123; name: <span class="string">'flyingHeroes'</span> &#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> FlyingHeroesPipe <span class="keyword">implements</span> PipeTransform &#123;</span><br><span class="line">  transform(allHeroes: Flyer[]) &#123;</span><br><span class="line">    <span class="keyword">return</span> allHeroes.filter(<span class="function"><span class="params">hero</span> =&gt;</span> hero.canFly);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/////// Identical except for the pure flag</span></span><br><span class="line"><span class="meta">@Pipe</span>(&#123;</span><br><span class="line">  name: <span class="string">'flyingHeroesImpure'</span>,</span><br><span class="line">  pure: <span class="literal">false</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> FlyingHeroesImpurePipe <span class="keyword">extends</span> FlyingHeroesPipe &#123;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Copyright Google LLC. All Rights Reserved.</span></span><br><span class="line"><span class="comment">Use of this source code is governed by an MIT-style license that</span></span><br><span class="line"><span class="comment">can be found in the LICENSE file at http://angular.io/license</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>

<p>Lastly, don’t forget to change your html to use the <code>impure</code> pipe:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngFor</span>=<span class="string">"let hero of (heroes | flyingHeroesImpure)"</span>&gt;</span></span><br><span class="line">  &#123;&#123;hero.name&#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="async-Pipe"><a href="#async-Pipe" class="headerlink" title="async Pipe"></a><code>async</code> Pipe</h3><p>The <code>async</code> pipe is an <code>impure</code> pipe, which is used commonly for handling event handling, asynchronous programming, and handling multiple values.</p>
<p>The built-in <a href="https://angular.io/api/common/AsyncPipe" target="_blank" rel="noopener"><code>AsyncPipe</code></a> to <strong>accept an <code>observable</code> as input and <code>subscribe</code> to the input automatically</strong>. Without this pipe, your component code would have to subscribe to the observable to consume its values, extract the resolved values, expose them for binding, and unsubscribe when the observable is destroyed in order to prevent memory leaks. <code>AsyncPipe</code> is an impure pipe that saves boilerplate code in your component to maintain the subscription and keep delivering values from that observable as they arrive.</p>
<blockquote>
<p>Observables provide support for passing messages asynchronously between parts of your application (also between another server and your application, which we will discuss in <a href="#Accessing-Servers-Over-HTTP">Accessing Servers Over HTTP</a>)</p>
<p>For details and examples of observables, see the <a href="https://angular.io/guide/observables#using-observables-to-pass-values" target="_blank" rel="noopener">Observables Overview</a>.</p>
</blockquote>
<p>The following code example binds an observable of message strings (<code>message$</code>) to a view with the <code>async</code> pipe:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; Observable, interval &#125; <span class="keyword">from</span> <span class="string">'rxjs'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; map, take &#125; <span class="keyword">from</span> <span class="string">'rxjs/operators'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector: <span class="string">'app-hero-message'</span>,</span><br><span class="line">  template: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;h2&gt;Async Hero Message and AsyncPipe&lt;/h2&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;Message: &#123;&#123; message$ | async &#125;&#125;&lt;/p&gt;</span></span><br><span class="line"><span class="string">    &lt;button (click)="resend()"&gt;Resend&lt;/button&gt;`</span>,</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> HeroAsyncMessageComponent &#123;</span><br><span class="line">  message$: Observable&lt;<span class="built_in">string</span>&gt;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">private</span> messages = [</span><br><span class="line">    <span class="string">'You are my hero!'</span>,</span><br><span class="line">    <span class="string">'You are the best hero!'</span>,</span><br><span class="line">    <span class="string">'Will you be my hero?'</span></span><br><span class="line">  ];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"></span>) &#123; <span class="keyword">this</span>.resend(); &#125;</span><br><span class="line"></span><br><span class="line">  resend() &#123;</span><br><span class="line">    <span class="keyword">this</span>.message$ = interval(<span class="number">500</span>).pipe(</span><br><span class="line">      map(<span class="function"><span class="params">i</span> =&gt;</span> <span class="keyword">this</span>.messages[i]),</span><br><span class="line">      take(<span class="keyword">this</span>.messages.length)</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Caching-HTTP-Request"><a href="#Caching-HTTP-Request" class="headerlink" title="Caching HTTP Request"></a>Caching HTTP Request</h4><p>Another example of using <code>observables</code> is the <code>HTTPClient</code> service, which uses observables and offers the <code>HTTPClient.get()</code> method to fetch data from a server. The <strong>asynchronous method <code>get()</code> sends an HTTP request, and returns an observable that emits the requested data for the response</strong>.</p>
<p>The following code from Angular mimics an async data sending and processes it with <code>async</code> pipe:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; HttpClient &#125;          <span class="keyword">from</span> <span class="string">'@angular/common/http'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Pipe, PipeTransform &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Pipe</span>(&#123;</span><br><span class="line">  name: <span class="string">'fetch'</span>,</span><br><span class="line">  pure: <span class="literal">false</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> FetchJsonPipe <span class="keyword">implements</span> PipeTransform &#123;</span><br><span class="line">  <span class="keyword">private</span> cachedData: <span class="built_in">any</span> = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">private</span> cachedUrl = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> http: HttpClient</span>) &#123; &#125;</span><br><span class="line"></span><br><span class="line">  transform(url: <span class="built_in">string</span>): <span class="built_in">any</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (url !== <span class="keyword">this</span>.cachedUrl) &#123;</span><br><span class="line">      <span class="keyword">this</span>.cachedData = <span class="literal">null</span>;</span><br><span class="line">      <span class="keyword">this</span>.cachedUrl = url;</span><br><span class="line">      <span class="keyword">this</span>.http.get(url).subscribe(<span class="function"><span class="params">result</span> =&gt;</span> <span class="keyword">this</span>.cachedData = result);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.cachedData;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The corresponding parent component is:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector: <span class="string">'app-hero-list'</span>,</span><br><span class="line">  template: <span class="string">`</span></span><br><span class="line"><span class="string">    &lt;h2&gt;Heroes from JSON File&lt;/h2&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &lt;div *ngFor="let hero of ('assets/heroes.json' | fetch) "&gt;</span></span><br><span class="line"><span class="string">      &#123;&#123;hero.name&#125;&#125;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &lt;p&gt;Heroes as JSON:</span></span><br><span class="line"><span class="string">      &#123;&#123;'assets/heroes.json' | fetch | json&#125;&#125;</span></span><br><span class="line"><span class="string">    &lt;/p&gt;`</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> HeroListComponent &#123; &#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>The built-in <a href="https://angular.io/api/common/JsonPipe" target="_blank" rel="noopener">JsonPipe</a> provides a way to diagnose a mysteriously failing data binding or to inspect an object for future binding.</p>
</blockquote>
<h2 id="Lifecycle-Hooks"><a href="#Lifecycle-Hooks" class="headerlink" title="Lifecycle Hooks"></a>Lifecycle Hooks</h2><p>A <strong>component instance has a lifecycle that starts when Angular instantiates the component class and renders the component view</strong> along with its child views. The lifecycle <strong>continues with change detection</strong>, as Angular checks to see when data-bound properties change, and updates both the view and the component instance as needed. The lifecycle <strong>ends when Angular destroys the component instance and removes its rendered template</strong> from the DOM. </p>
<p>Directives have a similar lifecycle, as Angular creates, updates, and destroys instances in the course of execution.</p>
<p>Your application can use <a href="https://angular.io/guide/glossary#lifecycle-hook" target="_blank" rel="noopener">lifecycle hook methods</a> to <strong>tap into key events in the lifecycle of a component or directive in order to initialize new instances, initiate change detection when needed, respond to updates during change detection, and clean up before deletion of instances.</strong> This can be achieved <strong>by implementing one or more of the <em>lifecycle hook</em> interfaces in the Angular <code>core</code> library</strong>.</p>
<p>For example, to tap into the hook method named <code>ngOnInit()</code> (so that <strong>Angular calls it shortly after checking the input properties for that component or directive for the first time</strong>):</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Directive</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> PeekABooDirective <span class="keyword">implements</span> OnInit &#123;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> logger: LoggerService</span>) &#123; &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// implement OnInit's `ngOnInit` method</span></span><br><span class="line">  ngOnInit() &#123; <span class="keyword">this</span>.logIt(<span class="string">`OnInit`</span>); &#125;</span><br><span class="line"></span><br><span class="line">  logIt(msg: <span class="built_in">string</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.logger.log(<span class="string">`#<span class="subst">$&#123;nextId++&#125;</span> <span class="subst">$&#123;msg&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> <strong>Each interface defines the prototype for a single hook method</strong>, whose name is the <strong>interface name prefixed with <code>ng</code></strong>. For example, the <code>OnInit</code> interface has a hook method named <code>ngOnInit()</code>, as shown above.</li>
</ul>
</blockquote>
<h3 id="Lifecycle-Event-Sequence"><a href="#Lifecycle-Event-Sequence" class="headerlink" title="Lifecycle Event Sequence"></a>Lifecycle Event Sequence</h3><p>After your application instantiates a component or directive by calling its constructor, Angular calls the hook methods you have implemented at the appropriate point in the lifecycle of that instance.</p>
<p>Angular executes hook methods in the following sequence. You can use them to perform the following kinds of operations:</p>
<table>
<thead>
<tr>
<th align="left">Hook method</th>
<th align="left">Purpose</th>
<th align="left">Timing</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><code>ngOnChanges()</code></td>
<td align="left">Respond when Angular sets or resets data-bound input properties. The method receives a <code>SimpleChanges</code> object of current and previous property values. Note that this happens very frequently, so any operation you perform here impacts performance significantly. See details in <a href="https://angular.io/guide/lifecycle-hooks#onchanges" target="_blank" rel="noopener">Using change detection hooks</a> in this document.</td>
<td align="left">Called before <code>ngOnInit()</code> and whenever one or more data-bound input properties change.</td>
</tr>
<tr>
<td align="left"><code>ngOnInit()</code></td>
<td align="left">Initialize the directive or component <strong>after Angular first displays the data-bound properties</strong> and sets the directive or component’s input properties. See details in <a href="https://angular.io/guide/lifecycle-hooks#oninit" target="_blank" rel="noopener">Initializing a component or directive</a> in this document.</td>
<td align="left">Called once, after the first <code>ngOnChanges()</code>.</td>
</tr>
<tr>
<td align="left"><code>ngDoCheck()</code></td>
<td align="left">Detect and act upon changes that Angular can’t or won’t detect on its own. See details and example in <a href="https://angular.io/guide/lifecycle-hooks#docheck" target="_blank" rel="noopener">Defining custom change detection</a> in this document.</td>
<td align="left">Called immediately after <code>ngOnChanges()</code> on every change detection run, and immediately after <code>ngOnInit()</code> on the first run.</td>
</tr>
<tr>
<td align="left"><code>ngAfterContentInit()</code></td>
<td align="left">Respond after Angular projects external content into the component’s view, or into the view that a directive is in.See details and example in <a href="https://angular.io/guide/lifecycle-hooks#aftercontent" target="_blank" rel="noopener">Responding to changes in content</a> in this document.</td>
<td align="left">Called <em>once</em> after the first <code>ngDoCheck()</code>.</td>
</tr>
<tr>
<td align="left"><code>ngAfterContentChecked()</code></td>
<td align="left">Respond after Angular checks the content projected into the directive or component.See details and example in <a href="https://angular.io/guide/lifecycle-hooks#aftercontent" target="_blank" rel="noopener">Responding to projected content changes</a> in this document.</td>
<td align="left">Called after <code>ngAfterContentInit()</code> and every subsequent <code>ngDoCheck()</code>.</td>
</tr>
<tr>
<td align="left"><code>ngAfterViewInit()</code></td>
<td align="left">Respond after Angular initializes the component’s views and child views, or the view that contains the directive.See details and example in <a href="https://angular.io/guide/lifecycle-hooks#afterview" target="_blank" rel="noopener">Responding to view changes</a> in this document.</td>
<td align="left">Called <em>once</em> after the first <code>ngAfterContentChecked()</code>.</td>
</tr>
<tr>
<td align="left"><code>ngAfterViewChecked()</code></td>
<td align="left">Respond after Angular checks the component’s views and child views, or the view that contains the directive.</td>
<td align="left">Called after the <code>ngAfterViewInit()</code> and every subsequent <code>ngAfterContentChecked()</code>.</td>
</tr>
<tr>
<td align="left"><code>ngOnDestroy()</code></td>
<td align="left">Cleanup <strong>just before Angular destroys the directive or component</strong>. <strong>Unsubscribe Observables and detach event handlers to avoid memory leaks</strong>. See details in <a href="https://angular.io/guide/lifecycle-hooks#ondestroy" target="_blank" rel="noopener">Cleaning up on instance destruction</a> in this document.</td>
<td align="left">Called immediately before Angular destroys the directive or component.</td>
</tr>
</tbody></table>
<p>(Table source: <a href="https://angular.io/guide/lifecycle-hooks#lifecycle-event-sequence" target="_blank" rel="noopener">https://angular.io/guide/lifecycle-hooks#lifecycle-event-sequence</a>)</p>
<h3 id="Using-ngOnInit"><a href="#Using-ngOnInit" class="headerlink" title="Using ngOnInit"></a>Using <code>ngOnInit</code></h3><p>Use the <code>ngOnInit()</code> method to <strong>perform the following initialization tasks</strong>.</p>
<ul>
<li><p>Perform complex initializations outside of the constructor. Components should be cheap and safe to construct. You should not, for example, fetch data in a component constructor. You shouldn’t worry that a new component will try to contact a remote server when created under test or before you decide to display it.</p>
<p>An <code>ngOnInit()</code> is a good place for a component to fetch its initial data. For an example, see the <a href="https://angular.io/tutorial/toh-pt4#oninit" target="_blank" rel="noopener">Tour of Heroes tutorial</a>.</p>
<blockquote>
<p> In <a href="http://misko.hevery.com/code-reviewers-guide/flaw-constructor-does-real-work/" target="_blank" rel="noopener">Flaw: Constructor does Real Work</a>, Misko Hevery, Angular team lead, explains why you should avoid complex constructor logic.</p>
</blockquote>
</li>
<li><p>Set up the component after Angular sets the input properties. <strong>Constructors should do no more than set the initial local variables to simple values</strong>.</p>
<p>Keep in mind that a directive’s data-bound input properties are not set until <em>after construction</em>. If you need to initialize the directive based on those properties, set them when <code>ngOnInit()</code> runs.</p>
<p>The <code>ngOnChanges()</code> method is your first opportunity to access those properties. Angular calls <code>ngOnChanges()</code> before <code>ngOnInit()</code>, but also many times after that. It only calls <code>ngOnInit()</code> once.</p>
</li>
</ul>
<h3 id="Using-ngOnDestroy"><a href="#Using-ngOnDestroy" class="headerlink" title="Using ngOnDestroy"></a>Using <code>ngOnDestroy</code></h3><p>Put cleanup logic in <code>ngOnDestroy()</code>, <strong>the logic that must run before Angular destroys the directive</strong>.</p>
<p>This is the place to free resources that won’t be garbage-collected automatically. You risk memory leaks if you neglect to do so.</p>
<ul>
<li>Unsubscribe from Observables and DOM events.</li>
<li>Stop interval timers.</li>
<li>Unregister all callbacks that the directive registered with global or application services.</li>
</ul>
<p>The <code>ngOnDestroy()</code> method is also the time to notify another part of the application that the component is going away.</p>
<h3 id="Using-ngOnChanges"><a href="#Using-ngOnChanges" class="headerlink" title="Using ngOnChanges"></a>Using <code>ngOnChanges</code></h3><p>Angular calls the <code>ngOnChanges()</code> method of a component or directive whenever it detects changes to the <strong><em>input properties</em></strong>. The following example demonstrates this by monitoring the <code>OnChanges()</code> hook.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ngOnChanges(changes: SimpleChanges) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> propName <span class="keyword">in</span> changes) &#123;</span><br><span class="line">    <span class="keyword">let</span> chng = changes[propName];</span><br><span class="line">    <span class="keyword">let</span> cur  = <span class="built_in">JSON</span>.stringify(chng.currentValue);</span><br><span class="line">    <span class="keyword">let</span> prev = <span class="built_in">JSON</span>.stringify(chng.previousValue);</span><br><span class="line">    <span class="keyword">this</span>.changeLog.push(<span class="string">`<span class="subst">$&#123;propName&#125;</span>: currentValue = <span class="subst">$&#123;cur&#125;</span>, previousValue = <span class="subst">$&#123;prev&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The <code>ngOnChanges()</code> method takes an object that maps each changed property name to a <strong><a href="https://angular.io/api/core/SimpleChange" target="_blank" rel="noopener">SimpleChange</a> object holding the current and previous property values</strong>. This hook iterates over the changed properties and logs them.</p>
<p>For all the other Lifecycle Hooks not mentioned above, please visit <a href="https://angular.io/guide/lifecycle-hooks#general-examples" target="_blank" rel="noopener">https://angular.io/guide/lifecycle-hooks#general-examples</a></p>
<h2 id="Forms-for-User-Input"><a href="#Forms-for-User-Input" class="headerlink" title="Forms for User Input"></a>Forms for User Input</h2><p>Handling user input with forms is the cornerstone of many common applications. Applications use forms to enable users to log in, to update a profile, to enter sensitive information, and to perform many other data-entry tasks.</p>
<p>Angular provides two different approaches to <strong>handling user input through forms: reactive and template-driven</strong>. Both capture user input events from the view, validate the user input, create a form model and data model to update, and provide a way to track changes.</p>
<p><strong>Reactive forms and template-driven forms process and manage form data differently</strong>. Each approach offers different advantages.</p>
<ul>
<li><strong>Reactive forms</strong> provide direct, explicit access to the underlying forms object model. Compared to template-driven forms, they are more robust: they’re more scalable, reusable, and testable. If forms are a key part of your application, or you’re already using reactive patterns for building your application, use reactive forms.</li>
<li><strong>Template-driven forms</strong> rely on directives in the template to create and manipulate the underlying object model. They are useful for adding a simple form to an app, such as an email list signup form. They’re easy to add to an app, but they don’t scale as well as reactive forms. If you have very basic form requirements and logic that can be managed solely in the template, template-driven forms could be a good fit.</li>
</ul>
<p>The following sections only covers using <strong>reactive forms</strong>. If you need information on using <strong>template-driven forms</strong>, please visit <a href="https://angular.io/guide/forms-overview" target="_blank" rel="noopener">https://angular.io/guide/forms-overview</a> for more information.</p>
<h3 id="Common-Form-Foundation-Classes"><a href="#Common-Form-Foundation-Classes" class="headerlink" title="Common Form Foundation Classes"></a>Common Form Foundation Classes</h3><p>Both reactive and template-driven forms are built on the following base classes.</p>
<ul>
<li><code>FormControl</code> <strong>tracks the value and validation status</strong> of an individual form control.</li>
<li><code>FormGroup</code> tracks the same values and status for a collection of form controls.</li>
<li><code>FormArray</code> tracks the same values and status for an array of form controls.</li>
<li><code>ControlValueAccessor</code> creates a <strong>bridge between Angular <code>FormControl</code> instances and native DOM elements</strong>.</li>
</ul>
<h3 id="Setting-Up-Reactive-Forms"><a href="#Setting-Up-Reactive-Forms" class="headerlink" title="Setting Up Reactive Forms"></a>Setting Up Reactive Forms</h3><p>In general, all the information will be sent to the <code>FormControl</code> object that you will create. So, to use reactive forms, you need to:</p>
<ul>
<li><p>Register the <code>ReactiveFormsModule</code> in your app module (e.g. <code>app.module.ts</code>). </p>
<ul>
<li>This module declares the <strong>reactive-form directives that you need to use reactive forms</strong>.</li>
</ul>
</li>
<li><p>Import the necessary module and create a <code>FormControl</code> object in your <code>ts</code></p>
</li>
<li><p>Bind to the directive <code>formControl</code> in your html template with the object you created in the step above</p>
</li>
</ul>
<p>For example, to register the <code>ReactiveFormsModule</code> (in order to use the <code>FormControl</code>) directive, you can do:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; ReactiveFormsModule &#125; <span class="keyword">from</span> <span class="string">'@angular/forms'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@NgModule</span>(&#123;</span><br><span class="line">  imports: [</span><br><span class="line">    <span class="comment">// other imports ...</span></span><br><span class="line">    ReactiveFormsModule</span><br><span class="line">  ],</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppModule &#123; &#125;</span><br></pre></td></tr></table></figure>

<p>Then, you can use the <code>formControl</code> directive in your html with:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">  Name:</span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> [<span class="attr">formControl</span>]=<span class="string">"name"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>And that <code>name</code> would be:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; FormControl &#125; <span class="keyword">from</span> <span class="string">'@angular/forms'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector: <span class="string">'app-name-editor'</span>,</span><br><span class="line">  templateUrl: <span class="string">'./name-editor.component.html'</span>,</span><br><span class="line">  styleUrls: [<span class="string">'./name-editor.component.css'</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> NameEditorComponent &#123;</span><br><span class="line">  <span class="comment">// binds to this FormControl object, which you will use later</span></span><br><span class="line">  name = <span class="keyword">new</span> FormControl(<span class="string">''</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Using-Reactive-Forms"><a href="#Using-Reactive-Forms" class="headerlink" title="Using Reactive Forms"></a>Using Reactive Forms</h3><p>Now, the key comes to accessing the value that is stored in that <code>FormControl</code> object.</p>
<p>You can access the value in the following ways.</p>
<ul>
<li>Through <strong>the <code>valueChanges</code> observable</strong> where you can listen for changes in the form’s value in the template using <code>AsyncPipe</code> or in the component class using the <code>subscribe()</code> method.</li>
<li><strong>With the <code>value</code> property</strong>, which gives you a snapshot of the current value.</li>
</ul>
<p>The following example shows you how to display the current value using interpolation in the template.</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">  Value: &#123;&#123; name.value &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>The displayed value changes as you update the form control element, since changing the input will trigger <code>input</code> events that will be handled by <code>formControl</code> directive.</p>
<p>In general, reactive forms provide access to information about a given control <strong>through properties and methods provided with each instance</strong>. These properties and methods of the underlying <a href="https://angular.io/api/forms/AbstractControl" target="_blank" rel="noopener">AbstractControl</a> class are used to control form state and determine when to display messages when handling <a href="https://angular.io/guide/reactive-forms#basic-form-validation" target="_blank" rel="noopener">input validation</a>.</p>
<p>Read about other <code>FormControl</code> properties and methods in the <a href="https://angular.io/api/forms/FormControl" target="_blank" rel="noopener">API Reference</a>.</p>
<h3 id="Grouping-Form-Controls"><a href="#Grouping-Form-Controls" class="headerlink" title="Grouping Form Controls"></a>Grouping Form Controls</h3><p>The above reactive form examples is fine when there is only a limited number of inputs. However, when you are dealing with a form with quite a few input fields, or even some nested input structures, you should try to <strong>use a <code>FormGroup</code> together with <code>FormControl</code>s to manage multiple inputs</strong> cleanly.</p>
<p>In summary, when you want to group multiple inputs, you need to:</p>
<ul>
<li>Create a top level <code>FormGroup</code> that contains all the information of its children</li>
<li>Create children elements within that top level <code>FormGroup</code><ul>
<li>For <code>FormControl</code>s, you create them with <code>formControlName=&quot;someName&quot;</code></li>
<li>For nested <code>FormGroup</code>s, you create them with  <code>formGroupName=&quot;someOtherName&quot;</code></li>
</ul>
</li>
<li>Create a <code>FormGroup</code> object with the name defined in step 1 in your <code>ts</code>, and pass in a map reflecting the same structure as step 2 into its constructor</li>
<li>Most of the time you want to save that data and use it later. So you also need to create a button (or anything else) that emits a <code>submit</code> event, and you can save all the data and handle them with <code>(ngSubmit)=&quot;onSubmit()&quot;</code><ul>
<li>all the data will be stored in the <code>FormGroup</code> object you created in step 3. The data will be package into a map, where the key will be either the <code>fromControlName</code> or the <code>formGroupName</code></li>
</ul>
</li>
<li>*You can also add validators for your form, this will be touched on in the section <a href="#Validate-Form-Input">Validate Form Input</a></li>
</ul>
<h4 id="Example-Simple-Grouping-Form"><a href="#Example-Simple-Grouping-Form" class="headerlink" title="Example: Simple Grouping Form"></a>Example: Simple Grouping Form</h4><p>First, you create the form structure in your html:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Notice that only the top level needs binding, since all the control/information of its children are passed to it --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> [<span class="attr">formGroup</span>]=<span class="string">"profileForm"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">    First Name:</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"firstName"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">    Last Name:</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"lastName"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Then, in your <code>ts</code>, you create that <code>FormGroup</code> object with name <code>profileForm</code>, and pass in the same children hierarchy into its constructor:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; FormGroup, FormControl &#125; <span class="keyword">from</span> <span class="string">'@angular/forms'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector: <span class="string">'app-profile-editor'</span>,</span><br><span class="line">  templateUrl: <span class="string">'./profile-editor.component.html'</span>,</span><br><span class="line">  styleUrls: [<span class="string">'./profile-editor.component.css'</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> ProfileEditorComponent &#123;</span><br><span class="line">  <span class="comment">// its constructor takes a mapping, that maps the name you specified with the type of form (formControl/formGroup)</span></span><br><span class="line">  profileForm = <span class="keyword">new</span> FormGroup(&#123;</span><br><span class="line">    firstName: <span class="keyword">new</span> FormControl(<span class="string">''</span>),</span><br><span class="line">    lastName: <span class="keyword">new</span> FormControl(<span class="string">''</span>),</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then, if you want to save the value, you need to add a button (or anything else) that can emit a <code>submit</code> event.</p>
<p>Luckily, this event can be emitted natively by html with <code>&lt;button type=&quot;submit&quot;&gt;</code>:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- (ngSubmit) listens for the submit event and triggers onSubmit() method --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> [<span class="attr">formGroup</span>]=<span class="string">"profileForm"</span> (<span class="attr">ngSubmit</span>)=<span class="string">"onSubmit()"</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">    First Name:</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"firstName"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">    Last Name:</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"lastName"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- Native emitter for submit events --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Now, for most of the cases, your data handling would be outside of this component where you define all the form actions. This means you will probably use an <code>EventEmitter</code> and <code>@Output</code> that to other components for handling.</p>
<p>Here, we just show you how to access the data of the forms: </p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">onSubmit() &#123;</span><br><span class="line">  <span class="comment">// <span class="doctag">TODO:</span> Use EventEmitter with form value</span></span><br><span class="line">  <span class="built_in">console</span>.warn(<span class="keyword">this</span>.profileForm.value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>And <strong>the <code>profile.value</code> will be a map that looks like</strong>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;firstName: "user's input", lastName: "user's input"&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Example-Complex-Grouping-Form"><a href="#Example-Complex-Grouping-Form" class="headerlink" title="Example: Complex Grouping Form"></a>Example: Complex Grouping Form</h4><p>If you have nested <code>FormGroups</code> within a top level form group, most of the logics will be the same as above.</p>
<p>For example, to also get address information besides name, you can nest another <code>formGroup</code> inside the top level form:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> [<span class="attr">formGroup</span>]=<span class="string">"profileForm"</span>&gt;</span></span><br><span class="line">      </span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">    First Name:</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"firstName"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">    Last Name:</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"lastName"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- Notice you nest it in a div --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">formGroupName</span>=<span class="string">"address"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>Address<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">      Street:</span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"street"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">      City:</span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"city"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  </span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">      State:</span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"state"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">      Zip Code:</span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"zip"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Then the corresponding <code>ts</code> would look like:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; FormGroup, FormControl &#125; <span class="keyword">from</span> <span class="string">'@angular/forms'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector: <span class="string">'app-profile-editor'</span>,</span><br><span class="line">  templateUrl: <span class="string">'./profile-editor.component.html'</span>,</span><br><span class="line">  styleUrls: [<span class="string">'./profile-editor.component.css'</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> ProfileEditorComponent &#123;</span><br><span class="line">  profileForm = <span class="keyword">new</span> FormGroup(&#123;</span><br><span class="line">    firstName: <span class="keyword">new</span> FormControl(<span class="string">''</span>),</span><br><span class="line">    lastName: <span class="keyword">new</span> FormControl(<span class="string">''</span>),</span><br><span class="line">    address: <span class="keyword">new</span> FormGroup(&#123;	<span class="comment">// simply another FormGroup object is passed in</span></span><br><span class="line">      street: <span class="keyword">new</span> FormControl(<span class="string">''</span>),</span><br><span class="line">      city: <span class="keyword">new</span> FormControl(<span class="string">''</span>),</span><br><span class="line">      state: <span class="keyword">new</span> FormControl(<span class="string">''</span>),</span><br><span class="line">      zip: <span class="keyword">new</span> FormControl(<span class="string">''</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then the rest is the same (e.g. add a <code>submit</code> button). However, since you have nested another <code>formGroup</code>, <strong>the value you get from <code>profileForm.value</code> will be a nested map as well</strong>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;firstName: "user's input", lastName: "user's input", address: &#123;street: "user's input", ...&#125;&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Update-Values-in-the-Form-Group"><a href="#Update-Values-in-the-Form-Group" class="headerlink" title="Update Values in the Form Group"></a>Update Values in the Form Group</h3><p>When you have a single <code>FormControl</code>, you can simply change the values in that input by changing the <code>value</code> property. However, now you have a <code>FormGroup</code> that collects all its power from its child <code>FormControl</code> and <code>FormGroup</code>. To update/change the value of a specific child under the top level <code>FormGroup</code>, you can <strong>use the methods <code>setValue()</code> or <code>patchValue()</code> of the <code>FormGroup</code> object</strong>:</p>
<ul>
<li><code>setValue()</code><ul>
<li>sets a new value for the entire <code>FormGroup</code> object, meaning that you need to set <strong>all of its children <code>FormControl</code> or <code>FormGroup</code>s</strong>. Sometimes this will not be necessary, but it can be useful since it will <strong>explicitly throw an error</strong> when the structure you provided in the <code>setValue()</code> method differs from the <code>FormGroup</code> structure</li>
</ul>
</li>
<li><code>patchValue()</code><ul>
<li>patches specific values for the <code>FormGroup</code> object, meaning that you <strong>do not need to set all of its children</strong>. However, if there is a mismatch between the structure you provided in <code>patchValue()</code> and the <code>FormGroup</code> in html, it will <strong>fail silently</strong>.</li>
</ul>
</li>
</ul>
<p>For example, to update only the <code>firstName</code> and <code>street</code> information in the above form:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">updateProfile() &#123;</span><br><span class="line">  <span class="comment">// using patchValue()</span></span><br><span class="line">  <span class="keyword">this</span>.profileForm.patchValue(&#123;</span><br><span class="line">    firstName: <span class="string">'Nancy'</span>,</span><br><span class="line">    address: &#123;</span><br><span class="line">      street: <span class="string">'123 Drew Street'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>However, if you want to use <code>setValue()</code>:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">updateProfile() &#123;</span><br><span class="line">  <span class="comment">// using setValue()</span></span><br><span class="line">  <span class="keyword">this</span>.profileForm.patchValue(&#123;</span><br><span class="line">    firstName: <span class="string">'Nancy'</span>,</span><br><span class="line">    lastName: <span class="string">''</span></span><br><span class="line">    address: &#123;</span><br><span class="line">      street: <span class="string">'123 Drew Street'</span>,</span><br><span class="line">      city: <span class="string">''</span>,</span><br><span class="line">      state: <span class="string">''</span>,</span><br><span class="line">      zip: <span class="string">''</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Using-FormBuilder-Service"><a href="#Using-FormBuilder-Service" class="headerlink" title="Using FormBuilder Service"></a>Using <code>FormBuilder</code> Service</h3><p>Angular also provides a <code>builder</code> class that can simplify the syntax for creating complex forms. The <code>FormBuilder</code> has three methods: <code>control()</code>, <code>group()</code>, <code>array()</code>, which generates form controls, form groups, and form arrays (see <a href="#Creating-Dynamic-Forms-With-Form-Array">Creating Dynamic Forms</a>).</p>
<p>In summary, you need to:</p>
<ul>
<li>Import the <code>FormBuilder</code> from <code>@angular/forms</code></li>
<li>Use <code>group</code> to create form groups, <code>control</code> to create form control, <code>array</code> to create form arrays.</li>
</ul>
<p>For example, the same form above would be refactored to be:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; FormBuilder &#125; <span class="keyword">from</span> <span class="string">'@angular/forms'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector: <span class="string">'app-profile-editor'</span>,</span><br><span class="line">  templateUrl: <span class="string">'./profile-editor.component.html'</span>,</span><br><span class="line">  styleUrls: [<span class="string">'./profile-editor.component.css'</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> ProfileEditorComponent &#123;</span><br><span class="line">  profileForm = <span class="keyword">this</span>.fb.group(&#123;</span><br><span class="line">    firstName: [<span class="string">''</span>],	<span class="comment">// notice the array here</span></span><br><span class="line">    lastName: [<span class="string">''</span>],</span><br><span class="line">    address: <span class="keyword">this</span>.fb.group(&#123;</span><br><span class="line">      street: [<span class="string">''</span>],</span><br><span class="line">      city: [<span class="string">''</span>],</span><br><span class="line">      state: [<span class="string">''</span>],</span><br><span class="line">      zip: [<span class="string">''</span>]</span><br><span class="line">    &#125;),</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> fb: FormBuilder</span>) &#123; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> Notice that the value for each control name <strong>is an array containing the initial value as the first item</strong> in the array. You can define the control with just the initial value, but if your controls need sync or async validation, <strong>add sync and async validators as the second and third items in the array</strong>.</li>
</ul>
</blockquote>
<h3 id="Validate-Form-Input"><a href="#Validate-Form-Input" class="headerlink" title="Validate Form Input"></a>Validate Form Input</h3><p><em>Form validation</em> is used to ensure that user input is complete and correct. This section covers <strong>adding a single validator to a form control and displaying the overall form status</strong>. Form validation is covered more extensively in the <a href="https://angular.io/guide/form-validation" target="_blank" rel="noopener">Form Validation</a> guide.</p>
<p>In summary, to add a validator, you need to:</p>
<ul>
<li>Import a validator function (e.g. <code>Validators.required</code> from <code>@angular/forms</code>)</li>
<li>Add that validator function to the field(s) of your form</li>
<li>*Add logic to handle the validation status<ul>
<li>There is a native <code>status</code> property of a form object, which <strong>will be <code>invalid</code> if any of its children is <code>invalid</code></strong></li>
</ul>
</li>
</ul>
<p>For example, to make the field <code>firstName</code>  required, you can use the <code>Validators.required</code> function:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Validators &#125; <span class="keyword">from</span> <span class="string">'@angular/forms'</span>;</span><br><span class="line">...</span><br><span class="line">profileForm = <span class="keyword">this</span>.fb.group(&#123;</span><br><span class="line">  firstName: [<span class="string">''</span>, Validators.required],</span><br><span class="line">  lastName: [<span class="string">''</span>],</span><br><span class="line">  address: <span class="keyword">this</span>.fb.group(&#123;</span><br><span class="line">    street: [<span class="string">''</span>],</span><br><span class="line">    city: [<span class="string">''</span>],</span><br><span class="line">    state: [<span class="string">''</span>],</span><br><span class="line">    zip: [<span class="string">''</span>]</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> fb: FormBuilder</span>) &#123; &#125;</span><br></pre></td></tr></table></figure>

<p>Alternatively, since there is also a native <code>required</code> validator in html, the following has the same effect:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">formControlName</span>=<span class="string">"firstName"</span> <span class="attr">required</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Then, you can see the status with:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">  Form Status: &#123;&#123; profileForm.status &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>which will be <code>invalid</code> if <code>firstName</code> is not filled, or simply with:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">  Form Valid: &#123;&#123; profileForm.valid &#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>which will be <code>false</code> if <code>firstName</code> is not filled.</p>
<p>So a simple usage would be <strong>disabling the submit button if the status is <code>invalid</code></strong>:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> [<span class="attr">disabled</span>]=<span class="string">"!profileForm.valid"</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Creating-Dynamic-Forms-with-Form-Array"><a href="#Creating-Dynamic-Forms-with-Form-Array" class="headerlink" title="Creating Dynamic Forms with Form Array"></a>Creating Dynamic Forms with Form Array</h3><p><code>FormArray</code> is an alternative to <code>FormGroup</code> for managing any number of unnamed controls. As with form group instances, you can dynamically insert and remove controls from form array instances, and the form array instance value and validation status is calculated from its child controls. <strong>However, you don’t need to define a key for each control by name, so this is a great option if you don’t know the number of child values in advance</strong>.</p>
<p>To define a dynamic form, take the following steps.</p>
<ol>
<li>Import the <code>FormArray</code> class.</li>
<li>Define a <code>FormArray</code> control.</li>
<li>Access the <code>FormArray</code> control with a getter method, so that you could access its fields or populate it<ul>
<li>You can populate the <code>FormArray</code> control with <code>FormControl</code> instances or <code>FormGroup</code> instances by <code>push()</code> to that array</li>
</ul>
</li>
<li>Display the form array in a template.</li>
</ol>
<blockquote>
<p>The following uses a basic approach of creating a dynamic form using a form array. For more information on creating a dynamic form, please visit <a href="https://angular.io/guide/dynamic-form#building-dynamic-forms" target="_blank" rel="noopener">https://angular.io/guide/dynamic-form#building-dynamic-forms</a>.</p>
</blockquote>
<p>For example:</p>
<p>Your html would look like:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> [<span class="attr">formGroup</span>]=<span class="string">"profileForm"</span> (<span class="attr">ngSubmit</span>)=<span class="string">"onSubmit()"</span>&gt;</span></span><br><span class="line"> ...</span><br><span class="line">    </span><br><span class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">formArrayName</span>=<span class="string">"aliases"</span>&gt;</span></span><br><span class="line">     </span><br><span class="line">   <span class="tag">&lt;<span class="name">h3</span>&gt;</span>Aliases<span class="tag">&lt;/<span class="name">h3</span>&gt;</span> <span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"addAlias()"</span>&gt;</span>Add Alias<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngFor</span>=<span class="string">"let alias of aliases.controls; let i=index"</span>&gt;</span></span><br><span class="line">     <span class="comment">&lt;!-- The repeated alias template --&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">       Alias:</span><br><span class="line">       <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> [<span class="attr">formControlName</span>]=<span class="string">"i"</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">     </span><br><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>where <code>aliases.controls</code> would return <strong>a list of <code>FormControls</code> that is stored in the array</strong>.</p>
<p>Your <code>ts</code> would look like:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; FormArray &#125; <span class="keyword">from</span> <span class="string">'@angular/forms'</span>;</span><br><span class="line">...</span><br><span class="line">profileForm = <span class="keyword">this</span>.fb.group(&#123;</span><br><span class="line">  firstName: [<span class="string">''</span>, Validators.required],</span><br><span class="line">  lastName: [<span class="string">''</span>],</span><br><span class="line">  address: <span class="keyword">this</span>.fb.group(&#123;</span><br><span class="line">    street: [<span class="string">''</span>],</span><br><span class="line">    city: [<span class="string">''</span>],</span><br><span class="line">    state: [<span class="string">''</span>],</span><br><span class="line">    zip: [<span class="string">''</span>]</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="comment">// form array created here</span></span><br><span class="line">  aliases: <span class="keyword">this</span>.fb.array([</span><br><span class="line">    <span class="keyword">this</span>.fb.control(<span class="string">''</span>)</span><br><span class="line">  ])</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Then, to get that form array, you can do:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">get</span> aliases() &#123;</span><br><span class="line">  <span class="comment">// gets the FormArray</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.profileForm.get(<span class="string">'aliases'</span>) <span class="keyword">as</span> FormArray;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Now, once you have that <code>FormArray</code>, you can manipulate it, such as populating it with more <code>FormControls</code>:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">addAlias() &#123;</span><br><span class="line">  <span class="keyword">this</span>.aliases.push(<span class="keyword">this</span>.fb.control(<span class="string">''</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Lastly, if you look at the <code>profileForm.values</code>, you will see that the <strong><code>aliases</code> will have data stored in an array</strong>:</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; "firstName": "", "lastName": "", "address": &#123; "street": "", ...&#125;, "aliases": [ "" ] &#125;</span><br></pre></td></tr></table></figure>

<h2 id="Accessing-Servers-Over-HTTP"><a href="#Accessing-Servers-Over-HTTP" class="headerlink" title="Accessing Servers Over HTTP"></a>Accessing Servers Over HTTP</h2><p>Most front-end applications need to communicate with a server over the HTTP protocol, in order to download or upload data and access other back-end services. Angular provides a simplified client HTTP API for Angular applications, the <code>HttpClient</code> service class in <code>@angular/common/http</code>.</p>
<p>The HTTP client service offers the following major features.</p>
<ul>
<li>The ability to request <a href="https://angular.io/guide/http#typed-response" target="_blank" rel="noopener">typed response objects</a>.</li>
<li>Streamlined <a href="https://angular.io/guide/http#error-handling" target="_blank" rel="noopener">error handling</a>.</li>
<li><a href="https://angular.io/guide/http#testing-requests" target="_blank" rel="noopener">Testability</a> features.</li>
<li>Request and response <a href="https://angular.io/guide/http#intercepting-requests-and-responses" target="_blank" rel="noopener">interception</a>.</li>
</ul>
<h3 id="Requesting-Data-from-Server-with-GET"><a href="#Requesting-Data-from-Server-with-GET" class="headerlink" title="Requesting Data from Server with GET"></a>Requesting Data from Server with GET</h3><p>Use the <a href="https://angular.io/api/common/http/HttpClient#get" target="_blank" rel="noopener"><code>HTTPClient.get()</code></a> method to fetch data from a server. The asynchronous method sends an HTTP request, and <strong>returns an Observable</strong> that emits the requested data when the response is received.</p>
<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> In order for this to work with <strong>servers on a different domain</strong>, you <strong>either need to have CORS protocol enabled</strong> (for Spring Boot, this can be done simply with <code>@CrossOrigin(origins = {&quot;&lt;other domain address&gt;&quot;})</code>, <strong>or use the <a href="https://angular.io/guide/http#making-a-jsonp-request" target="_blank" rel="noopener">JSONP request</a></strong>.</li>
</ul>
</blockquote>
<p>The <code>get()</code> method takes two arguments; the <strong>endpoint URL from which to fetch</strong>, and an <strong><em>options</em> object</strong> that you can use to configure the request.</p>
<p>The <code>options</code> object contains fields like this:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">options: &#123;</span><br><span class="line">    headers?: HttpHeaders | &#123;[header: <span class="built_in">string</span>]: <span class="built_in">string</span> | <span class="built_in">string</span>[]&#125;,</span><br><span class="line">    observe?: <span class="string">'body'</span> | <span class="string">'events'</span> | <span class="string">'response'</span>,</span><br><span class="line">    params?: HttpParams|&#123;[param: <span class="built_in">string</span>]: <span class="built_in">string</span> | <span class="built_in">string</span>[]&#125;,</span><br><span class="line">    reportProgress?: <span class="built_in">boolean</span>,</span><br><span class="line">    responseType?: <span class="string">'arraybuffer'</span>|<span class="string">'blob'</span>|<span class="string">'json'</span>|<span class="string">'text'</span>,</span><br><span class="line">    withCredentials?: <span class="built_in">boolean</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Important options include the <code>observe</code> and <code>responseType</code> (<code>params</code> is useful when you have query strings) properties.</p>
<ul>
<li>The <code>observe</code> option specifies how much of the response to return.</li>
<li>The <code>responseType</code> option specifies the format in which to return data.</li>
</ul>
<p>Applications often request JSON data from a server. If you want to get JSON data, you need to do:</p>
<ul>
<li>specify a <code>URL</code> that maps to the get request in your backend</li>
<li>specify the <code>options</code> with <code>{observe: &#39;body&#39;, responceType: &#39;json&#39;}</code><ul>
<li>There are actually the default value as well. So if you specified nothing (did not provide the <code>options</code>), it works as well.</li>
</ul>
</li>
</ul>
<p>For example:</p>
<p>You can get JSON data (e.g. Objects) with:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">configUrl = <span class="string">'assets/someQuery'</span>;</span><br><span class="line"></span><br><span class="line">getConfig() &#123;</span><br><span class="line">  <span class="keyword">const</span> options = &#123; observe: <span class="string">'body'</span>, responceType: <span class="string">'json'</span> &#125;;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.http.get(<span class="keyword">this</span>.configUrl, options);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>which is equivalent to:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">configUrl = <span class="string">'assets/someQuery'</span>;</span><br><span class="line"></span><br><span class="line">getConfig() &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.http.get(<span class="keyword">this</span>.configUrl);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Now, because the service method returns an <code>Observable</code> of configuration data, <strong>you need to <em>subscribe</em> to the method’s return value in order to see results</strong>. </p>
<p>The subscription callback performs minimal post-processing. It copies the data fields into the component’s <code>config</code> object, which is data-bound in the component template for display.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> config: Config;</span><br><span class="line"></span><br><span class="line">showConfig() &#123;</span><br><span class="line">  <span class="comment">// subscribe( &lt;receivedData: TypeToCast&gt; =&gt; variableToStore = &lt;receivedData&gt; )</span></span><br><span class="line">  <span class="keyword">this</span>.configService.getConfig()</span><br><span class="line">    .subscribe(<span class="function">(<span class="params">data: Config</span>) =&gt;</span> <span class="keyword">this</span>.config = data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Requesting-a-Typed-Response"><a href="#Requesting-a-Typed-Response" class="headerlink" title="Requesting a Typed Response"></a>Requesting a Typed Response</h4><p>The above takes quite some effort in the end to typecast to the desired object you need. While this is fine, you could make the data handling easier by  declaring the type of the response object with <code>get&lt;Type&gt;()</code>.</p>
<p>In summary, you need to:</p>
<ul>
<li>Create an <code>interface</code> rather than <code>class</code> so that JSON can be converted to an instance of the <code>interface</code></li>
<li>Supply that <code>interface</code> to the <code>get&lt;TypeHere&gt;()</code></li>
</ul>
<p>For example, if you have a <code>Config</code> interface for the examples above:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> Config &#123;</span><br><span class="line">  heroesUrl: <span class="built_in">string</span>;</span><br><span class="line">  textfile: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then you can do:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// this should be in one of your service class</span></span><br><span class="line">getConfig() &#123;</span><br><span class="line">  <span class="comment">// now returns an Observable of Config</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.http.get&lt;Config&gt;(<span class="keyword">this</span>.configUrl);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This can simplify your code in your component:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">config: Config;</span><br><span class="line"></span><br><span class="line">showConfig() &#123;</span><br><span class="line">  <span class="keyword">this</span>.configService.getConfig()</span><br><span class="line">    <span class="comment">// clone the data object, using its known Config shape</span></span><br><span class="line">    .subscribe(<span class="function"><span class="params">data</span> =&gt;</span> <span class="keyword">this</span>.config = data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Reading-a-Full-Response"><a href="#Reading-a-Full-Response" class="headerlink" title="Reading a Full Response"></a>Reading a Full Response</h4><p>The above example only reads the <code>body</code> of a html response. However, a full response contain information such as <code>headers</code>, <code>status</code>, <code>statusText</code>, <code>url</code>, <code>ok</code>, <code>type</code>, and finally <code>body</code>.</p>
<p>To get the full response, we need to change to <code>observe: &#39;response&#39;</code> instead of the default <code>observe: &#39;body&#39;</code>.</p>
<blockquote>
<p><em>OBSERVE</em> AND <em>RESPONSE</em> TYPES</p>
<p>The types of the <code>observe</code> and <code>response</code> options <strong>are <em>string unions</em>, rather than plain strings</strong>.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">options: &#123;</span><br><span class="line">    ...</span><br><span class="line">    observe?: <span class="string">'body'</span> | <span class="string">'events'</span> | <span class="string">'response'</span>,</span><br><span class="line">    ...</span><br><span class="line">    responseType?: <span class="string">'arraybuffer'</span>|<span class="string">'blob'</span>|<span class="string">'json'</span>|<span class="string">'text'</span>,</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>This can cause confusion. For example:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// this works</span></span><br><span class="line">client.get(<span class="string">'/foo'</span>, &#123;responseType: <span class="string">'text'</span>&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// but this does NOT work</span></span><br><span class="line"><span class="keyword">const</span> options = &#123;</span><br><span class="line">  responseType: <span class="string">'text'</span>,</span><br><span class="line">&#125;;</span><br><span class="line">client.get(<span class="string">'/foo'</span>, options)</span><br></pre></td></tr></table></figure>

<p>In the second case, TypeScript infers the type of <code>options</code> to be <code>{responseType: string}</code>. The type is too wide to pass to <code>HttpClient.get</code> <strong>which is expecting the type of <code>responseType</code> to be one of the <em>specific</em> strings</strong>. <code>HttpClient</code> is typed explicitly this way so that the compiler can report the correct return type based on the options you provided.</p>
<p>Use <code>as const</code> to let TypeScript know that you really do mean to use a constant string type:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> options = &#123;</span><br><span class="line">  responseType: <span class="string">'text'</span> <span class="keyword">as</span> <span class="keyword">const</span>,</span><br><span class="line">&#125;;</span><br><span class="line">client.get(<span class="string">'/foo'</span>, options);</span><br></pre></td></tr></table></figure>
</blockquote>
<p>So, if you need more information about the transaction than is contained in the response body (e.g. sometimes servers return special headers or status codes to indicate certain conditions that are important to the application workflow), you can have:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// notice the HttpResponse&lt;Config&gt; object</span></span><br><span class="line">getConfigResponse(): Observable&lt;HttpResponse&lt;Config&gt;&gt; &#123;</span><br><span class="line">  <span class="comment">// this is still Config</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.http.get&lt;Config&gt;(</span><br><span class="line">    <span class="keyword">this</span>.configUrl, &#123; observe: <span class="string">'response'</span> &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Now <code>HttpClient.get()</code> returns an <code>Observable</code> of type <code>HttpResponse</code> rather than just the JSON data contained in the body.</p>
<h4 id="Requesting-Non-JSON-Data"><a href="#Requesting-Non-JSON-Data" class="headerlink" title="Requesting Non-JSON Data"></a>Requesting Non-JSON Data</h4><p>Not all APIs return JSON data. In this next example, a <code>DownloaderService</code> method reads a text file from the server and logs the file contents, before returning those contents to the caller as an <code>Observable&lt;string&gt;</code>.</p>
<p>For example:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">getTextFile(filename: <span class="built_in">string</span>): Observable&lt;<span class="built_in">string</span>&gt; &#123;</span><br><span class="line">  <span class="comment">// The Observable returned by get() is of type Observable&lt;string&gt;</span></span><br><span class="line">  <span class="comment">// because a text response was specified.</span></span><br><span class="line">  <span class="comment">// There's no need to pass a &lt;string&gt; type parameter to get().</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.http.get(filename, &#123;responseType: <span class="string">'text'</span>&#125;)</span><br><span class="line">    .pipe(</span><br><span class="line">      tap( <span class="comment">// Log the result or error</span></span><br><span class="line">        data =&gt; <span class="keyword">this</span>.log(filename, data),</span><br><span class="line">        error =&gt; <span class="keyword">this</span>.logError(filename, error)</span><br><span class="line">      )</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>where:</p>
<ul>
<li>The <code>RxJS</code> <code>tap</code> operator (as in “wiretap”) lets the code <strong>inspect both success and error values passing through the observable without disturbing them</strong>.<ul>
<li><code>data</code> would be the data returned from server if the request is successful</li>
<li><code>error</code> would be the error message if the request is not successful</li>
</ul>
</li>
</ul>
<p>Now <code>HttpClient.get()</code> <strong>returns a string</strong> rather than the default JSON because of the <code>responseType</code> option, and you can easily use it with:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> contents: <span class="built_in">string</span>;</span><br><span class="line">...</span><br><span class="line">download() &#123;</span><br><span class="line">  <span class="keyword">this</span>.downloaderService.getTextFile(<span class="string">'assets/textfile.txt'</span>)</span><br><span class="line">    .subscribe(<span class="function"><span class="params">results</span> =&gt;</span> <span class="keyword">this</span>.contents = results);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Handling-Request-Errors"><a href="#Handling-Request-Errors" class="headerlink" title="Handling Request Errors"></a>Handling Request Errors</h3><p>If the request fails on the server, <strong><code>HttpClient</code> returns an <em>error</em> object</strong> instead of a successful response.</p>
<p>The same service that performs your server transactions should also perform error inspection, interpretation, and resolution.</p>
<p>When an error occurs, you can obtain details of what failed in order to inform your user. In some cases, you might also automatically <a href="https://angular.io/guide/http#retry" target="_blank" rel="noopener">retry the request</a>. The following section explores how you could achieve those.</p>
<h4 id="Getting-Error-Details"><a href="#Getting-Error-Details" class="headerlink" title="Getting Error Details"></a>Getting Error Details</h4><p>In general, there are two types of errors can occur.</p>
<ul>
<li>The <strong>server backend</strong> might reject the request, returning an HTTP response with a status code such as 404 or 500. These are error <em>responses</em>.</li>
<li>Something could <strong>go wrong on the client-side</strong> such as a network error that prevents the request from completing successfully or an exception thrown in an RxJS operator. These errors produce JavaScript <code>ErrorEvent</code> objects.</li>
</ul>
<p><code>HttpClient</code> captures both kinds of errors in its <code>HttpErrorResponse</code>. You can inspect that response to identify the error’s cause.</p>
<p><strong>In summary, you need to:</strong></p>
<ol>
<li><p>Create a custom error handling method, which takes a <code>HttpErrorResponce</code>  object. You can include your own logic there.</p>
<ul>
<li>You should throw a customized Object that contains the error information with <code>throwError(&lt;YourErrorObject&gt;)</code>, so that you could also display on the page later</li>
</ul>
</li>
<li><p>Pass this function to the <code>catchErorr</code> operator in the <code>pipe</code> right after the <code>get</code> method.</p>
<ul>
<li>For more information of what is happening in the <code>pipe</code>, please visit: <a href="https://angular.io/guide/rx-library#error-handling" target="_blank" rel="noopener">https://angular.io/guide/rx-library#error-handling</a></li>
</ul>
</li>
<li><p>*Use the error object you thrown to display some messages on the page for users to see</p>
</li>
</ol>
<p>For example, a simple error handling method could look like:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> handleError(error: HttpErrorResponse): Observable&lt;never&gt;&#123;</span><br><span class="line">    <span class="keyword">if</span> (error.error <span class="keyword">instanceof</span> ErrorEvent)&#123;</span><br><span class="line">        <span class="built_in">console</span>.error(<span class="string">'client side error '</span> + error.error.message);</span><br><span class="line">        <span class="keyword">return</span> throwError(<span class="string">`Please try again. <span class="subst">$&#123;error.error.message&#125;</span>`</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.error(<span class="string">'server side error:'</span>);</span><br><span class="line">        <span class="built_in">console</span>.error(<span class="string">`error status: <span class="subst">$&#123;error.status&#125;</span></span></span><br><span class="line"><span class="string">        error body: <span class="subst">$&#123;error.error&#125;</span></span></span><br><span class="line"><span class="string">        error header: <span class="subst">$&#123;error.headers.keys()&#125;</span></span></span><br><span class="line"><span class="string">        error URL: <span class="subst">$&#123;error.url&#125;</span>`</span>);</span><br><span class="line">        <span class="keyword">return</span> throwError(<span class="string">`Please try again. <span class="subst">$&#123;error.status&#125;</span>; <span class="subst">$&#123;error.message&#125;</span>; <span class="subst">$&#123;error.url&#125;</span>`</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The above example basically stores information in a single string. In your own application, you can create your own <code>ErrorObject</code> and store formatted information there.</p>
<p>Then, for the <code>get()</code> method to use this, you need to have:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">getConfig() &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.http.get&lt;Config&gt;(<span class="keyword">this</span>.configUrl)</span><br><span class="line">    <span class="comment">// add the pipe here, pass in your function to the operator catchError()</span></span><br><span class="line">    .pipe(</span><br><span class="line">      catchError(<span class="keyword">this</span>.handleError)</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Now, if an error actually occurs when you call the <code>get</code> request, it will be handled by your <code>handleError</code> function.</p>
<p>Lastly, if you want to use the error information that you have thrown with <code>throwError(&lt;whatever you have here&gt;)</code>, you could:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">errorRequest(request: <span class="built_in">string</span>): <span class="built_in">void</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.heroService.errorRequest(request)</span><br><span class="line">    	<span class="comment">// notice this error =&gt; this.randomQueryError = error</span></span><br><span class="line">        .subscribe(<span class="function"><span class="params">data</span> =&gt;</span> <span class="keyword">this</span>.randomQueryResult = data, <span class="function"><span class="params">error</span> =&gt;</span> <span class="keyword">this</span>.randomQueryError = error);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Now, the <strong>error object that you have thrown before will be caught by <code>subscribe</code></strong> and stored in <code>randomQueryError</code>, which then you could display by binding it to your html template.</p>
<h4 id="Retrying-a-Failed-Request"><a href="#Retrying-a-Failed-Request" class="headerlink" title="Retrying a Failed Request"></a>Retrying a Failed Request</h4><p>Sometimes the error is transient and goes away automatically if you try again. For example, network interruptions are common in mobile scenarios, and trying again can produce a successful result.</p>
<p>The <a href="https://angular.io/guide/rx-library" target="_blank" rel="noopener">RxJS library</a> offers several <em>retry</em> operators. For example, the <code>retry()</code> operator automatically re-subscribes to a failed <code>Observable</code> a specified number of times. <em>Re-subscribing</em> to the result of an <code>HttpClient</code> method call has the effect of reissuing the HTTP request.</p>
<p><strong>In summary, you need to:</strong></p>
<ol>
<li>Add the operator <code>retry(&lt;number of retries&gt;)</code> to the <code>pipe</code> <ul>
<li>This should go before <code>catchError</code>, since operators are executed sequentially</li>
</ul>
</li>
</ol>
<p>For example, to issue retries before deciding to catch the error, you could:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">getConfig() &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.http.get&lt;Config&gt;(<span class="keyword">this</span>.configUrl)</span><br><span class="line">    .pipe(</span><br><span class="line">      retry(<span class="number">3</span>), <span class="comment">// retry a failed request up to 3 times</span></span><br><span class="line">      catchError(<span class="keyword">this</span>.handleError) <span class="comment">// then handle the error</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Sending-Data-to-the-Server"><a href="#Sending-Data-to-the-Server" class="headerlink" title="Sending Data to the Server"></a>Sending Data to the Server</h3><p>In addition to fetching data from a server, <code>HttpClient</code> supports <strong>other HTTP methods such as PUT, POST, and DELETE, which you can use to modify the remote data</strong>.</p>
<h4 id="Making-a-POST-Request"><a href="#Making-a-POST-Request" class="headerlink" title="Making a POST Request"></a>Making a POST Request</h4><p>Apps often send data to a server with a POST request when submitting a form. </p>
<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> Data that you want to send using a POST request has a similar format to a GET request, in which both uses the key-value pair separated with <code>&amp;</code> to pass data. However, POST request stores those information in the request header, yet GET request goes directly in the URL.</li>
</ul>
</blockquote>
<p><strong>In summary, to send a POST request</strong> containing the data you want to post, you need to:</p>
<ol>
<li>Have the data you want to post ready<ul>
<li>It can be an Object, for example</li>
</ul>
</li>
<li>Use the <code>post&lt;ExpectedResultObject&gt;(URL, &lt;YourDataObject&gt;, httpOptions)</code><ul>
<li>Same as <code>get()</code> method, <code>post()</code> also returns an <code>Observable</code></li>
</ul>
</li>
<li>Actually fire the post event by using <code>subscribe</code>, which you have done with <code>get()</code> as well</li>
</ol>
<p>For example:</p>
<p>Your service class (that does all the backend communication) could look like:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** POST: add a new hero to the database */</span></span><br><span class="line">addHero (hero: Hero): Observable&lt;Hero&gt; &#123;</span><br><span class="line">  <span class="comment">// notice that the data you want to POST is also passed in here</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.http.post&lt;Hero&gt;(<span class="keyword">this</span>.heroesUrl, hero, httpOptions)</span><br><span class="line">    .pipe(</span><br><span class="line">      catchError(<span class="keyword">this</span>.handleError(<span class="string">'addHero'</span>, hero))</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>From the above, you see the <code>post()</code> method <strong>takes a resource URL and two additional parameters</strong>:</p>
<ul>
<li><em>body</em> - The data to POST in the body of the request.</li>
<li><em>options</em>` - An object containing method options which, in this case, <a href="https://angular.io/guide/http#adding-headers" target="_blank" rel="noopener">specify required headers</a>.</li>
</ul>
<p>Lastly, you initiate the POST request with <code>subscribe</code> in your component:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.heroesService.addHero(newHero)</span><br><span class="line">  .subscribe(<span class="function"><span class="params">hero</span> =&gt;</span> <span class="keyword">this</span>.heroes.push(hero));	<span class="comment">// fires the event and fetched the result</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> If you only call the <code>addHero(newHero)</code> method, nothing will happen as that does NOT fire the request. To actually fire the event, it is done by calling the <code>subscribe</code> method, which both fires the event and gets the response asynchronously.</li>
</ul>
</blockquote>
<h4 id="Making-a-DELETE-Request"><a href="#Making-a-DELETE-Request" class="headerlink" title="Making a DELETE Request"></a>Making a DELETE Request</h4><p>This looks very similar to a GET request. The only difference for syntax is that you use the <code>delete</code> method instead of the <code>get</code> method.</p>
<p>In summary:</p>
<ol>
<li>Specify the DELETE request URL. This will look like a GET request URL.</li>
<li>Send the DELETE request with <code>delete()</code><ul>
<li>Though the URL looks the same, a DELETE request still differs from a GET request internally. <strong>For example, if you used <code>@DeleteMapping</code> in Spring Boot, then using a <code>get()</code> in Angular does NOT work (and vice versa).</strong> You need to use <code>delete()</code>.</li>
</ul>
</li>
<li>Subscribe to fire the event, even if you do not have any result to get from the request.</li>
</ol>
<p>A simple example would be:</p>
<p>Your Spring Boot could have implemented:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// even this looks like a GET request, typing in the URL does NOT WORK</span></span><br><span class="line"><span class="meta">@DeleteMapping</span>(<span class="string">"/api/delHero/&#123;id&#125;"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Hero <span class="title">deleteHero</span><span class="params">(@PathVariable <span class="keyword">int</span> id)</span></span>&#123;</span><br><span class="line">    Hero result = heroService.getHero(id);</span><br><span class="line">    heroService.delHeroById(id);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then, your Angular service class would look like:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">delHero(id: <span class="built_in">number</span>): Observable&lt;Hero&gt;&#123;</span><br><span class="line">    <span class="keyword">const</span> URL = <span class="string">`http://localhost:8080/api/delHero/<span class="subst">$&#123;id&#125;</span>`</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.httpService.delete(URL, &#123;observe: <span class="string">'response'</span>&#125;);	<span class="comment">// Here I want to look at the entire response</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Now, to fire/retrieve the result from the request, you will have:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">deleteRequest(id: <span class="built_in">string</span>): <span class="built_in">void</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.heroService.delHero(+id).subscribe(<span class="function">(<span class="params">data: Hero</span>) =&gt;</span> <span class="keyword">this</span>.deleteResult = data);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Making-a-PUT-Request"><a href="#Making-a-PUT-Request" class="headerlink" title="Making a PUT Request"></a>Making a PUT Request</h4><p>PUT request looks identical to POST request in terms of syntax, yet, again, they are different internally. If you are using a <code>@PutMapping</code> in your Spring Boot Application, you need to send a PUT request instead of a POST (or any other request).</p>
<p><strong>In summary</strong>, it is very alike making a POST request:</p>
<ol>
<li>Prepare the data that you want to update</li>
<li>Use the <code>put()</code> method, which takes a URL for the request, a field for the actual data, and an optional <code>HttpOptions</code> object</li>
<li>To fire the request and fetch the returned result, use <code>subscribe</code></li>
</ol>
<p>For example:</p>
<p>In your Spring Boot application, you could have:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PutMapping</span>(<span class="string">"/api/updateHero"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> Hero <span class="title">updateHero</span><span class="params">(@RequestBody Hero hero)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.heroService.updateHero(hero);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Then in your Angular service class:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">updateHero(hero: Hero): Observable&lt;Hero&gt;&#123;</span><br><span class="line">    <span class="keyword">const</span> URL = <span class="string">`http://localhost:8080/api/updateHero`</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.httpService.put&lt;Hero&gt;(URL, hero);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Now, in your component, you could have:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">putNewHero(data: <span class="built_in">any</span>): <span class="built_in">void</span> &#123;</span><br><span class="line">    <span class="comment">// because I used a FormGroup, and I had a different formControlName than the properties of Hero interface</span></span><br><span class="line">    <span class="keyword">const</span> hero = <span class="keyword">new</span> HeroImpl(data.heroId, data.heroName);</span><br><span class="line">    <span class="keyword">this</span>.heroService.updateHero(hero).subscribe(<span class="function"><span class="params">data2</span> =&gt;</span> <span class="keyword">this</span>.updateResult = data2);</span><br><span class="line">	<span class="comment">// the last method clears the input field</span></span><br><span class="line">    <span class="keyword">this</span>.clearUpdateHeroForm();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Adding-and-Updating-Headers"><a href="#Adding-and-Updating-Headers" class="headerlink" title="Adding and Updating Headers"></a>Adding and Updating Headers</h3><p>Many servers require extra headers for the operations defined above. For example, a server might require an authorization token or “Content-Type” header.</p>
<h4 id="Adding-Headers"><a href="#Adding-Headers" class="headerlink" title="Adding Headers"></a>Adding Headers</h4><p>In summary, all you need to do is to specify the <code>httpOptions</code></p>
<ol>
<li>Create a mapping and specify <code>headers: new HttpHeaders({...})</code></li>
</ol>
<p>For example:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; HttpHeaders &#125; <span class="keyword">from</span> <span class="string">'@angular/common/http'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> httpOptions = &#123;</span><br><span class="line">  headers: <span class="keyword">new</span> HttpHeaders(&#123;</span><br><span class="line">    <span class="string">'Content-Type'</span>:  <span class="string">'application/json'</span>,</span><br><span class="line">    <span class="string">'Authorization'</span>: <span class="string">'my-auth-token'</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Then you can pass the above <code>httpOptions</code> into all the request you make.</p>
<h4 id="Updating-Headers"><a href="#Updating-Headers" class="headerlink" title="Updating Headers"></a>Updating Headers</h4><p>Though you can’t directly modify the existing headers within the previous options object because instances of the <code>HttpHeaders</code> class are <strong>immutable</strong>, you can use the <code>set()</code> method instead, which <strong>returns a clone of the current instance with the new changes applied.</strong></p>
<p>For example, when a token has expired and you want to reset it, you can do:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">httpOptions.headers =</span><br><span class="line">  httpOptions.headers.set(<span class="string">'Authorization'</span>, <span class="string">'my-new-auth-token'</span>);</span><br></pre></td></tr></table></figure>

<h3 id="Configuring-HTTP-URL-Parameters"><a href="#Configuring-HTTP-URL-Parameters" class="headerlink" title="Configuring HTTP URL Parameters"></a>Configuring HTTP URL Parameters</h3><p>Some requests, such as a GET and sometimes a DELETE request, contain query strings that carries some data for the backend to process. Although you could write them manually in a <code>string</code>, a better way is to set them with <code>HttpParams().set()</code> (again, <code>set</code> method is used because <code>HttpParams</code> is immutable).</p>
<p>In summary, the process is the same as above for adding headers:</p>
<ol>
<li>Create a mapping and specify <code>params: new HttpParams().set(...)</code><ul>
<li>Or you can create them directly with: <code>params: new HttpParams({fromString: &#39;key=value&#39;})</code></li>
</ul>
</li>
</ol>
<p>For example:</p>
<p>If you want to create them from scratch:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* GET heroes whose name contains search term */</span></span><br><span class="line">searchHeroes(term: <span class="built_in">string</span>): Observable&lt;Hero[]&gt; &#123;</span><br><span class="line">  term = term.trim();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Add safe, URL encoded search parameter if there is a search term</span></span><br><span class="line">  <span class="keyword">const</span> options = term ? &#123; params: <span class="keyword">new</span> HttpParams(&#123;fromString: <span class="string">`name=<span class="subst">$&#123;term&#125;</span>`</span>&#125;)&#125; : &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.http.get&lt;Hero[]&gt;(<span class="keyword">this</span>.heroesUrl, options)</span><br><span class="line">    .pipe(</span><br><span class="line">      catchError(<span class="keyword">this</span>.handleError&lt;Hero[]&gt;(<span class="string">'searchHeroes'</span>, []))</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>If you are updating (or creating from scratch):</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">searchHeroes(term: <span class="built_in">string</span>): Observable&lt;Hero[]&gt; &#123;</span><br><span class="line">  term = term.trim();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Using set() method</span></span><br><span class="line">  <span class="keyword">const</span> options = term ? &#123; params: <span class="keyword">new</span> HttpParams().set(<span class="string">'name'</span>, term) &#125; : &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.http.get&lt;Hero[]&gt;(<span class="keyword">this</span>.heroesUrl, options)</span><br><span class="line">    .pipe(</span><br><span class="line">      catchError(<span class="keyword">this</span>.handleError&lt;Hero[]&gt;(<span class="string">'searchHeroes'</span>, []))</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Intercepting-Requests-and-Responses"><a href="#Intercepting-Requests-and-Responses" class="headerlink" title="Intercepting Requests and Responses"></a>Intercepting Requests and Responses</h3><p>With interception, you <strong>declare <em>interceptors</em> that inspect and transform HTTP requests from your application to a server</strong>. The same interceptors can also inspect and transform a server’s responses on their way back to the application. Multiple interceptors form a <em>forward-and-backward</em> chain of request/response handlers.</p>
<p>Interceptors can perform a variety of <em>implicit</em> tasks, <strong>from authentication to logging, in a routine, standard way, for every HTTP request/response</strong>.</p>
<p>Without interception, developers would have to implement these tasks <em>explicitly</em> for each <code>HttpClient</code> method call.</p>
<p>In summary, to use an interceptor(s), you need to:</p>
<ol>
<li><strong>Create a class(es)</strong> that implements <code>HttpInterceptor</code></li>
<li><strong>Implement the <code>intercept()</code> method</strong>, handling your interceptor logics there</li>
<li><strong>Provide that Interceptor</strong> at the same place as you provide the <code>HttpClient</code><ul>
<li>Because interceptors are (optional) dependencies of the <code>HttpClient</code> service, you must provide them in the same injector (or a parent of the injector) that provides <code>HttpClient</code>. Interceptors provided <em>after</em> DI creates the <code>HttpClient</code> are ignored.</li>
<li>After you have provided them, they will be used automatically in the order you provided them as they are dependencies of the <code>HttpClient</code> service</li>
</ul>
</li>
</ol>
<h4 id="Creating-an-Interceptor"><a href="#Creating-an-Interceptor" class="headerlink" title="Creating an Interceptor"></a>Creating an Interceptor</h4><p>To implement an interceptor, declare a class that implements the <code>intercept()</code> method of the <code>HttpInterceptor</code> interface.</p>
<p>Below is an example of a no operation interceptor:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Injectable &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  HttpEvent, HttpInterceptor, HttpHandler, HttpRequest</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'@angular/common/http'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; Observable &#125; <span class="keyword">from</span> <span class="string">'rxjs'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Pass untouched request through to the next request handler. */</span></span><br><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> NoopInterceptor <span class="keyword">implements</span> HttpInterceptor &#123;</span><br><span class="line"></span><br><span class="line">  intercept(req: HttpRequest&lt;<span class="built_in">any</span>&gt;, next: HttpHandler):</span><br><span class="line">    Observable&lt;HttpEvent&lt;<span class="built_in">any</span>&gt;&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> next.handle(req);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Most interceptors <strong>inspect the request on the way in and forward the (perhaps altered) request to the <code>handle()</code> method</strong> of the <code>next</code> object which implements the <a href="https://angular.io/api/common/http/HttpHandler" target="_blank" rel="noopener"><code>HttpHandler</code></a> interface.</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">abstract</span> <span class="keyword">class</span> HttpHandler &#123;</span><br><span class="line">  <span class="keyword">abstract</span> handle(req: HttpRequest&lt;<span class="built_in">any</span>&gt;): Observable&lt;HttpEvent&lt;<span class="built_in">any</span>&gt;&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Like <code>intercept()</code>, the <code>handle()</code> method transforms an HTTP request into an <code>Observable</code> of <a href="https://angular.io/guide/http#interceptor-events" target="_blank" rel="noopener"><code>HttpEvents</code></a> which ultimately include the server’s response. The <code>intercept()</code> method could inspect that observable and alter it before returning it to the caller.</p>
<blockquote>
<p>In general:</p>
<ul>
<li>If you want to inspect and manipulate the <code>HttpRequest&lt;any&gt;</code>, you should do it inside the <code>intercept()</code> method.</li>
<li>If you want to inspect and manipulate the <code>HttpResponse&lt;any&gt;</code>, you should do it inside the <code>handle()</code> method.</li>
</ul>
</blockquote>
<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> <strong>Both <code>HttpRequest</code> and <code>HttpRepsonse</code> are <code>HttpEvent</code>.</strong></li>
</ul>
</blockquote>
<h4 id="next-HttpInterceptor"><a href="#next-HttpInterceptor" class="headerlink" title="next: HttpInterceptor"></a><code>next: HttpInterceptor</code></h4><p>The <code>next</code> object represents <strong>the next interceptor in the chain of interceptors</strong>. The final <code>next</code> in the chain is the <code>HttpClient</code> backend handler that sends the request to the server and receives the server’s response.</p>
<p>Most interceptors call <code>next.handle()</code> so that the request flows through to the next interceptor and, eventually, the backend handler. An interceptor <em>could</em> skip calling <code>next.handle()</code>, short-circuit the chain, and <a href="https://angular.io/guide/http#caching" target="_blank" rel="noopener">return its own <code>Observable</code></a> with an artificial server response.</p>
<p>This is a common middleware pattern found in frameworks such as Express.js.</p>
<h4 id="Registering-the-Interceptor"><a href="#Registering-the-Interceptor" class="headerlink" title="Registering the Interceptor"></a>Registering the Interceptor</h4><p>The <code>NoopInterceptor</code> is a service managed by Angular’s <a href="https://angular.io/guide/dependency-injection" target="_blank" rel="noopener">dependency injection (DI)</a> system. Like other services, you must provide the interceptor class before the app can use it.</p>
<p>However. because interceptors are (optional) dependencies of the <code>HttpClient</code> service, <strong>you must provide them in the same injector (or a parent of the injector) that provides <code>HttpClient</code></strong>.</p>
<p>For example:</p>
<p><strong>If you have provided <code>HttpClient</code> in the app’s root injector</strong> (as a side-effect of importing the <code>HttpClientModule</code> in <code>AppModule</code>), <strong>you should provide interceptors in <code>AppModule</code> as well</strong>.</p>
<p>After importing the <code>HTTP_INTERCEPTORS</code> injection token from <code>@angular/common/http</code>, write the <code>NoopInterceptor</code> provider like this:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123; provide: HTTP_INTERCEPTORS, useClass: NoopInterceptor, multi: <span class="literal">true</span> &#125;,</span><br></pre></td></tr></table></figure>

<p>Note the <code>multi: true</code> option. This required setting tells Angular that <code>HTTP_INTERCEPTORS</code> is a <strong>token for a <em><code>multiprovider</code></em> (because you will add multiple interceptors later) that injects an array of values, rather than a single value</strong>.</p>
<p>Though you could directly write all of the interceptors manually inside the <code>AppModule</code>, it is usually <strong>more convenient to create another file that exports the array of interceptors</strong> as follows:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* "Barrel" of Http Interceptors */</span></span><br><span class="line"><span class="keyword">import</span> &#123; HTTP_INTERCEPTORS &#125; <span class="keyword">from</span> <span class="string">'@angular/common/http'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; NoOpInterceptor &#125; <span class="keyword">from</span> <span class="string">'./NoOp-interceptor'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;NoOpInterceptor2&#125; <span class="keyword">from</span> <span class="string">'./NoOp-interceptor2'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Http interceptor providers in outside-in order */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> httpInterceptorProviders = [</span><br><span class="line">  &#123; provide: HTTP_INTERCEPTORS, useClass: NoOpInterceptor, multi: <span class="literal">true</span> &#125;,</span><br><span class="line">  &#123; provide: HTTP_INTERCEPTORS, useClass: NoOpInterceptor2, multi: <span class="literal">true</span> &#125;</span><br><span class="line">];</span><br></pre></td></tr></table></figure>

<p>Lastly, you import this <code>const</code> into <code>AppModule</code>:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; BrowserModule &#125; <span class="keyword">from</span> <span class="string">'@angular/platform-browser'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; NgModule &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="meta">@NgModule</span>(&#123;</span><br><span class="line">  declarations: [</span><br><span class="line">    ...</span><br><span class="line">  ],</span><br><span class="line">  imports: [</span><br><span class="line">    BrowserModule,</span><br><span class="line">    FormsModule,</span><br><span class="line">    AppRoutingModule,</span><br><span class="line">    HttpClientModule,</span><br><span class="line">    ReactiveFormsModule</span><br><span class="line">  ],</span><br><span class="line">  providers: [httpInterceptorProviders],	<span class="comment">// added here</span></span><br><span class="line">  bootstrap: [AppComponent]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppModule &#123; &#125;</span><br></pre></td></tr></table></figure>

<h5 id="Interceptor-Order"><a href="#Interceptor-Order" class="headerlink" title="Interceptor Order"></a>Interceptor Order</h5><p><strong>Interceptor will be called based on the order of registration</strong>. In the example above, <code>NoOpInterceptor</code> will be called first, and then <code>NoOpInterceptor2</code> will happen next.</p>
<p>In general, if you provide interceptors <em>A</em>, then <em>B</em>, then <em>C</em>, requests flow in <em>A-&gt;B-&gt;C</em> and responses flow out <em>C-&gt;B-&gt;A</em>.</p>
<p>However, <strong>you cannot change the order or remove interceptors later</strong>. If you need to <strong>enable and disable an interceptor dynamically</strong>, you’ll have to build that capability <strong>into the interceptor itself</strong>.</p>
<h4 id="Modifying-a-Request"><a href="#Modifying-a-Request" class="headerlink" title="Modifying a Request"></a>Modifying a Request</h4><p>Most <code>HttpClient</code> methods return observables of <code>HttpResponse&lt;any&gt;</code>. The <code>HttpResponse</code> class itself is actually an event, whose type is <code>HttpEventType.Response</code>. <strong>A single HTTP request can, however, generate multiple events of other types</strong>, including upload and download progress events. The methods <code>HttpInterceptor.intercept()</code> and <code>HttpHandler.handle()</code> return observables of <code>HttpEvent&lt;any&gt;</code>.</p>
<p><strong>Many interceptors are only concerned with the outgoing request and return the event stream from <code>next.handle()</code> without modifying it.</strong> Some interceptors, however, need to examine and modify the response from <code>next.handle()</code>; these operations can see all of these events in the stream.</p>
<p><strong>Although interceptors are capable of modifying requests and responses, the <code>HttpRequest</code> and <code>HttpResponse</code> instance properties are <code>readonly</code></strong>, rendering them largely immutable. They are immutable for a good reason: an app might retry a request several times before it succeeds, which means that the interceptor chain can re-process the same request multiple times. If an interceptor could modify the original request object, the re-tried operation would start from the modified request rather than the original. Immutability ensures that interceptors see the same request for each try.</p>
<p>This means that if you want to modify a request, including its header/body/URL and etc., <strong>you need to create a clone and modify it from there</strong>.</p>
<h5 id="Modifying-a-Request-Body"><a href="#Modifying-a-Request-Body" class="headerlink" title="Modifying a Request Body"></a>Modifying a Request Body</h5><p>The <code>readonly</code> assignment guard can’t prevent deep updates and, in particular, it can’t prevent you from modifying a property of a request body object. However, it is in general a better practice if you still modify its copy:</p>
<ol>
<li><strong>Copy the body</strong> and make your change in the copy.</li>
<li><strong>Clone the request object</strong>, using its <code>clone()</code> method.</li>
<li><strong>Replace the clone’s body</strong> with the modified copy.</li>
</ol>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// copy the body and trim whitespace from the name property</span></span><br><span class="line"><span class="keyword">const</span> newBody = &#123; ...body, name: body.name.trim() &#125;;</span><br><span class="line"><span class="comment">// clone request and set/replace its body</span></span><br><span class="line"><span class="keyword">const</span> newReq = req.clone(&#123; body: newBody &#125;);</span><br><span class="line"><span class="comment">// send the cloned request to the next handler.</span></span><br><span class="line"><span class="keyword">return</span> next.handle(newReq);</span><br></pre></td></tr></table></figure>

<p>If you want to clear the body, you can use the same approach.</p>
<p>However, you need to be careful of setting the body to <code>null</code> instead of <code>undefined</code>:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">newReq = req.clone(&#123; ... &#125;); <span class="comment">// body not mentioned =&gt; preserve original body</span></span><br><span class="line">newReq = req.clone(&#123; body: <span class="literal">undefined</span> &#125;); <span class="comment">// preserve original body</span></span><br><span class="line">newReq = req.clone(&#123; body: <span class="literal">null</span> &#125;); <span class="comment">// clear the body</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> This means that <strong>if you set the cloned request body to <code>undefined</code>, Angular assumes you intend to leave the body as is</strong>.</li>
</ul>
</blockquote>
<h5 id="Modifying-a-Request-Header"><a href="#Modifying-a-Request-Header" class="headerlink" title="Modifying a Request Header"></a>Modifying a Request Header</h5><p>Again, similar to setting the request body, you need to clone the request object again in order to set/add the request header.</p>
<p>In summary, you need to:</p>
<ol>
<li>Use the <code>set()</code> method to update/add a header<ul>
<li>This will <strong>return a cloned header object with your changes</strong>, which saves you some time</li>
</ul>
</li>
<li>Clone the request object</li>
<li>Replace the clone’s headers</li>
</ol>
<p>A common usage is to <strong>add an authorization token in the header once the user is authorized</strong>, so that all the outgoing request will have that token and the user could potentially have more access to your backend APIs.</p>
<p>The above can be implemented with:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; AuthService &#125; <span class="keyword">from</span> <span class="string">'../auth.service'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AuthInterceptor <span class="keyword">implements</span> HttpInterceptor &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> auth: AuthService</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  intercept(req: HttpRequest&lt;<span class="built_in">any</span>&gt;, next: HttpHandler) &#123;</span><br><span class="line">    <span class="comment">// Get the auth token from the service.</span></span><br><span class="line">    <span class="keyword">const</span> authToken = <span class="keyword">this</span>.auth.getAuthorizationToken();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Clone the request and replace the original headers with</span></span><br><span class="line">    <span class="comment">// cloned headers, updated with the authorization.</span></span><br><span class="line">    <span class="keyword">const</span> authReq = req.clone(&#123;</span><br><span class="line">      headers: req.headers.set(<span class="string">'Authorization'</span>, authToken)</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// send cloned request with header to the next handler.</span></span><br><span class="line">    <span class="keyword">return</span> next.handle(authReq);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>In fact, the practice of cloning a request to set new headers is so common that there’s a <code>setHeaders</code> shortcut for it:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Clone the request and set the new header in one step.</span></span><br><span class="line"><span class="keyword">const</span> authReq = req.clone(&#123; setHeaders: &#123; Authorization: authToken &#125; &#125;);</span><br></pre></td></tr></table></figure>

<p>So you could technically do the above with one step:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; AuthService &#125; <span class="keyword">from</span> <span class="string">'../auth.service'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AuthInterceptor <span class="keyword">implements</span> HttpInterceptor &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> auth: AuthService</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  intercept(req: HttpRequest&lt;<span class="built_in">any</span>&gt;, next: HttpHandler) &#123;</span><br><span class="line">    <span class="keyword">const</span> authToken = <span class="keyword">this</span>.auth.getAuthorizationToken();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> authReq = req.clone(&#123; setHeaders: &#123; Authorization: authToken &#125; &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// send cloned request with header to the next handler.</span></span><br><span class="line">    <span class="keyword">return</span> next.handle(authReq);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Using-Interceptors-for-Logging"><a href="#Using-Interceptors-for-Logging" class="headerlink" title="Using Interceptors for Logging"></a>Using Interceptors for Logging</h3><p>Because interceptors can process the request and response <em>together</em>, they can perform tasks such as timing and logging an entire HTTP operation by using the <code>pipe()</code> method.</p>
<p>For example, the below snippet <strong>will record the time before the event reaches the backend and the time when response is provided</strong>:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; finalize, tap &#125; <span class="keyword">from</span> <span class="string">'rxjs/operators'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; MessageService &#125; <span class="keyword">from</span> <span class="string">'../message.service'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> LoggingInterceptor <span class="keyword">implements</span> HttpInterceptor &#123;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> messenger: MessageService</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  intercept(req: HttpRequest&lt;<span class="built_in">any</span>&gt;, next: HttpHandler) &#123;</span><br><span class="line">    <span class="keyword">const</span> started = <span class="built_in">Date</span>.now();</span><br><span class="line">    <span class="keyword">let</span> ok: <span class="built_in">string</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// extend server response observable with logging</span></span><br><span class="line">    <span class="keyword">return</span> next.handle(req)</span><br><span class="line">      .pipe(</span><br><span class="line">        tap(</span><br><span class="line">          <span class="comment">// Succeeds when there is a response; ignore other events</span></span><br><span class="line">          event =&gt; ok = event <span class="keyword">instanceof</span> HttpResponse ? <span class="string">'succeeded'</span> : <span class="string">''</span>,</span><br><span class="line">          <span class="comment">// Operation failed; error is an HttpErrorResponse</span></span><br><span class="line">          error =&gt; ok = <span class="string">'failed'</span></span><br><span class="line">        ),</span><br><span class="line">        <span class="comment">// Log when response observable either completes or errors</span></span><br><span class="line">        finalize(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">const</span> elapsed = <span class="built_in">Date</span>.now() - started;</span><br><span class="line">          <span class="keyword">const</span> msg = <span class="string">`<span class="subst">$&#123;req.method&#125;</span> "<span class="subst">$&#123;req.urlWithParams&#125;</span>"</span></span><br><span class="line"><span class="string">             <span class="subst">$&#123;ok&#125;</span> in <span class="subst">$&#123;elapsed&#125;</span> ms.`</span>;</span><br><span class="line">          <span class="keyword">this</span>.messenger.add(msg);</span><br><span class="line">        &#125;)</span><br><span class="line">      );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>where:</p>
<ul>
<li>The RxJS <code>tap</code> operator <strong>captures whether the request succeeded or failed</strong>. </li>
<li>The RxJS <code>finalize</code> operator is <strong>called when the response observable either errors or completes (which it must), and reports the outcome to the <code>MessageService</code>.</strong></li>
</ul>
<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> Though the intercept method gets hold of the response, <strong>neither <code>tap</code> nor <code>finalize</code> touch the values of the observable stream returned to the caller</strong>. You should <strong>not modify the response</strong> unless it is absolutely necessary.</li>
</ul>
</blockquote>
<h3 id="Using-Interceptors-for-Caching"><a href="#Using-Interceptors-for-Caching" class="headerlink" title="Using Interceptors for Caching"></a>Using Interceptors for Caching</h3><p>Interceptors can handle requests by themselves, without forwarding to <code>next.handle()</code>.</p>
<p>In summary, if you want to do this, you need to:</p>
<ol>
<li>Create and inject a <code>RequestCache</code> cache, where your cache will be stored</li>
<li>Write a method to determine whether if a request is cacheable, before determining to cache the request or not</li>
<li>Write a method to re-send the request.<ul>
<li>You can simply continue to send the request with <code>next.handle(req)</code></li>
<li>If you need to change something in the request, such as request header, you can do so as well.</li>
</ul>
</li>
</ol>
<p>For example:</p>
<p>Your main <code>CachingInterceptor</code> that <strong>intercepts and determines whether to return the result from cache or proceed the request</strong> would look like:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> CachingInterceptor <span class="keyword">implements</span> HttpInterceptor &#123;</span><br><span class="line">  <span class="comment">// where caches will be stored</span></span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">private</span> cache: RequestCache</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">  intercept(req: HttpRequest&lt;<span class="built_in">any</span>&gt;, next: HttpHandler) &#123;</span><br><span class="line">    <span class="comment">// continue if not cacheable.</span></span><br><span class="line">    <span class="keyword">if</span> (!isCacheable(req)) &#123; <span class="keyword">return</span> next.handle(req); &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> cachedResponse = <span class="keyword">this</span>.cache.get(req);</span><br><span class="line">    <span class="keyword">return</span> cachedResponse ?</span><br><span class="line">      of(cachedResponse) : sendRequest(req, next, <span class="keyword">this</span>.cache);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>where:</p>
<ul>
<li>The <code>isCacheable()</code> function determines if the request is cacheable.</li>
<li><strong>If the request is not cacheable</strong>, the interceptor simply forwards the request to the next handler in the chain.</li>
<li><strong>If a cacheable request is found</strong> in the cache, the interceptor returns an <code>of()</code> <em>observable</em> with the cached response, by-passing the <code>next</code> handler (and all other interceptors downstream).</li>
<li><strong>If a cacheable request is not in cache</strong>, the code calls <code>sendRequest()</code>.<ul>
<li>You can/should handle the cache adding before sending with <code>next.handle(req)</code> in that <code>sendRequest()</code> method.</li>
<li>Or you can modify the request (following the contents mentioned above), cache it, and then send it with <code>next.handle(req)</code>.</li>
</ul>
</li>
</ul>
<p>For instance, if you want to delete the request header information in the <code>sendRequest()</code> processing, you can:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Get server response observable by sending request to `next()`.</span></span><br><span class="line"><span class="comment"> * Will add the response to the cache on the way out.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sendRequest</span>(<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">  req: HttpRequest&lt;<span class="built_in">any</span>&gt;,</span></span></span><br><span class="line"><span class="function"><span class="params">  next: HttpHandler,</span></span></span><br><span class="line"><span class="function"><span class="params">  cache: RequestCache</span>): <span class="title">Observable</span>&lt;<span class="title">HttpEvent</span>&lt;<span class="title">any</span>&gt;&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// No headers allowed in npm search request</span></span><br><span class="line">  <span class="keyword">const</span> noHeaderReq = req.clone(&#123; headers: <span class="keyword">new</span> HttpHeaders() &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> next.handle(noHeaderReq).pipe(</span><br><span class="line">    tap(<span class="function"><span class="params">event</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// There may be other events besides the response.</span></span><br><span class="line">      <span class="keyword">if</span> (event <span class="keyword">instanceof</span> HttpResponse) &#123;</span><br><span class="line">        cache.put(req, event); <span class="comment">// Update the cache.</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Note:</p>
<ul>
<li><input disabled="" type="checkbox"> Even in the case above, <strong>the original response continues untouched back up through the chain of interceptors to the application caller.</strong></li>
</ul>
</blockquote>
<h3 id="Tracking-and-Showing-Request-Progress"><a href="#Tracking-and-Showing-Request-Progress" class="headerlink" title="Tracking and Showing Request Progress"></a>Tracking and Showing Request Progress</h3><p>Sometimes applications transfer large amounts of data and those transfers can take a long time. File uploads are a typical example. You can give the users a better experience by providing feedback on the progress of such transfers.</p>
<p>In summary, you need to:</p>
<ol>
<li>Create a request that has the option <code>reportProgress: true</code> specified<ul>
<li>If you are constructing a raw request, that is all you need to do</li>
<li>If you are constructing from an existing request (e.g. POST), you also need to add <code>observe: event</code><ul>
<li>This is because every progress event triggers change detection, and you can see those <code>events</code> if you specify <code>observe: event</code></li>
</ul>
</li>
</ul>
</li>
<li>Use <code>map()</code> to process the event that you get from the request, and <code>tap</code> to provide messages for users to see</li>
</ol>
<p>For example:</p>
<p>If you are constructing a raw request:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> req = <span class="keyword">new</span> HttpRequest(<span class="string">'POST'</span>, <span class="string">'/upload/file'</span>, file, &#123;</span><br><span class="line">  reportProgress: <span class="literal">true</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>Then, to listen and <strong>map the events reported back to string information, use <code>map</code></strong>:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// The `HttpClient.request` API produces a raw event stream</span></span><br><span class="line"><span class="comment">// which includes start (sent), progress, and response events.</span></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">this</span>.http.request(req).pipe(</span><br><span class="line">  map(<span class="function"><span class="params">event</span> =&gt;</span> <span class="keyword">this</span>.getEventMessage(event, file)),	<span class="comment">// passes on string information to tap() </span></span><br><span class="line">  tap(<span class="function"><span class="params">message</span> =&gt;</span> <span class="keyword">this</span>.showProgress(message)),	<span class="comment">// this basically presents information to the user</span></span><br><span class="line">  last(), <span class="comment">// return last (completed) message to caller</span></span><br><span class="line">  catchError(<span class="keyword">this</span>.handleError(file))</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><strong><code>tap</code> gets the messages that gets returned from <code>map</code></strong>, which are strings indicating the request status:</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** Return distinct message for sent, upload progress, &amp; response events */</span></span><br><span class="line"><span class="comment">// notice that strings are returned, which then goes through the tap() operator</span></span><br><span class="line"><span class="keyword">private</span> getEventMessage(event: HttpEvent&lt;<span class="built_in">any</span>&gt;, file: File) &#123;</span><br><span class="line">  <span class="keyword">switch</span> (event.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> HttpEventType.Sent:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">`Uploading file "<span class="subst">$&#123;file.name&#125;</span>" of size <span class="subst">$&#123;file.size&#125;</span>.`</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> HttpEventType.UploadProgress:</span><br><span class="line">      <span class="comment">// Compute and show the % done:</span></span><br><span class="line">      <span class="keyword">const</span> percentDone = <span class="built_in">Math</span>.round(<span class="number">100</span> * event.loaded / event.total);</span><br><span class="line">      <span class="keyword">return</span> <span class="string">`File "<span class="subst">$&#123;file.name&#125;</span>" is <span class="subst">$&#123;percentDone&#125;</span>% uploaded.`</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">case</span> HttpEventType.Response:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">`File "<span class="subst">$&#123;file.name&#125;</span>" was completely uploaded!`</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="string">`File "<span class="subst">$&#123;file.name&#125;</span>" surprising upload event: <span class="subst">$&#123;event.<span class="keyword">type</span>&#125;</span>.`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="Techniques"><a href="#Techniques" class="headerlink" title="Techniques"></a>Techniques</h1><h2 id="Animations"><a href="#Animations" class="headerlink" title="Animations"></a>Animations</h2><h2 id="Internationalization"><a href="#Internationalization" class="headerlink" title="Internationalization"></a>Internationalization</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://jasonyux.github.io/2020/06/29/SpringBoot-Manual/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Xiao Yu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="From a Beginner to a Disaster">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/06/29/SpringBoot-Manual/" class="post-title-link" itemprop="url">Spring Boot Manual</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-06-29 11:35:00" itemprop="dateCreated datePublished" datetime="2020-06-29T11:35:00+08:00">2020-06-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-12 22:50:51" itemprop="dateModified" datetime="2020-07-12T22:50:51+08:00">2020-07-12</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <hr>
<p><strong>IMPORTANT</strong>:<br>Much of the content here is a personal summary/abbreviation of contents on the <a href="https://docs.spring.io/spring-boot/docs/2.3.0.RELEASE/reference/html/" target="_blank" rel="noopener">Offical Spring Boot Documentation</a>. For more complete information, please refer to the official site.</p>
<hr>
<h2 id="Spring-Boot-Installation"><a href="#Spring-Boot-Installation" class="headerlink" title="Spring Boot Installation"></a>Spring Boot Installation</h2><p>For instructions on installing and a quick overview of using Spring Boot, please refer to this <a href="https://docs.spring.io/spring-boot/docs/2.3.0.RELEASE/reference/html/getting-started.html#getting-started-installing-spring-boot" target="_blank" rel="noopener">page</a></p>
<h2 id="Structuring-Your-Code"><a href="#Structuring-Your-Code" class="headerlink" title="Structuring Your Code"></a>Structuring Your Code</h2><p>Technically, Spring Boot does not require any specific code layout to work. However, there are <strong>some best practices that help:</strong></p>
<ul>
<li><p>Your <code>main application</code> class:</p>
<ul>
<li><p>It is generally recommend that you locate <strong>your <code>main application</code> class in a root package above other<br>classes.</strong> The <code>@SpringBootApplication</code> annotation is often placed on your main class, and it implicitly<br>defines a base “search package” for certain items</p>
</li>
<li><p>For example, the follwoing structure:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">com</span><br><span class="line">+- example</span><br><span class="line">	+- myapplication</span><br><span class="line">		+- Application.java</span><br><span class="line">		|</span><br><span class="line">		+- customer</span><br><span class="line">		|   +- Customer.java</span><br><span class="line">		|   +- CustomerController.java</span><br><span class="line">		|   +- CustomerService.java</span><br><span class="line">		|   +- CustomerRepository.java</span><br><span class="line">		|</span><br><span class="line">		+- order</span><br><span class="line">			+- Order.java</span><br><span class="line">			+- OrderController.java</span><br><span class="line">			+- OrderService.java</span><br><span class="line">			+- OrderRepository.java</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>Your primary <code>configuration</code> class</p>
<ul>
<li>Although it is possible to use <code>SpringApplication</code> with <code>XML</code> sources, we generally recommend that <strong>your primary source be a single <code>@Configuration</code> class</strong>. Usually the <strong>class that defines the main method is a good candidate as the primary <code>@Configuration</code></strong>.</li>
<li>You can also <strong>import configuration classes</strong>:<ul>
<li>The <strong><code>@Import</code> annotation can be used to import additional configuration classes</strong>. Alternatively, you can <strong>use <code>@ComponentScan</code> to automatically pick up all Spring components</strong>, including <code>@Configuration</code> classes.</li>
</ul>
</li>
<li><strong>Import XML Configuration</strong><ul>
<li>If you need to use an XML based configuration, we recommend that you <strong>still start with a <code>@Configuration</code> class</strong>. You can <strong>then use an <code>@ImportResource</code> annotation</strong> to load XML configuration files.
          <!--noindex-->
            <div class="post-button">
              <a class="btn" href="/2020/06/29/SpringBoot-Manual/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          <!--/noindex-->
        
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



        </div>
        

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Xiao Yu</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/next-boot.js"></script>


  















  

  

</body>
</html>
